<!DOCTYPE html>
<html lang="">
<head>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css" integrity="sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;0,900;1,400;1,700;1,900&family=Source+Code+Pro:ital,wght@0,400;0,700;0,900;1,400;1,700;1,900&display=swap" crossorigin="anonymous">
<meta charset="utf-8">
<title>allLectureNotes.md</title>
<style>
body {
  font-family: "Source Sans Pro", sans-serif;
}
code {
  font-family: "Source Code Pro", monospace;
}
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */

html{
  line-height:1.15;
  -webkit-text-size-adjust:100%;
}

body{
  margin:0;
}

main{
  display:block;
}

h1{
  font-size:2em;
  margin:0.67em 0;
}

hr{
  box-sizing:content-box;
  height:0;
  overflow:visible;
}

pre{
  font-family:monospace, monospace;
  font-size:1em;
}

a{
  background-color:transparent;
}

abbr[title]{
  border-bottom:none;
  text-decoration:underline;
  text-decoration:underline dotted;
}

b,
strong{
  font-weight:bolder;
}

code,
kbd,
samp{
  font-family:monospace, monospace;
  font-size:1em;
}

small{
  font-size:80%;
}

sub,
sup{
  font-size:75%;
  line-height:0;
  position:relative;
  vertical-align:baseline;
}

sub{
  bottom:-0.25em;
}

sup{
  top:-0.5em;
}

img{
  border-style:none;
}

button,
input,
optgroup,
select,
textarea{
  font-family:inherit;
  font-size:100%;
  line-height:1.15;
  margin:0;
}

button,
input{
  overflow:visible;
}

button,
select{
  text-transform:none;
}

button,
[type="button"],
[type="reset"],
[type="submit"]{
  -webkit-appearance:button;
}

button::-moz-focus-inner,
[type="button"]::-moz-focus-inner,
[type="reset"]::-moz-focus-inner,
[type="submit"]::-moz-focus-inner{
  border-style:none;
  padding:0;
}

button:-moz-focusring,
[type="button"]:-moz-focusring,
[type="reset"]:-moz-focusring,
[type="submit"]:-moz-focusring{
  outline:1px dotted ButtonText;
}

fieldset{
  padding:0.35em 0.75em 0.625em;
}

legend{
  box-sizing:border-box;
  color:inherit;
  display:table;
  max-width:100%;
  padding:0;
  white-space:normal;
}

progress{
  vertical-align:baseline;
}

textarea{
  overflow:auto;
}

[type="checkbox"],
[type="radio"]{
  box-sizing:border-box;
  padding:0;
}

[type="number"]::-webkit-inner-spin-button,
[type="number"]::-webkit-outer-spin-button{
  height:auto;
}

[type="search"]{
  -webkit-appearance:textfield;
  outline-offset:-2px;
}

[type="search"]::-webkit-search-decoration{
  -webkit-appearance:none;
}

::-webkit-file-upload-button{
  -webkit-appearance:button;
  font:inherit;
}

details{
  display:block;
}

summary{
  display:list-item;
}

template{
  display:none;
}

[hidden]{
  display:none;
}
fieldset{border:0;padding:0}button{all:unset;cursor:pointer}.mermaid .actor,.mermaid .labelBox{stroke:#666 !important}.mermaid svg{height:auto}.markdown-body .songbook .charter-header{position:relative;min-height:65px;margin-bottom:1em}.markdown-body .songbook .charter-title{font-size:1.5em;font-weight:bold;margin:0;padding:0}.markdown-body .songbook .charter-logo{text-align:right;height:70px}.markdown-body .songbook .charter-artist,.markdown-body .songbook .charter-subtitle,.markdown-body .songbook .charter-key{font-weight:normal;margin:0 0 3px 0;padding:0}.markdown-body .songbook .charter-artist{font-size:.8em;font-size:.9em}.markdown-body .songbook .charter-subtitle{font-size:.8em;font-size:.9em}.markdown-body .songbook .charter-key{font-weight:bold;font-size:.9em;font-size:1em}.markdown-body .songbook .charter-header-logo{position:absolute;top:0;right:0;float:right}.markdown-body .songbook .charter-header::after{content:"";clear:both;display:table}.markdown-body .songbook .charter-logo-tagline{font-size:.7em}.markdown-body .songbook .charter-section{margin-bottom:2em;page-break-inside:avoid;margin-bottom:1em}.markdown-body .songbook .charter-section-title{font-weight:bold;text-transform:uppercase;font-size:1.1em;color:#888}.markdown-body .songbook .charter-section-body{margin-left:20px}.markdown-body .songbook .charter-comment{font-style:italic}.markdown-body .songbook td.charter-chord:not(:empty){font-weight:bold;vertical-align:bottom;padding-right:14px;padding-right:8px}.markdown-body .songbook td.charter-lyric{white-space:nowrap;padding-right:2px;margin-bottom:.2em;padding-bottom:.3em;padding-right:.2em}.markdown-body .songbook th,.markdown-body .songbook td{line-height:unset;padding:0}.markdown-body .songbook td{border-top:0}.markdown-body .songbook .charter-body{margin-top:15px}.markdown-body .songbook .charter-chart{margin-bottom:.3em}.markdown-body .songbook .charter-chart td,.markdown-body .songbook .charter-chart tr{border:0}.markdown-body{box-sizing:border-box;margin:0 auto;max-width:700px;padding:30px;color:#444;line-height:1.4;position:relative;word-wrap:break-word;color:#ddd}/*!
  Theme: Tomorrow Night
  Author: Chris Kempson (http://chriskempson.com)
  License: ~ MIT (or more permissive) [via base16-schemes-source]
  Maintainer: @highlightjs/core-team
  Version: 2021.05.0
*/pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#ccc;background:#2d2d2d}.hljs ::selection{color:#515151}.hljs-comment{color:#999}.hljs-tag{color:#b4b7b4}.hljs-operator,.hljs-punctuation,.hljs-subst{color:#ccc}.hljs-operator{opacity:.7}.hljs-bullet,.hljs-deletion,.hljs-name,.hljs-selector-tag,.hljs-template-variable,.hljs-variable{color:#f2777a}.hljs-attr,.hljs-link,.hljs-literal,.hljs-number,.hljs-symbol,.hljs-variable.constant_{color:#f99157}.hljs-class .hljs-title,.hljs-title,.hljs-title.class_{color:#fc6}.hljs-strong{font-weight:700;color:#fc6}.hljs-addition,.hljs-code,.hljs-string,.hljs-title.class_.inherited__{color:#9c9}.hljs-built_in,.hljs-doctag,.hljs-keyword.hljs-atrule,.hljs-quote,.hljs-regexp{color:#6cc}.hljs-attribute,.hljs-function .hljs-title,.hljs-section,.hljs-title.function_,.ruby .hljs-property{color:#69c}.diff .hljs-meta,.hljs-keyword,.hljs-template-tag,.hljs-type{color:#c9c}.hljs-emphasis{color:#c9c;font-style:italic}.hljs-meta,.hljs-meta .hljs-keyword,.hljs-meta .hljs-string{color:#a3685a}.hljs-meta .hljs-keyword,.hljs-meta-keyword{font-weight:700}.preview-error{box-shadow:0 0 10px 2px rgba(0,0,0,.3);display:none;font-family:monospace;left:0;margin:0;position:absolute;top:0}.preview-error-wrap{position:relative}.preview-error-wrap .icon-stack{left:-1.25em;position:absolute;top:-15px;z-index:10}.preview-error-wrap .icon-invert{color:#fff}.preview-error-wrap:hover .preview-error{display:block}.markdown-body h1{font-size:2.7em;margin-block-end:.6em;margin-block-start:.6em}.markdown-body h2{font-size:2.3em}.markdown-body h3{font-size:2em}.markdown-body h4{font-size:1.8em}.markdown-body h5{font-size:1.5em}.markdown-body h6{font-size:1.2em}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{color:#111;font-weight:900;margin-block-end:1.6rem;margin-block-start:1.6rem;color:#bbb}.markdown-body hr{border:0;border-bottom:1px dashed #aaa;border-bottom-color:#666}.markdown-body img{max-width:100%}.markdown-body a{color:#4fa1cc;text-decoration:none;color:#10feff}.markdown-body a:hover{color:#226ca1;text-decoration:underline;color:#8effff}.markdown-body abbr[title]{cursor:help;text-decoration:underline dotted;text-underline-position:under}.markdown-body pre{background-color:#fafafa;border:1px solid #bbb;border-radius:3px;padding:6px 10px;white-space:pre-wrap;word-break:break-word;background-color:#282828;border-color:#444}.markdown-body code{background-color:#eaeaea;color:#cd2e47;font-size:.75em;padding:1px 2px;background-color:#444;border-radius:2px;color:#ff657d}.markdown-body pre code{background-color:inherit;color:inherit;padding:0;background-color:initial}.markdown-body dt{font-weight:bold;margin-top:1em}.markdown-body .table-wrapper{margin-left:0;margin-right:0;overflow-x:auto}.markdown-body table{border-collapse:collapse;margin-bottom:20px;transform-origin:left}.markdown-body th{text-align:left}.markdown-body th,.markdown-body td{border-left:1px solid #ccc;line-height:1.5;padding:8px}.markdown-body th:first-of-type,.markdown-body td:first-of-type{border-left:0}.markdown-body td{border-top:1px solid #ccc;border-top-color:#666}.markdown-body .task-list-item label{cursor:pointer}.markdown-body .task-list-item-checkbox{margin-right:5px}.markdown-body input[type=checkbox]{appearance:none;background-color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;height:13px;position:relative;width:13px;background-color:#111;border-color:#666}.markdown-body input[type=checkbox]:active{border-color:#333;border-color:#888}.markdown-body input[type=checkbox]:focus{outline:none}.markdown-body input[type=checkbox]:focus-visible{outline:2px solid tomato;outline-color:#f1f1bb}.markdown-body input[type=checkbox]:checked{background-color:#66f;border-color:#5151c8;background-color:#7878ea;border-color:#b2b2ff}.markdown-body input[type=checkbox]:checked:active{background-color:#8a8aff;background-color:#b2b2ff}.markdown-body input[type=checkbox]:checked::after{border-color:#fff;border-style:solid;border-width:0 0 2px 2px;bottom:5px;box-shadow:-1.5px 1.5px 1px 0 rgba(0,0,0,.4);content:"";display:block;height:3px;position:absolute;right:1px;transform:rotate(-45deg);width:7px}.markdown-body ol,.markdown-body ul{padding-inline-start:1.7em}.markdown-body ul>li::marker{font-size:1.4em}.markdown-body .text-align-center{text-align:center}.markdown-body mark{background:linear-gradient(-100deg, rgba(240, 255, 0, 0.4), rgba(240, 255, 50, 0.6) 95%, rgba(240, 255, 50, 0.1));border-radius:1em .1em;margin:0 -0.1rem;padding:.4rem .1rem;background:#cccc1a;border-radius:.2em}.markdown-body .tab circle{paint-order:stroke;stroke:#fff !important;stroke-width:2;stroke:#222 !important;stroke-width:4 !important}.rtl pre,.rtl .songbook,.rtl .abc svg,.rtl .tab svg,.rtl .mermaid svg{direction:ltr}.visually-hidden:not(:focus):not(:active){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.markdown-body .abc path,.markdown-body .abc text{fill:#ccc !important}.markdown-body .abc .abcjs-staff{fill:#999 !important}.markdown-body .abc .abcjs-ending{stroke:#ccc !important}.markdown-body .tab circle,.markdown-body .tab text,.markdown-body .tab text tspan{fill:#ccc !important}.markdown-body .tab path{fill:#ccc !important;stroke:#ccc !important}.markdown-body .tab .staff,.markdown-body .tab .string{stroke:#888 !important}.markdown-body .tab .fret-position,.markdown-body .tab .string-marker{stroke:#ccc !important}.markdown-body .tab .contrast-text{stroke:#222 !important}.markdown-body .tab .fingering-text tspan{fill:#000 !important}.mermaid .er.attributeBoxOdd{fill:#000 !important}.mermaid .er.attributeBoxEven{fill:none !important}.mermaid .cluster rect{fill:#333 !important}.mermaid .section.section0{fill:#888 !important}.mermaid .section.section2{fill:#080808 !important}body{background-color:#222;color:#eee}
</style>
</head>
<body>
<div class="markdown-body">
<p>Compilation of all my lecture notes</p>
<p>toc:</p>
<ul>
<li><a href="#computer-system-overview">Computer System Overview</a>
<ul>
<li><a href="#what-operating-systems-do">What Operating Systems Do</a></li>
<li><a href="#computer-system-organization">Computer-System Organization</a>
<ul>
<li><a href="#competing-for-resources">Competing for Resources</a></li>
</ul>
</li>
<li><a href="#computer-system-operation">Computer-System Operation</a>
<ul>
<li><a href="#instruction-execution">Instruction Execution</a></li>
<li><a href="#interrupts">Interrupts</a>
<ul>
<li><a href="#instruction-cycle-with-interrupts">Instruction Cycle with Interrupts</a></li>
<li><a href="#program-status-word">Program Status Word</a></li>
<li><a href="#flow-control-with-and-without-interrupts">Flow Control With and Without Interrupts</a></li>
<li><a href="#multiple-interrupts">Multiple Interrupts</a></li>
</ul>
</li>
<li><a href="#storage-structure">Storage Structure</a>
<ul>
<li><a href="#von-neumann-architecture">Von Neumann Architecture</a></li>
<li><a href="#main-memory">Main Memory</a>
<ul>
<li><a href="#rom-eprom-and-eeprom">ROM, EPROM, and EEPROM</a>
<ul>
<li><a href="#rom">ROM</a></li>
<li><a href="#eprom">EPROM</a></li>
<li><a href="#eeprom">EEPROM</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#secondary-storage">Secondary Storage</a></li>
<li><a href="#tertiary-storage">Tertiary Storage</a></li>
<li><a href="#storage-hierarchy">Storage Hierarchy</a></li>
<li><a href="#caching">Caching</a></li>
</ul>
</li>
<li><a href="#io-structure">I/O Structure</a>
<ul>
<li><a href="#direct-memory-access-structure">Direct Memory Access Structure</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#operating-system-structures">Operating System Structures</a>
<ul>
<li><a href="#computer-system-architecture">Computer System Architecture</a></li>
<li><a href="#operating-system-operations">Operating System Operations</a>
<ul>
<li><a href="#multiprogramming-and-multitasking">Multiprogramming and Multitasking</a></li>
<li><a href="#dual-mode">Dual Mode</a>
<ul>
<li><a href="#transition-from-user-to-kernel-mode">Transition from User to Kernel Mode</a></li>
</ul>
</li>
<li><a href="#resource-management">Resource Management</a>
<ul>
<li><a href="#process-management">Process Management</a></li>
<li><a href="#memory-management">Memory Management</a></li>
<li><a href="#file-system-management">File-System Management</a></li>
<li><a href="#mass-storage-management">Mass-Storage Management</a></li>
<li><a href="#caching-management">Caching Management</a>
<ul>
<li><a href="#cache-coherence">Cache Coherence</a></li>
</ul>
</li>
<li><a href="#io-subsystem-management">I/O Subsystem Management</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#operating-system-services">Operating System Services</a>
<ul>
<li><a href="#for-the-user">For the User</a></li>
<li><a href="#for-the-system">For the System</a></li>
</ul>
</li>
<li><a href="#user-operating-system-interfaces">User Operating System Interfaces</a></li>
<li><a href="#system-call">System call</a></li>
</ul>
</li>
<li><a href="#process-description-and-control">Process Description and Control</a>
<ul>
<li><a href="#what-is-a-process">What is a Process</a></li>
<li><a href="#process-states">Process States</a>
<ul>
<li><a href="#process-trace">Process Trace</a></li>
<li><a href="#simple-two-state-process-model">Simple Two-State Process Model</a></li>
<li><a href="#operations-on-processes">Operations on Processes</a>
<ul>
<li><a href="#creation">Creation</a>
<ul>
<li><a href="#fork">fork</a></li>
<li><a href="#createprocess">CreateProcess</a></li>
<li><a href="#tree-of-processes-in-linux">Tree of Processes in Linux</a></li>
</ul>
</li>
<li><a href="#termination">Termination</a></li>
</ul>
</li>
<li><a href="#five-state-process-model">Five-State Process Model</a></li>
<li><a href="#suspended-processes">Suspended Processes</a></li>
</ul>
</li>
<li><a href="#process-description-and-control-1">Process Description and Control</a>
<ul>
<li><a href="#memory-tables">Memory Tables</a></li>
<li><a href="#io-tables">I/O Tables</a></li>
<li><a href="#file-tables">File Tables</a></li>
<li><a href="#process-tables">Process Tables</a></li>
<li><a href="#process-control">Process Control</a></li>
<li><a href="#process-location">Process Location</a></li>
<li><a href="#process-attributes">Process Attributes</a></li>
</ul>
</li>
<li><a href="#process-control-1">Process Control</a>
<ul>
<li><a href="#creation-1">Creation</a></li>
<li><a href="#switching">Switching</a></li>
</ul>
</li>
<li><a href="#execution-of-the-operating-system">Execution of the Operating System</a>
<ul>
<li><a href="#separate-kernel">Separate Kernel</a></li>
<li><a href="#user-processes">User Processes</a></li>
<li><a href="#process-based-os">Process-Based OS</a></li>
<li><a href="#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#threads">Threads</a>
<ul>
<li><a href="#processes-and-threads">Processes and Threads</a>
<ul>
<li><a href="#threaded-approaches">Threaded Approaches</a></li>
<li><a href="#what-is-a-thread">What is a Thread</a></li>
<li><a href="#why-multithread">Why Multithread?</a></li>
</ul>
</li>
<li><a href="#multicore-programming">Multicore Programming</a>
<ul>
<li><a href="#concurrency-vs-parallelism">Concurrency vs Parallelism</a></li>
<li><a href="#amdahls-law">Amdahl’s Law</a></li>
<li><a href="#thread-states-and-operations">Thread States and Operations</a></li>
<li><a href="#thread-synchronization">Thread Synchronization</a></li>
</ul>
</li>
<li><a href="#multithreading-models">Multithreading Models</a>
<ul>
<li><a href="#user-threads">User Threads</a></li>
<li><a href="#kernel-threads">Kernel Threads</a></li>
<li><a href="#combined-user-and-kernel-level-threading">Combined User and Kernel level threading</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#concurrency-mutual-exclusion-and-synchronization">Concurrency: Mutual Exclusion and Synchronization</a>
<ul>
<li><a href="#background-for-concurrency">Background for Concurrency</a></li>
<li><a href="#critical-section-problem">Critical-Section Problem</a>
<ul>
<li><a href="#single-core">Single Core</a></li>
<li><a href="#os">OS</a></li>
</ul>
</li>
<li><a href="#mutual-exclusion">Mutual Exclusion</a>
<ul>
<li><a href="#software-approaches">Software Approaches</a>
<ul>
<li><a href="#dekkers-algo">Dekker’s Algo</a></li>
<li><a href="#petersons-solution">Peterson’s Solution</a></li>
</ul>
</li>
<li><a href="#hardware-support-approaches">Hardware Support Approaches</a>
<ul>
<li><a href="#memory-barrier">Memory Barrier</a></li>
<li><a href="#hardware-instructions">Hardware Instructions</a></li>
<li><a href="#atomic-variables">Atomic Variables</a></li>
</ul>
</li>
<li><a href="#os--programming-languages-approaches">OS &amp; Programming Languages Approaches</a>
<ul>
<li><a href="#mutex-locks">Mutex Locks</a></li>
<li><a href="#semaphores">Semaphores</a></li>
<li><a href="#monitors">Monitors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#deadlock-and-starvation">Deadlock and Starvation</a>
<ul>
<li><a href="#principles-of-deadlocks">Principles of Deadlocks</a>
<ul>
<li><a href="#deadlock">Deadlock</a></li>
</ul>
</li>
<li><a href="#deadlock-in-multithreaded-applications">Deadlock in Multithreaded Applications</a></li>
<li><a href="#deadlock-characterization">Deadlock Characterization</a>
<ul>
<li><a href="#resource-allocation-graph">Resource Allocation Graph</a></li>
</ul>
</li>
<li><a href="#methods-for-handling-deadlocks">Methods for Handling Deadlocks</a>
<ul>
<li><a href="#prevention">Prevention</a>
<ul>
<li><a href="#deny-hold-and-wait">Deny Hold and Wait</a></li>
<li><a href="#deny-no-preemption">Deny No Preemption</a></li>
<li><a href="#deny-circular-wait">Deny Circular Wait</a></li>
</ul>
</li>
<li><a href="#deadlock-avoidance">Deadlock Avoidance</a>
<ul>
<li><a href="#safe-state">Safe State</a></li>
<li><a href="#avoidance-algos">Avoidance Algos</a>
<ul>
<li><a href="#resource-allocation-graph-scheme">Resource-Allocation Graph Scheme</a></li>
<li><a href="#bankers-algorithm">Banker’s Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#deadlock-detection">Deadlock Detection</a></li>
</ul>
</li>
<li><a href="#recovery-from-deadlock">Recovery from Deadlock</a></li>
</ul>
</li>
<li><a href="#cpu-scheduling">CPU Scheduling</a>
<ul>
<li><a href="#recap-for-cpu-scheduling">Recap for CPU Scheduling</a></li>
<li><a href="#basics-for-cpu-scheduling">Basics for CPU Scheduling</a></li>
<li><a href="#scheduling-criteria">Scheduling Criteria</a></li>
<li><a href="#scheduling-algos">Scheduling Algos</a></li>
<li><a href="#multi-processor-scheduling">Multi-Processor Scheduling</a>
<ul>
<li><a href="#multicore">Multicore</a></li>
<li><a href="#multithreaded-cores">Multithreaded Cores</a></li>
<li><a href="#load-balancing">Load Balancing</a></li>
<li><a href="#processor-affinity">Processor Affinity</a></li>
<li><a href="#numa-systems">NUMA Systems</a></li>
<li><a href="#hetereogeneous-multiprocessing">Hetereogeneous Multiprocessing</a></li>
</ul>
</li>
<li><a href="#real-time-cpu-scheduling">Real-Time CPU Scheduling</a>
<ul>
<li><a href="#priority-based-scheduling">Priority Based Scheduling</a></li>
</ul>
</li>
<li><a href="#algo-eval">Algo Eval</a>
<ul>
<li><a href="#deterministic">Deterministic</a></li>
<li><a href="#queueing-models">Queueing Models</a></li>
<li><a href="#simulations">Simulations</a></li>
<li><a href="#real-implementation">Real Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#main-memory-1">Main Memory</a>
<ul>
<li><a href="#background-for-memory-management">Background for Memory Management</a>
<ul>
<li><a href="#memory-protection">Memory Protection</a></li>
<li><a href="#logical-vs-physical-address-space">Logical vs Physical Address Space</a></li>
<li><a href="#memory-mangement-unit">Memory Mangement Unit</a></li>
<li><a href="#dynamic-loading">Dynamic Loading</a></li>
<li><a href="#dynamic-linking">Dynamic Linking</a></li>
</ul>
</li>
<li><a href="#contiguous-memory-allocation">Contiguous Memory Allocation</a>
<ul>
<li><a href="#memory-protection-in-contiguous-memory-allocation">Memory Protection in Contiguous Memory Allocation</a></li>
<li><a href="#memory-allocation">Memory Allocation</a></li>
<li><a href="#fragmentation">Fragmentation</a></li>
</ul>
</li>
<li><a href="#paging">Paging</a>
<ul>
<li><a href="#paging-hardware">Paging Hardware</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#calculating-internal-fragmentation">Calculating Internal Fragmentation</a></li>
<li><a href="#free-frames">Free Frames</a></li>
<li><a href="#implementation-of-page-table">Implementation of Page Table</a>
<ul>
<li><a href="#tlb">TLB</a>
<ul>
<li><a href="#effective-access-time">Effective Access Time</a></li>
<li><a href="#memory-protection-in-page-table">Memory Protection in Page Table</a></li>
<li><a href="#shared-pages">Shared Pages</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#swapping">Swapping</a></li>
</ul>
</li>
<li><a href="#virtual-memory">Virtual Memory</a>
<ul>
<li><a href="#background-for-virtual-memory">Background for Virtual Memory</a></li>
<li><a href="#demand-paging">Demand Paging</a></li>
<li><a href="#copy-on-write">Copy on Write</a></li>
<li><a href="#page-replacement">Page Replacement</a>
<ul>
<li><a href="#page-replacement-algorithms">Page Replacement Algorithms</a>
<ul>
<li><a href="#page-replacement-algo-evalutation">Page Replacement Algo Evalutation</a></li>
<li><a href="#different-types">Different Types</a>
<ul>
<li><a href="#fifo">FIFO</a></li>
<li><a href="#optimal-algo">Optimal Algo</a></li>
<li><a href="#least-recently-used-lru-algorithm">Least Recently Used (LRU) Algorithm</a>
<ul>
<li><a href="#second-chance-algo-clock---lru-approximation">Second-Chance Algo (Clock) - LRU Approximation</a></li>
<li><a href="#enhanced-second-chance-algo">Enhanced Second-Chance Algo</a></li>
</ul>
</li>
<li><a href="#counting-algos">Counting Algos</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#allocation-of-frames">Allocation of Frames</a></li>
<li><a href="#thrashing">Thrashing</a>
<ul>
<li><a href="#demand-paging-1">Demand Paging</a></li>
<li><a href="#working-set-model">Working-Set Model</a></li>
</ul>
</li>
<li><a href="#allocating-kernel-memory">Allocating Kernel Memory</a></li>
</ul>
</li>
<li><a href="#storage-management">Storage Management</a>
<ul>
<li><a href="#mass-storage-structure">Mass-Storage Structure</a>
<ul>
<li><a href="#overview-of-mass-storage-structure">Overview of Mass Storage Structure</a>
<ul>
<li><a href="#hard-disks">Hard Disks</a></li>
<li><a href="#nonvolatile-memory-devices">Nonvolatile Memory Devices</a></li>
<li><a href="#disk-attachment">Disk Attachment</a></li>
<li><a href="#address-mapping">Address Mapping</a></li>
</ul>
</li>
<li><a href="#hdd-scheduling">HDD Scheduling</a>
<ul>
<li><a href="#first-come-first-serve">First Come First Serve</a></li>
<li><a href="#scan">SCAN</a></li>
<li><a href="#c-scan">C-SCAN</a></li>
</ul>
</li>
<li><a href="#nvm-scheduling">NVM Scheduling</a></li>
<li><a href="#raid-structure">RAID Structure</a></li>
</ul>
</li>
<li><a href="#io-systems">I/O Systems</a>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#io-hardware">I/O Hardware</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#security-and-protection">Security and Protection</a>
<ul>
<li><a href="#security">Security</a>
<ul>
<li><a href="#how-systems-fail">How Systems Fail</a></li>
<li><a href="#what-is-security">What is Security</a></li>
<li><a href="#info-security-strats">Info Security Strats</a></li>
</ul>
</li>
<li><a href="#protection">Protection</a>
<ul>
<li><a href="#goal-of-protection">Goal of protection</a></li>
<li><a href="#principles-of-protection">Principles of Protection</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#exam-review">Exam Review</a>
<ul>
<li><a href="#exam-housekeping">Exam Housekeping</a></li>
<li><a href="#qna">QnA</a></li>
<li><a href="#final-exam-practice">Final Exam Practice</a></li>
</ul>
</li>
</ul>
<h1 id="computer-system-overview">Computer System Overview</h1>
<h2 id="what-operating-systems-do">What Operating Systems Do</h2>
<p>Components to a computer structure:</p>
<ul>
<li>user</li>
<li>application programs</li>
<li>operating system</li>
<li>computer hardware</li>
</ul>
<p>OS sits in between the user and the hardware,
handling how the application programs interact with the hardware.</p>
<p>OS Goals:</p>
<ul>
<li>execute user programs</li>
<li>convenient and easy to use
<ul>
<li>not hard to use</li>
</ul>
</li>
<li>efficiently use hardware</li>
</ul>
<p>user pov:</p>
<ul>
<li>want
<ul>
<li>easy to use</li>
<li>good performance</li>
<li>secure</li>
</ul>
</li>
<li>don’t care about efficiency</li>
</ul>
<p>Smartphones and tablets are good from the user pov since they are optimized for usability and batter life.</p>
<p>The touch screens and voice interactions allow for better usability.</p>
<p>Even though in reality the phone could be pretty wasteful when it comes to the resources.</p>
<hr>
<p>Profesor’s Soapbox:</p>
<ul>
<li>we should be more concerned with the lack of privacy that comes with the convenience</li>
<li>she doesn’t like the argument that if you don’t have anything to hide then you shouldn’t care</li>
<li>“privacy is our right”</li>
<li>she wants us to take into account privacy and security regarding user data</li>
</ul>
<hr>
<p>Embedded Computers:</p>
<ul>
<li>little/no user interface</li>
<li>ex
<ul>
<li>home devices
<ul>
<li>motion sensor lights</li>
<li>computerized water systems</li>
<li>computerized heating system</li>
</ul>
</li>
<li>car computers</li>
<li>numeric keypads</li>
<li>presto scanner</li>
</ul>
</li>
<li>run primarily without user intervention</li>
</ul>
<p>System pov:</p>
<ul>
<li>OS must keep all users happy in the case of shared computers</li>
<li>OS is the resource allocator and control program
<ul>
<li>efficiently manage the execution of user programs</li>
</ul>
</li>
<li>I/O devices are important in this respect
<ul>
<li>hard to manage and work with efficiently</li>
</ul>
</li>
</ul>
<p>Operating System definition</p>
<ul>
<li>no universally accepted definition
<ul>
<li>“we define the operating system as we go”</li>
</ul>
</li>
<li>is a resource allocator
<ul>
<li>manage all resources</li>
<li>decides between conflicting requests for efficient and fair resource use</li>
</ul>
</li>
<li>is a control program</li>
<li>controls execution of programs to prevents erors and imporoper use of the computer</li>
<li>everything a vendor ships when you order an operating system is a good approximation but varies wildly</li>
<li>the one program running at all times on the computer is the kernel which is part of the operating system</li>
<li>everything else is either
<ul>
<li>a system program that ships with the operating system</li>
<li>or</li>
<li>an application program</li>
</ul>
</li>
</ul>
<p>Mobile operating systems often include not only a core kernel but also middleware</p>
<ul>
<li>a set of software frameworks that provide additional services to application developers</li>
</ul>
<p>kernel is the core of the system</p>
<p>not all computer systems have some sort of user interaction</p>
<h2 id="computer-system-organization">Computer-System Organization</h2>
<p><img src="../images/image.png" alt="Alt text"></p>
<p>cpu talks to the memory in order to get instructions</p>
<p>memory is typically volatile so it loses all information once it shuts down</p>
<p>system bus:</p>
<ul>
<li>provides communication among processors, main memory, and I/O modules</li>
</ul>
<p>Device controllers are things like the disk controller and usb controller.</p>
<p>There’s local memory on the controller that acts as a buffer storage.</p>
<p>the controller moves data between the peripheral devices and the buffer storage.</p>
<p>There are software versions of these drivers too.</p>
<h3 id="competing-for-resources">Competing for Resources</h3>
<p>CPU and controllers can execute in parallel, competing for memory cycles.</p>
<p>They both need to go through the memory</p>
<ul>
<li>cpu fetches instructions from memory</li>
<li>I/O device sends information through memory</li>
<li>modern computers use DMA (direct memory address) that we speak on later</li>
</ul>
<h2 id="computer-system-operation">Computer-System Operation</h2>
<p>How does the processor execute an instruction?</p>
<p>There are registers inside of the cpu itself</p>
<ul>
<li>this is based off of the architecture (design) of the processor itself</li>
<li>very fast storage to read and write to</li>
<li>used to save, store, and use instructions</li>
<li>very expensive, fast, and limited</li>
</ul>
<p>Memory Address Register (MAR) specifies the address in memory for the next read or write</p>
<p>Memory Buffer Register (MBR)contains teh data to be written/read into/from memory</p>
<p>I/O Address Register (I/O AR) specifies a particular I/O device we’re working with</p>
<p>I/O Buffer Register (I/O BR) used for the exchange of data between an I/O module and the processor.</p>
<p>CPU is waiting for the inupt</p>
<p>Instructions always have to come from memory.
It can only be loaded from the memory.</p>
<p>I/O doesn’t input instructions,
it inputs/outputs data.</p>
<p>CPU can pull directly from IO device</p>
<p>Memory and I/O:</p>
<ul>
<li>memory is a set of locatiosn defined in sequentially numbered addresses</li>
<li>each location contains a bit pattern that can be interpreted as either an instruction or data</li>
<li>an I/O module transfers dtat from external devices to processor and emmory, and vice versa</li>
</ul>
<h3 id="instruction-execution">Instruction Execution</h3>
<p>A program to be executed by a processor consists of a set of instructions stored in
memory.</p>
<p>The processor reads (fetches) instructions from memory one at a time and
executes each instruction.</p>
<p>The processing required for a single instruction is called an instruction cycle.</p>
<p>Fetch and Execute is an atomic operation:</p>
<ul>
<li>If you fetch an operation then you can’t do anything else until you execute that operation</li>
<li>they come together</li>
</ul>
<p>Program halts if:</p>
<ul>
<li>processor turns off</li>
<li>unrecoverable error occurs</li>
<li>program instruction that halts the processor is encountered
<ul>
<li>tell the processor to wait for an input or output</li>
</ul>
</li>
</ul>
<p><img src="../images/image-1.png" alt="Alt text"></p>
<p>Instruction Fetch and Execute from CPU pov:</p>
<ul>
<li>processor fetches an instruction from memory</li>
<li>program counter (PC) holds the address of the next instruction to be fetched</li>
<li>PC is incremented after each fetch
<ul>
<li>on to the next instruction</li>
<li>unless the instruction loaded tells us to change the PC differently</li>
</ul>
</li>
<li>fetched instruction is loaded into the instruction register (IR)</li>
<li>the processor interprets the instruction and performs the required action:
<ul>
<li>processor-memory: data transfer</li>
<li>Processor-I/O: data transfer</li>
<li>Data processing: arithmetic or logic operations</li>
<li>Control: an instruction may specify that the sequence of execution be altered.</li>
</ul>
</li>
</ul>
<hr>
<p>Hypoethical 16 bit machine</p>
<p>opcode - operation code that tells the processor what to do</p>
<p>address - data needed</p>
<p>S - sign of the data (0 = +ve, 1 = -ve)</p>
<p><img src="../images/image-2.png" alt="Alt text"></p>
<p>These are all displayed in hex</p>
<p><img src="../images/image-3.png" alt="Alt text"></p>
<p>1:</p>
<ul>
<li>fetch instruction from <code>300</code></li>
<li><code>1940</code> is loaded to <code>IR</code>
<ul>
<li><code>1</code> = <code>001</code> = load AC from memory</li>
<li><code>940</code> is where we’re grabbing from</li>
</ul>
</li>
<li>increment <code>PC</code></li>
<li>load <code>0003</code> from <code>940</code> into <code>AC</code></li>
</ul>
<h3 id="interrupts">Interrupts</h3>
<p>An interrupt is a signal for the cpu to pay attention to the device.</p>
<p>You can process user inputs very quickly so that it doesn’t feel laggy.</p>
<p>Most IO devices are much slower than the cpu so it’s less efficient for the cpu to just wait on the IO device so it’s better for the IO device to just cut in whenever it needs to.</p>
<p>Most operating systems are interrupt driven, I/O devices will cut in whenever they need to so that the cpu doesn’t have to pause and wait on them.</p>
<hr>
<p>lect 1 end</p>
<hr>
<p>There are different kinds of interrupts:</p>
<ul>
<li>hardware and software
<ul>
<li>whenever hardware or software wants to seek the attention of the processor</li>
<li>hardware sends <em>signal</em> through a peripheral device to interrupt the processor</li>
<li>software executes a specific instruction to interrupt the processor</li>
</ul>
</li>
<li>vectored and non-vectored
<ul>
<li>interupt transfers control to a specific address which contains the interrupt vector
<ul>
<li>the interrupt vector has the address of the ISR</li>
<li>it’s like a low level database that tells you what to do for a given interrupt</li>
</ul>
</li>
<li>interrupt vector table contains addresses that inform the interrupt handler as to where to find the interrupt service routines (ISR)</li>
<li>vectored: manufacturer of the processor predefines this vector address
<ul>
<li>it’s hardcoded/built-in</li>
</ul>
</li>
<li>non-vectored: vector address is not predefined
<ul>
<li>address of the required ISR for the interrupt is provided by the interrupting device</li>
</ul>
</li>
</ul>
</li>
<li>maskable and non-maskable
<ul>
<li>non-maskable: cannot be ignored
<ul>
<li>reserved for events such as
<ul>
<li>unrecoverable memory errors</li>
<li>hardware failure</li>
<li>system crash</li>
<li>force shutdown or cutting power
<ul>
<li>non-maskable, hardware interrupt</li>
<li>needs to have the option to shutdown gracefully and minimize damage to hardware</li>
</ul>
</li>
<li>overheating
<ul>
<li>heat sensors tell the processor to stop so that the heat can dissipate</li>
</ul>
</li>
</ul>
</li>
<li>don’t ignore</li>
<li>attend to immediately</li>
</ul>
</li>
<li>maskable: can be ignored
<ul>
<li>turned off by CPU before the execution of critical instruction sequences that cannot be interrupted</li>
<li>non-essential for core system function</li>
<li>used by device controllers to request service
<ul>
<li>keyboard</li>
<li>printer</li>
</ul>
</li>
<li>usually only ignored for a while</li>
<li>could potentially be ignored forever
<ul>
<li>almost never happens</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>These different types are can overlap.</p>
<p>We might have a vectored, non-maskable, software interrupt or a non-vectored, maskable, hardware interrupt.</p>
<p>When the cpu is interrupted,
it stops what it’s doing and transfers execution to a fixed location.</p>
<p>Fixed location usually has a starting address where the service routine for the interrupt is located.</p>
<p>The interrupt service routine executes.</p>
<p>After the routine completes, the cpu goes back to what it was doing before.</p>
<p><img src="../images/image-4.png" alt="Alt text"></p>
<p>For the user program,
an interrupt suspends the noraml sequence of execution.</p>
<p>When the interrupt processing is completed,
execution resumes.</p>
<p>In the above image we see the I/O device making the request, sending it to the processor, then the processor processing the interrupt shortlythereafter then signalling that it’s done when it’s done.</p>
<p><img src="../images/image-5.png" alt="Alt text"></p>
<h4 id="instruction-cycle-with-interrupts">Instruction Cycle with Interrupts</h4>
<p><img src="../images/image-6.png" alt="Alt text"></p>
<p>Interrupt stage is added to the instruction cycle.</p>
<p>At the execute stage,
the processor checks to see if any interrupts have occured.</p>
<p>If none,
proceed to fetch stage as usual.</p>
<p>Otherwise,
the processor executes an interrupt handler routine instead of going to the fetch stage continue the program execution.
After that it continues.</p>
<p>An interrupt handler routine is generally part of the OS.</p>
<p>The routine:</p>
<ul>
<li>determines the nature of the interrupt</li>
<li>performs whatever actions are needed
<ul>
<li>e.g. find out what I/O module generated the interrupt and brach to a program that will write more data out to that I/O module</li>
</ul>
</li>
<li>allows the processor to continue executing the uesr program after it finishes</li>
</ul>
<h4 id="program-status-word">Program Status Word</h4>
<p>An interrupt can trigger lots of events in the processor hardware and software.</p>
<p>Program Status Word (PSW) contains status information about the currently running process:</p>
<ul>
<li>memory usage</li>
<li>codes</li>
<li>status information
<ul>
<li>interrupt enable/disable bit</li>
<li>kernel/user-mode bit</li>
</ul>
</li>
</ul>
<p><img src="../images/image-7.png" alt="Alt text"></p>
<p>We cover this in more detail later on.</p>
<h4 id="flow-control-with-and-without-interrupts">Flow Control With and Without Interrupts</h4>
<p>Let’s take an example of flow control without interrupts.</p>
<p><img src="../images/image-8.png" alt="Alt text"></p>
<p>the black dotted arrow shows how the execution flows</p>
<p><code>1</code>, <code>2</code>, <code>3</code> refer are segments of code that don’t involve I/O</p>
<p>The write calls involve I/O and call an I/O routine/program pictured on the right:</p>
<ul>
<li><code>4</code> prepares for the actual I/O operation</li>
<li>then there’s the I/O command</li>
<li><code>5</code> complete the I/O operation</li>
<li>then it ends and we return</li>
</ul>
<p>The write calls call to an I/O routine</p>
<p>Suppose now there are interrupts with short waits.</p>
<p><img src="../images/image-9.png" alt="Alt text"></p>
<p>Now we see an interrupt in the segments <code>2</code> and <code>3</code> dividing them into <code>2a</code>&amp;<code>2b</code> and <code>3a</code>&amp;<code>3b</code> respectively.</p>
<p>At the dividing points we have the execution move to the interrupt handler before going back to the user program.</p>
<p>Suppose now there are still interrupts but now with long waits</p>
<p><img src="../images/image-10.png" alt="Alt text"></p>
<p>The interrupts no longer occur during the segments that don’t involve calling to another routine.</p>
<p>Instead they happen when the user program calls to another routine,
the write calls.</p>
<p>So above we went over different techniques for handling I/O operations</p>
<ul>
<li><code>(a)</code>: programmed I/O</li>
<li><code>(b)</code> and <code>(c)</code>: interrupt-driven I/O</li>
</ul>
<p>There is another third technique that we can go over later today called direct memory access (DMA)</p>
<p><img src="../images/image-11.png" alt="Alt text"></p>
<p>Using interrupts it takes less time and is more efficient as the processor doesn’t need to idle.</p>
<p>We have to be aware of the overhead as we get faster however.</p>
<p>A cpu core can execute 1 instruction at a time. Multi-core CPUs can execute multiple cores at a time.
Multi-threading adds to this.</p>
<p>In order to utilize this we need to program in a way to take advantage of parallel execution.</p>
<h4 id="multiple-interrupts">Multiple Interrupts</h4>
<p>Suppose there is an interrupt during the processing of another interrupt, we can either:</p>
<ul>
<li>disable interrupts while an interrupt is being processed
<ul>
<li>hard to work with if there’s un-maskable interrupts</li>
</ul>
</li>
<li>use a priority scheme</li>
</ul>
<p>With disabled interrupts we might have an interrupt while we’re handling another interrupt.</p>
<p>We finish handling the first interrupt before attending to the other interrupt.</p>
<p><img src="../images/image-12.png" alt="Alt text"></p>
<p>This does not take into account relative priority or time-critical needs.</p>
<p>With prioritized interrupts we can interrupt the interrupt handler in order to handle a more important interrupt.</p>
<p><img src="../images/image-13.png" alt="Alt text"></p>
<p>Interrupt Y has a higher priority than interrupt X which results in the execution we see above.</p>
<hr>
<p>Example</p>
<p>3 I/O devices in order of least to greatest priority:</p>
<ul>
<li>printer - priority 2</li>
<li>disk - priority 4</li>
<li>comms - priority 5</li>
</ul>
<p>timeline <code>t=x</code>:</p>
<ul>
<li>00: begin</li>
<li>10: printer interrupt</li>
<li>15: comms interrupt</li>
<li>20: disk interrupt</li>
</ul>
<p>each interrupt lasts 10 time units</p>
<p>how will these interrupts be executed?</p>
<p>my answer:</p>
<ul>
<li>10: begin printer interrupt
<ul>
<li>15: begin comms interrupt</li>
<li>25: end comms interupt</li>
<li>25: begin disk interrupt</li>
<li>35: end disk interrupt</li>
</ul>
</li>
<li>40: end printer interrupt</li>
</ul>
<p><img src="../images/image-14.png" alt="Alt text"></p>
<hr>
<h3 id="storage-structure">Storage Structure</h3>
<h4 id="von-neumann-architecture">Von Neumann Architecture</h4>
<p><img src="../images/image-15.png" alt="Alt text"></p>
<h4 id="main-memory">Main Memory</h4>
<p>CPU can only load instructions from memory so programs must be loaded into memory in order to run.</p>
<p>Computers run most of their programs from rewritable memory, called main memory (aka random access memory(aka RAM))</p>
<p>Main memory is volatile (loses everything when powered off) and is commonly implemented in a semiconductor technology called dynamic random-access memory (DRAM).</p>
<h5 id="rom%2C-eprom%2C-and-eeprom">ROM, EPROM, and EEPROM</h5>
<p>bootstrap program is loaded at power-up
or reboot:</p>
<ul>
<li>the computer is checking itself
<ul>
<li>this is also known as post</li>
</ul>
</li>
<li>Initializes all aspects of the system
<ul>
<li>all your bios shit</li>
</ul>
</li>
<li>Loads operating system kernel and
starts execution</li>
<li>We can’t store it to the RAM, instead
it is typically stored in ROM or
EPROM, and is generally known as
firmware
<ul>
<li>the rom, eprom, or eeprom are non-volatile so we put the bootstrap there</li>
</ul>
</li>
</ul>
<p><img src="../images/image-16.png" alt="Alt text"></p>
<h6 id="rom">ROM</h6>
<p>read only memory.</p>
<p>non-volatile</p>
<p>data is written there permanently during the manufacturing.</p>
<p>Used for storing firmware and software that does not need to be changed ferquently</p>
<p>ex:</p>
<ul>
<li>BIOS</li>
<li>embedded system firmware</li>
</ul>
<h6 id="eprom">EPROM</h6>
<p>EPROM (Erasable Programmable Read-Only
Memory): only reprogrammable after being erased by exposing it to
ultraviolet (UV) light.</p>
<p>Commonly used in early embedded systems and
microcontrollers.</p>
<h6 id="eeprom">EEPROM</h6>
<p>EEPROM (Electrically Erasable Programmable
Read-Only Memory): A type of memory that can
be reprogrammed electrically, without the need
for UV light.</p>
<p>Can be reprogrammed in place without the need
for removal from the circuit.</p>
<p>Used in applications where data needs to be
updated or modified periodically, such as in
configuration settings.</p>
<h4 id="secondary-storage">Secondary Storage</h4>
<p>we want programs and data to reside in main memory permanently but main memory is too small (to get a reasonably large size to store data permanently) and it’s volatile.</p>
<p>We use non-volatile secondary storage as an extension of the main memory.</p>
<p>Hard-disk drives (HDDs) and nonvolatile memory (NVM) hold onto things before we load them into memory.</p>
<p>HDD</p>
<ul>
<li>metal or glass platters covered with magnetic recording material</li>
<li>head that moves and disk that rotates to read off of the disk</li>
<li>physical head moves</li>
</ul>
<p>Solid-state disks (SSD)</p>
<ul>
<li>faster than HDD</li>
<li>is not limited by the disk head movement</li>
</ul>
<p>It’s more accurate to think of it as storage in addition to being an extension of the main memory as opposed to just being an extension of the main memory.</p>
<p>Non-volatile memory (NVM)</p>
<ul>
<li>harder than hard disks</li>
<li>becoming more popular</li>
</ul>
<p>prof uses external ssd but doesn’t know about nvme ssd and sata ssd??</p>
<h4 id="tertiary-storage">Tertiary Storage</h4>
<p>Slow and large.</p>
<p>Used for special purposes,
typically as a backup of material stored on other devices.</p>
<p>CD-ROM or blu-ray</p>
<p>magnetic tapes.</p>
<p>We still use magnetic tapes even though prof doesn’t think we do since last she used them was in '97.
What a fucking world we live in.
Still using magnetic tape.</p>
<h4 id="storage-hierarchy">Storage Hierarchy</h4>
<p><img src="../images/image-17.png" alt="Alt text"></p>
<p>going down the hierarchy we get cheaper, larger, and slower memory that is accessed less and less frequently by the processor.</p>
<h4 id="caching">Caching</h4>
<p>Used at many levels in a computer from the most basest of hardware to the most frivolous of software.</p>
<p>If we want to use information from a slower piece of storage then we will copy that information to a faster piece of storage.</p>
<p>In the above instance we would describe the faster piece of memory as our cache.</p>
<p>We copy things from the secondary storage (the drives) to the main memory (ram) in order to have programs execute faster.
The main memory is the cache.</p>
<p>When we want to grab information we check the cache to see if it’s there</p>
<ul>
<li>if it is, we use it directly from there</li>
<li>if not, we copy the data to the cache from the other storage and then use it there</li>
</ul>
<p>Hit Ratio:</p>
<ul>
<li>fraction of all memory accesses that are found in the faster memory</li>
<li>ex
<ul>
<li>processor has access to two levels of memory</li>
<li>lvl 1 - 1,000 bytes and access time of T1=0.1 μs</li>
<li>lvl 2 - 100,000 bytes and access time of T2=1 μs</li>
<li>Suppose 95% of the memory accesses are found in the cache</li>
<li>For H=0.95, the average time to access a byte = (0.95) (0.1 μs) + (0.05) (0.1 μs + 1 μs) = 0.095 + 0.055 = 0.15 μs</li>
<li>We want to keep the hit ratio high and the access time(s) low</li>
</ul>
</li>
</ul>
<h3 id="i%2Fo-structure">I/O Structure</h3>
<p>A large portion of operating sytem code is dedicated to managing I/O:</p>
<ul>
<li>important to keeping system reliable</li>
<li>the varying nature of devices makes this a complex task that requires a lot of code
<ul>
<li>cameras, mice, keyboards, printers, fax machines, scanners, and all manner of devices are all classified under I/O device but will all have different needs</li>
</ul>
</li>
</ul>
<p>When the prcoessor encounters an instruction relating to I/O,
it executes that instruction by issuing a command to the appropriate I/O module.</p>
<p>Possible techniques for I/O operations (2 of which covered previously <a href="#flow-control-with-and-without-interrupts">here</a>):</p>
<ol>
<li>programmed I/O</li>
<li>interrupt-driven I/O</li>
<li>Direct Memory Access (DMA)</li>
</ol>
<p>We previously mentioned that programmed I/O is very inefficient as it would require the processor to wait on the I/O devices as no device can keep up with the processor.</p>
<p>Interrupt-driven is fine for moving small amounts of dat but can produce high overhead when used for bulk data movement.
Burst memory movement is pretty good for all of this
Remember that all operating systems nowadays are interrupt-driven.</p>
<p>But we run into the problem of I/O requests running into other I/O requests.</p>
<p>We need more efficiency which is where DMA comes in.</p>
<h4 id="direct-memory-access-structure">Direct Memory Access Structure</h4>
<p>DMA is used for high speed I/O devices capable of transmitting info at close to memory speeds.</p>
<p>Blocks of data is transfered from the buffer storage to the main memory by the device controller w/o the cpu intervening.</p>
<p>Only one interrupt is generated per block, rather than one interrupt per byte as is the case in interrupt-driven I/O.</p>
<p>A von Neumann architecture:
<img src="../images/image-18.png" alt="Alt text"></p>
<p>DMA is performed by a separate module on the system bus or incorporated into an I/O module.</p>
<p>When the prcessor wishes to read or write data it issues a command to the DMA module containing:</p>
<ul>
<li>whether a read or write is requested</li>
<li>address of the involved I/O device</li>
<li>starting memory location for the read/write</li>
<li>number of words to read/write</li>
</ul>
<p>The processor returns to it’s own work while the I/O operation is contrinued on by the DMA module.</p>
<p>DMA transfers the block one word at a time, directly to/from memory w/o processor.</p>
<p>Once complete,
DMA sencds interrupt signal to the processor.</p>
<p>Processor is only involved at the beginning and end of the transfer makig it far more efficient than interrupt driven or programmed I/O.</p>
<p><img src="../images/image-19.png" alt="Alt text">
<img src="../images/image-20.png" alt="Alt text">
<img src="../images/image-21.png" alt="Alt text">
<img src="../images/image-22.png" alt="Alt text">
<img src="../images/image-23.png" alt="Alt text">
<img src="../images/image-24.png" alt="Alt text">
<img src="../images/image-25.png" alt="Alt text"></p>
<h1 id="operating-system-structures">Operating System Structures</h1>
<p>We look at generic operating system design in this course.</p>
<p>Different designers have different paradigms and ideas.</p>
<p>POSIX is used for linux and macOS</p>
<p>Android uses different things.</p>
<p>The fundamentals are all the same but we may have different names for things and different styles of schedules.</p>
<p>For specific issues we may look at examples of how different operating systems do things</p>
<h2 id="computer-system-architecture">Computer System Architecture</h2>
<p>we can categorize a computer system according to teh # of general-purpose processors used:</p>
<ul>
<li>in contrast to application specific processors
<ul>
<li>found less often or even not at all</li>
</ul>
</li>
<li>single-processor systems</li>
<li>multiprocessor systems</li>
<li>clustered systems
<ul>
<li>different machines that work together</li>
</ul>
</li>
</ul>
<p>general purpose processor:</p>
<ul>
<li>type of microprocessor designed to handle a wide range of takss and applications</li>
<li>the typical processor</li>
</ul>
<p>single processor system:</p>
<ul>
<li>old days</li>
<li>most systems used to use only one cpu</li>
<li>a core is a basic computation unit of the cpu
<ul>
<li>a unit that can execute instructions</li>
</ul>
</li>
</ul>
<pre><code>prof's dad used to work at msx

that was her first computer

it was popular in the middle east and asia

there was a huge pyramid scheme surrounding msx

she remembered playing hangman on it with her brother

hunt and peck typing to code up hangman.

they had to reprogram hangman everytime they wanted to play since they didn't know how to save shit or I think they couldn't idk.

she saw the rise of the era of the 1.44 mb 3.5 inch floppies

if we had a lab this would've been so cool to listen to but rn idk
</code></pre>
<p>Most systems have special-purpose processors as well.</p>
<p>We might have graphics processors and all that</p>
<p>multiprocessor:</p>
<ul>
<li>these now dominate the landscape of computing</li>
<li>aka parallel systems, tighly-coupled systems</li>
<li>advantages:
<ul>
<li>increaseed throughput</li>
<li>increased reliability - fault tolerance</li>
</ul>
</li>
<li>2 types of systems
<ul>
<li>symmetric multiprocessing
<ul>
<li>each processor performs all tasks</li>
<li>processors share memory</li>
</ul>
</li>
<li>asymetric multriprocessing
<ul>
<li>each processor perofrms a specific assigned task</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="../images/image-107.png" alt="Alt text"></p>
<p>Symmetric:</p>
<ul>
<li>most common and what we’re workginw tih</li>
<li>each processor has a cpu w/ their own registers</li>
<li>they also have their own private/local cache</li>
<li>All processors share physical memory over the system bus</li>
<li><code>N</code> processes can run if there are <code>N</code> CPUs</li>
</ul>
<p>multicore systems can be more efficient that multiple chips with single cores because on-chip communication is faster tahn between-chip communications</p>
<p>each core effectively acts as a separate cpu in terms of execution (there are some caveats) and can more quickly communicate with one another.</p>
<p>One chip w multiple core uses significantly less power than multiple single-core chips.</p>
<p>There’s always a lot of overhead that comes in the form of inter-process and inter-program communication as well as resource allocation.
These problems feed back into one another as they need to communicate about the resource allocation.
It’s a big fucking mess</p>
<p>Dual-Core design</p>
<p>each core has it’s own reigster set and it’s own local chache often referred to as L1 cache</p>
<p>The level 2 or L2 cache is local to the chip and is shared by the two processing cores.</p>
<p>multicore processor with <code>N</code> cores appears to teh operating systems as N standard CPUs</p>
<p>Clustered Systems:</p>
<ul>
<li>2 or more individual systems (known as nodes) joined together</li>
<li>each node is typically a multicore system</li>
<li>no shared memory</li>
<li>loosely coupled systems</li>
<li>usually there is shared storage via a Storage-Area Network (SAN)
<ul>
<li>usually for very large networks</li>
<li>prof used to use a lot of SANs back in her old job</li>
</ul>
</li>
<li>communication at a hardware and software level
<ul>
<li>there is clustering software that shows the status of every node and all that</li>
<li>at the hardware level there is a sort of mini-operating system</li>
<li>maybe not too important but cool</li>
</ul>
</li>
<li>all cloud servers are clustered so that any server going down is invisible to the user
<ul>
<li>if you ping a server that goes down then you might not even notice as the ping just gets redirected</li>
</ul>
</li>
<li>all linked together to communicate via a Local-Area Network (LAN)</li>
<li>provides high availability and fault tolerance service which survives failures and provides increased reliability which is crucial in many applications
<ul>
<li>financial applications</li>
</ul>
</li>
</ul>
<p>Asymetric clustering:</p>
<ul>
<li>one machine in hot-standby mode while the other is running the applications
<ul>
<li>if server fails then standby becomes the active</li>
</ul>
</li>
</ul>
<p>symmetric clustering:</p>
<ul>
<li>multiple nodes running the applications and monitoring each other</li>
<li>more efficient</li>
<li>all active at the same time</li>
</ul>
<p>Some clusteres are for high-performance computing (HPC)</p>
<ul>
<li>applications must be spciallly writeten for use parallelization</li>
</ul>
<pre><code>Prof told us about PS/2, hdmi, dvi, and other ports and allat

Going over the anatomy of the motherboard.

The old university monitors still use vga and all of that.

Prof tells us how to intsall cpu and ram.
</code></pre>
<h2 id="operating-system-operations">Operating System Operations</h2>
<h3 id="multiprogramming-and-multitasking">Multiprogramming and Multitasking</h3>
<p>Allows the operating system to run multiple programs</p>
<p>Multiprogramming (batch system) needed for efficiency:</p>
<ul>
<li>single user cannot keep CPU and I/O devices busy at all times</li>
<li>multiprogramming orgnanizes jobs (code and data) so CPU always has one to execute</li>
<li>a subset of total jobs in asystem is kept in memory</li>
<li>one job selected and run via job scheduling</li>
<li>when it has to wait (for I/O for ex), OS switches to another job</li>
</ul>
<p>multitasking is a logical extension in which CPU executes multiple processes by switching among them very quickly.</p>
<p>Interactive computing.</p>
<p>multitasking</p>
<ul>
<li>each user has at least one program executing in memory, a process</li>
<li>if several jobs are ready to run at teh same time then we scheudle jobs for the cp</li>
<li>if processes don’t fit in memory then we swap them in and out of memory in order to run</li>
</ul>
<p>multiprogramming only can only execute one program at a time meanwhile all other processors are waiting for the processor.</p>
<p>With multiprocessing, more than one process can be running simultaneously, each on a different processor.</p>
<p><img src="../images/image-108.png" alt="Alt text"></p>
<p>Both of these let us run programs “at the same time”.</p>
<h3 id="dual-mode">Dual Mode</h3>
<p>Dual-mode operation:</p>
<ul>
<li>OS able to protect itself and other system components</li>
<li>2 modes
<ul>
<li>user mode</li>
<li>kernel mode</li>
</ul>
</li>
<li>mode bit is provided by hardware
<ul>
<li>distinguish between system running user or kernel code</li>
<li>some instructions are only executable in kernel mode
<ul>
<li>privileged instructions</li>
</ul>
</li>
<li>system call changes mode to kernel mode and return from call resets it ot user mode</li>
</ul>
</li>
</ul>
<p>CPUs increasignly support multi-mode operations</p>
<ul>
<li>Virtual Machine Manager (VMM) mode for guest VMs</li>
</ul>
<p>I’m thinking most of the operating system shit lives in kernel mode.</p>
<h4 id="transition-from-user-to-kernel-mode">Transition from User to Kernel Mode</h4>
<p>Operating system must always be in control of the CPU.</p>
<p>The user program can’t get stuck in an infinite loop or fail to call system services.</p>
<p>We use a timer to stop that from happening.
When the timer runs out it interrupts the computer.
The time length can either be fixed or variable.
No matter what we are able to regain control or terminate the program that goes over time.</p>
<p>There are different timers.</p>
<p>For example on linux systems we can observe different types of timers based on how the kernel is configured, what kind of machine it’s on, and what the architecture of the components are like.
We can configure a certain number of interrupts per second for example and it’s a HZ value.</p>
<p>Crucial takeaways:</p>
<ul>
<li>a timer can be used to prevent a user program from never returning control to the operating system</li>
<li>kernel mode has many different names
<ul>
<li>supervisor mode</li>
<li>system mode</li>
<li>privileged mode</li>
</ul>
</li>
</ul>
<h3 id="resource-management">Resource Management</h3>
<p>Remember that the operanting system is a resource manager.</p>
<p>File space, i/o, processes, memory, chache, etc. all managed by the OS</p>
<h4 id="process-management">Process Management</h4>
<p>Process management:</p>
<ul>
<li>a process is a program in execution
<ul>
<li>program is passive entity</li>
<li>process is active entity</li>
<li>unit of work within the system</li>
<li>once we run a program we have a runtime environment
<ul>
<li>allocated area in the memory where we will load in the code and text and stack and other values/variables that we need for the process</li>
</ul>
</li>
</ul>
</li>
<li>process needs resources to accomplish its task
<ul>
<li>CPU cycles</li>
<li>memory space</li>
<li>I/O</li>
<li>files</li>
<li>initialization data</li>
</ul>
</li>
<li>upon termination, resuable resources are reclaimed</li>
</ul>
<p>Threads and Processes:</p>
<ul>
<li>threads can be single-threaded or multithreaded</li>
<li>single-threaded
<ul>
<li>one program counter specifying the location of the next instruction to execute</li>
<li>process executes instructions sequentially</li>
</ul>
</li>
<li>multi-threaded
<ul>
<li>one program counter per thread</li>
<li>requires a multicore processor, each core works on a different thread</li>
<li>most processes aren’t multithreaded</li>
</ul>
</li>
</ul>
<p>Issues to Consider with Process Management</p>
<ul>
<li>synchronization
<ul>
<li>coordinate processes that need to share data</li>
</ul>
</li>
<li>mutual exclusion
<ul>
<li>how to make processes or users share a resource at the sam etime</li>
</ul>
</li>
<li>deadlocks
<ul>
<li>&gt;=2 processes can’t continue b/c they are waiting for the others to do something</li>
</ul>
</li>
<li>livelock
<ul>
<li>&gt;=2 processes continuously change their states in response to changes in other other process(es) without doing anything useful</li>
<li>“you go first” “no you go first” “no you go first” “no you go first” “no you go first” “no you go first” and then we do nothing forever</li>
</ul>
</li>
<li>starvation
<ul>
<li>process is overlooked indefinitely by the scheduler</li>
<li>it can proceed but is never chosen</li>
</ul>
</li>
</ul>
<p>We’re going to be looking at the pseudocode and underlying theory for programs that do this stuff correctly.</p>
<p>After that we can look at some real, runnable code to see what’s really going on.</p>
<p>There’s a lot of groundwork that needs to be done until we can even understand what the demos we’re going to get are doing when we run them.</p>
<p>Activities connected to process management:</p>
<ul>
<li>creating/deleting user and system processes</li>
<li>suspending/resuming processes</li>
<li>providing mechanisms for
<ul>
<li>process
<ul>
<li>synchronization</li>
<li>communication</li>
</ul>
</li>
<li>handling deadlocks</li>
</ul>
</li>
</ul>
<h4 id="memory-management">Memory Management</h4>
<p>All or part of the instructions and data needed for a program in the memory in order to execute the process.</p>
<p>Memory management optimizes cpu utilization and response to users.</p>
<p>What’s in the memory and when.</p>
<p>Memory Management Activities:</p>
<ul>
<li>keep track of what memory is being used by who</li>
<li>decide which processes (and their parts) and data to move in/out of memory</li>
</ul>
<h4 id="file-system-management">File-System Management</h4>
<p>most visible component</p>
<p>uniform, logical view of information storage</p>
<p>Abstracts from the physical properties of its storage devices (stores 1s and 0s and engravings and shit) to define a logical storage unit - file (<code>.c</code>, <code>.java</code>, <code>.py</code>, <code>.txt</code>, <code>.exe</code> files)</p>
<p>Each storage medium is controlled by a device with various processes</p>
<ul>
<li>access speed</li>
<li>capacity</li>
<li>data-transfer rate</li>
<li>access method
<ul>
<li>sequential or random</li>
</ul>
</li>
</ul>
<p>Activities:</p>
<ul>
<li>organize files into dirs</li>
<li>manage access perms</li>
<li>os activities
<ul>
<li>creating/deleting files/dirs</li>
<li>primitives to manip files and dirs</li>
<li>mapping files onto secondary storage</li>
<li>backup files onto stable(non-volatile) storage media</li>
</ul>
</li>
</ul>
<h4 id="mass-storage-management">Mass-Storage Management</h4>
<p>storing things like code and data when not in memory</p>
<p>Long term storage.</p>
<p>Very important to manage properly</p>
<p>Speed of computer operation hinges on dis subsystem and its algos.
How do we read and write in an efficient way</p>
<p>SSDs have semiconductor tech that’s really good but still very expensive so we still have to take other forms of storage into account.</p>
<p>Some storage doesn’t even have to be fast, just very long lived, large, and cheap.</p>
<p>Optical drives and magnetic tapes fall under the above category but they still need to be managed by OS or applications.</p>
<pre><code>Q: When I move a file to another computer, how does the other computer know what kind of file it is?

A: Every operating system has their own system to manage files. But there are many universally used ways of interpreting the files. The physical files themselves are the same so we just have to worry about the interpretation. Some files are platform specific (`.msi` = microsoft installer, `.deb` = debian package file) and they can't be interpreted properly by machines with the wrong operating system
</code></pre>
<p>OS Activities:</p>
<ul>
<li>(un)mounting
<ul>
<li>(dis)connect to storage medium</li>
</ul>
</li>
<li>free-space management
<ul>
<li>if you want to write, where do you go to write?</li>
<li>do we even have enough space to write?</li>
</ul>
</li>
<li>storage allocation</li>
<li>disk scheduling</li>
<li>partitioning</li>
<li>protection</li>
</ul>
<h4 id="caching-management">Caching Management</h4>
<p>Recall that cache is a faster piece of storage that we place frequently accessed data that we would ordinarily store in slower storage.</p>
<p>Caches have limited size so we need to manage what we store in their and when.</p>
<p>The size and replacement policy can greatly impact performance.</p>
<p><img src="../images/image-26.png" alt="Alt text"></p>
<p>CPUs have cache that the OS doesn’t really mess with but there’s other forms of cache that the OS is concerned with</p>
<p>Access time:</p>
<ul>
<li>time needed to arrive at the byte we want to read/write</li>
<li>takes time to do the calculation and find the exact address</li>
<li>the time the cache tech needs to arrive at the right location</li>
</ul>
<p>Bandwidth:</p>
<ul>
<li>speed of the read/write</li>
<li>a unit of data per second, typically megabytes</li>
</ul>
<p><img src="../images/image-27.png" alt="Alt text"></p>
<h5 id="cache-coherence">Cache Coherence</h5>
<p><img src="../images/image-28.png" alt="Alt text"></p>
<p>There might be multiple processors with their own caches but there cuold be some incorrect execution that results in 2 or more copies of a cache block to exist in 2 different processors’ caches</p>
<p>This is a problem when we try to write back that cache.</p>
<h4 id="i%2Fo-subsystem-management">I/O Subsystem Management</h4>
<p>OS is meant to hide particularities of hardware devices from the user</p>
<p>responsible for:</p>
<ul>
<li>memory management of I/O
<ul>
<li>buffering - temp storage of data while being trasnferred</li>
<li>caching - storing parts of data in faster storage for performance</li>
<li>spooling - overlapping of output of one job with input of other jobs</li>
</ul>
</li>
<li>general device-driver interface</li>
<li>drivers for specific hardware devices</li>
</ul>
<p>Everything not under processor or memory management can be thought of as being I/O in general but in this course we think of things more granularly</p>
<hr>
<p>Q: Two important design issues for cache memory are</p>
<p>A: Size and replacement policy</p>
<p>Q: What is the unit of work in a system?</p>
<p>A: Process</p>
<h2 id="operating-system-services">Operating System Services</h2>
<p>OSes provide an env to execute programs and services for users and other programs</p>
<p>2 types of OS Services with different goals:</p>
<ul>
<li>helpful to user</li>
<li>efficient operation of the system itself</li>
</ul>
<p>Services for the system and services for the user</p>
<h3 id="for-the-user">For the User</h3>
<p>The user does not have to be aware of how all of this works</p>
<p>User Interface:</p>
<ul>
<li>almost all operating systems have a User Interface (UI)</li>
<li>types:
<ul>
<li>Command-Line (CLI)</li>
<li>Graphical User Interface (GUI)</li>
<li>touch-screen</li>
</ul>
</li>
</ul>
<p><img src="../images/image-29.png" alt="Alt text"></p>
<p>Program Execution:</p>
<ul>
<li>load program into memory</li>
<li>run program</li>
<li>end execution
<ul>
<li>normally or abnormally and give error</li>
</ul>
</li>
</ul>
<p>I/O ops</p>
<p>File System Manip:</p>
<ul>
<li>read/write files</li>
<li>create/delete dirs</li>
<li>search for files/dirs</li>
<li>list file/dir info</li>
<li>manage perms</li>
</ul>
<p>Communications:</p>
<ul>
<li>exchange info within or without the computer using a network</li>
<li>shared memory or message passing via packets moved by the OS</li>
</ul>
<p>Error Detection:</p>
<ul>
<li>constantly aware of all errors and what to do</li>
<li>errors in CPU, memory, I/O devices, and programs</li>
<li>give debugging facilities</li>
</ul>
<pre><code>Q: What service is it when we force quit a program?

A: Things can go wrong on the software level, hardware level, or any number of other levels (within those levels). The best thing to do is dive into the debugging hole. If you're at a low level then you can see each instruction execute one at a time. EAX register, RAX register available to you. If you're at a higher level then you'll likely just get an error code to work it out.

It depends on what is happening. 
</code></pre>
<h3 id="for-the-system">For the System</h3>
<p>Resource Allocation:</p>
<ul>
<li>same as before</li>
<li>make sure no one can access what they shouldn’t be able to</li>
</ul>
<p>Logging:</p>
<ul>
<li>keep track of what’s being done and by who with what resources</li>
</ul>
<p>Protection and Security:</p>
<ul>
<li>control information that is stored and used</li>
<li>concurrent processes should not interfere with each other</li>
<li>protection ensures that all access to system resources are controlled</li>
<li>security
<ul>
<li>outside users require authentication
<ul>
<li>passwords</li>
<li>biometrics</li>
<li>physical key - yubikey</li>
<li>2FA</li>
</ul>
</li>
<li>defend against external I/O devices from invalid access attempts</li>
</ul>
</li>
<li>once users are allowed in the OS looks on the access control list (ACL) to see what the user is allowed to do</li>
</ul>
<hr>
<p>System call interface is the boundary between user programs and operating system services.</p>
<p>Yes</p>
<p>Is the GUI the most common UI?</p>
<p>It depends. CLI might be more common depending on what you’re doing.</p>
<p>There’s probably more CLIs kicking around in total but people mostly use GUIs</p>
<p>Touch screen is used on mobile a lot</p>
<p>yes</p>
<h2 id="user-operating-system-interfaces">User Operating System Interfaces</h2>
<p>CLI or command interpreter allows direct command entry</p>
<ul>
<li>implemented by kernel or some system programs</li>
<li>sometimes multiple different kinds of interpreters implemented
<ul>
<li>known as <code>shells</code></li>
<li>shell is loaded into run time env and we execute from there</li>
</ul>
</li>
<li>sometimes commands built-in, sometimes just names of programs
<ul>
<li>in the latter case then we don’t have to modify the shell itself to add new features
<ul>
<li>the shell is just a powerful program that can run other programs directly and access the resources</li>
</ul>
</li>
<li>we have the latter case a lot in our linux systems, even if we think things are built in they’re really just programs in the <code>/bin/</code> directory</li>
</ul>
</li>
<li>shell is merely the interpreter that you put in commands, the OS looks at what to do with that command, and runs the program</li>
<li>access to the shell is access to the whole computer</li>
</ul>
<pre><code>prof loves security, very passionate
</code></pre>
<p>GUI:</p>
<ul>
<li>user-friendly desktop metaphor interface
<ul>
<li>usually mouse, keyboard, and monitor</li>
<li>icons represent files, programs, actions, etc</li>
<li>invented at Xerox PARC</li>
</ul>
</li>
<li>Big developments in GUI designs come from open-source projects
<ul>
<li>KDE - K Desktop Environment</li>
<li>GNOME desktop by GNU project</li>
<li>both run on linux and unix systems</li>
<li>source code readily available for reading, modification, and even contribution under specific license terms</li>
</ul>
</li>
</ul>
<p>Touchscreen:</p>
<ul>
<li>impossible/undesired mouse</li>
<li>gesture based</li>
<li>virtual keyboard</li>
<li>uses a lot of voice commands</li>
</ul>
<hr>
<p>Remember that there are many different kinds of shells to choose from</p>
<h2 id="system-call">System call</h2>
<p>Provides a programming interface to the services provided by the OS</p>
<p>System calls are typically written in a high-level language (C or C++).</p>
<p>Mostly accessed by programs via a high-level Application
Programming Interface (API) rather than direct system call use</p>
<p>API specifies a set of functions that are availbe to an application programmer</p>
<p>params passed to functions to return expected values</p>
<p>3 most common:</p>
<ul>
<li>Win32 API for Windows</li>
<li>POSIX API
<ul>
<li>UNIX, Linux, Mac OS X</li>
</ul>
</li>
<li>Java API for Java Virtual Machine</li>
</ul>
<p>We might use system calls for:</p>
<ul>
<li>copying contents of one file to another file</li>
</ul>
<p>Types of System Calls:</p>
<ul>
<li>Process control</li>
<li>File management</li>
<li>Device Management</li>
<li>Information Maintenance</li>
<li>Communications</li>
<li>Protection</li>
</ul>
<p>System calls are run in kernel mode</p>
<h1 id="process-description-and-control">Process Description and Control</h1>
<h2 id="what-is-a-process">What is a Process</h2>
<p>Computers used to only execute 1 program at a time.
This program had complete control of the system and access to all it’s resources.</p>
<p>Now they can have multiple programs loaded into memory and executed at the same time.</p>
<p>With that evolution we needed more control and compartmentalization of running programs.</p>
<p>Thus came the birth of the process.</p>
<p>A process is:</p>
<ul>
<li>a program in execution</li>
<li>the unit of owrk in a modern computing system</li>
<li>an entity that can be assigned to a processor and executed on a processor</li>
<li>a unit of activity characterized by
<ul>
<li>the execution of a sequence of instructions</li>
<li>having a current state</li>
<li>having an associated set of system resources</li>
</ul>
</li>
</ul>
<p>2 essential components of processes:</p>
<ul>
<li>program code
<ul>
<li>text section</li>
</ul>
</li>
<li>set of data associated with that code
<ul>
<li>data section</li>
</ul>
</li>
</ul>
<p>We may be more precise later</p>
<p>A process can be uniquely characterized by anumber of elements:</p>
<ul>
<li>identifier
<ul>
<li>unique identifier associated w/ process to distinguish from all other processes</li>
<li>pid - process ID unique to a process</li>
<li>no 2 processes have the same pid</li>
</ul>
</li>
<li>state
<ul>
<li>if a prcess is currently executing it is in the <code>running</code> state</li>
</ul>
</li>
<li>priority
<ul>
<li>priority relative to other processes</li>
<li>what processes can it interrupt and what processes can interrupt it</li>
</ul>
</li>
<li>program counter
<ul>
<li>the address of the next instruction in the program to be executed</li>
</ul>
</li>
<li>memory pointers
<ul>
<li>includes pointers to the program code and data associated witht he process plus any memory blocks shared with other processes</li>
</ul>
</li>
<li>context data
<ul>
<li>data that are present in the registers during execution</li>
</ul>
</li>
<li>i/o status information
<ul>
<li>outstanding i/o requests</li>
<li>assigned devices</li>
<li>list of files used in the process</li>
</ul>
</li>
<li>accounting information
<ul>
<li>may include
<ul>
<li>amount of processor time</li>
<li>clock time used</li>
<li>time limits</li>
</ul>
</li>
<li>helps us log activities</li>
<li>find out who/what accessed things, when and why</li>
</ul>
</li>
</ul>
<p>This is all very general,
every OS has their own implementations but most every OS is going to have these things just under different names.</p>
<p>All of the above is stored in the process control block (PCB):</p>
<ul>
<li>created and managed by the operating system</li>
<li>makes it possible to interrupt a running process and later resume execution as if the interruption had not occured (context-switching)
<ul>
<li>context-switching is what this course is all about
<ul>
<li>trying to keep the processor busy and feed it new processes in order to increase the performance and allat</li>
<li>the speed of the processor is the speed limit of the computer, no one is faster than the processor. less of a road speed limit and more of a physical speed limit, like the speed of light</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Each process has only one program counter and thread for now.
We talk about multithreading and parallelism later on.</p>
<h2 id="process-states">Process States</h2>
<h3 id="process-trace">Process Trace</h3>
<p><img src="../images/image-30.png" alt="Alt text"></p>
<p>Trace:</p>
<ul>
<li>Characterize the behavior of an individual process by listing the sequence of instructions that execute for that process</li>
<li><em>set of instructions for a process</em></li>
<li>show how the traces of the various processes are interleaved</li>
</ul>
<hr>
<p>Example</p>
<p><img src="../images/image-31.png" alt="Alt text"></p>
<p>We have a small dispatcher process that switches the process from one process to another.</p>
<hr>
<p>Process Trace Execution
<img src="../images/image-32.png" alt="Alt text"></p>
<p>There’s a limit to how long a process can stay in the processor.</p>
<p>The above image shows how the dispatcher switches between the different processes in the previous image to the one above.</p>
<h3 id="simple-two-state-process-model">Simple Two-State Process Model</h3>
<p><img src="../images/image-33.png" alt="Alt text"></p>
<p>Processes change state as they execute.</p>
<p>With a 2 state model we have 2 states:</p>
<ul>
<li>running
<ul>
<li>the process is being executed</li>
</ul>
</li>
<li>not running
<ul>
<li>not being executed by processor</li>
</ul>
</li>
</ul>
<p><img src="../images/image-34.png" alt="Alt text"></p>
<p><img src="../images/image-35.png" alt="Alt text"></p>
<p>We can have the processes in a queue stored in the ram and we cycle through them, kicking a process out of the processor and back into the queue.
When we do that we set it’s state to the <code>Not Running</code> state.</p>
<p>When we start executing the new process we get to set that process’ state to <code>Running</code>.</p>
<p>Note: the entries in the queue are links to the process’ PCB as opposed to the whole process itself.</p>
<hr>
<p>The queue is a first-in-first-out list and the
processor operates in round-robin fashion on the
available processes.</p>
<p>Round-Robin: each process in the queue is given
a certain amount of time, in turn, to execute and
then returned to the queue, unless blocked.</p>
<p><code>I think every prof seems to have a different definition of "round robin"</code></p>
<hr>
<h3 id="operations-on-processes">Operations on Processes</h3>
<p>We need to be able to <code>_____</code> processes:</p>
<ul>
<li>create</li>
<li>terminate</li>
</ul>
<h4 id="creation">Creation</h4>
<p>4 reasons to create a new process:</p>
<ul>
<li>new batch job
<ul>
<li>OS is provided with a batch job control system</li>
<li>operating system is given a ton of jobs and has to execute them all in the proper priority</li>
</ul>
</li>
<li>interactive logon
<ul>
<li>system d, inet, etc</li>
<li>tons of processes start up to serve the user</li>
</ul>
</li>
<li>created by os to provide a service
<ul>
<li>when the user does stuff they will often start processes, withuot the user having to wait</li>
<li>send information to printers</li>
</ul>
</li>
<li>spawned by existing process
<ul>
<li>opportunity to exploit parallelism or for the purposes of modularity</li>
<li>modular design will allow any user to take advantage of the work that the process is doing</li>
<li>processes made to support other processes</li>
</ul>
</li>
</ul>
<p>On Spawning:</p>
<ul>
<li>parent process creates child processes forming a tree of processes</li>
<li>they may or may not be communicating with one another and/or sharing resources</li>
<li>all, some, or none of the resources are shared between the parent and child process</li>
<li>the parent and child may execute concurrently or the parent may wait until the child terminates</li>
<li>it all depends on what the purpose for the spawning was and what the processes were designed to do</li>
</ul>
<h5 id="fork">fork</h5>
<p>In unix-like OSes,
the creation of a child process is established through a system called <code>fork</code></p>
<p><code>fork</code> system call creates a copy by duplicating the parent process</p>
<ul>
<li>returns the child process ID to the parent and returns 0 to the child process</li>
<li>the child and parent processes know each others PIDs
<img src="../images/image-36.png" alt="Alt text"></li>
</ul>
<p>child process can execute a different program using <code>exec</code> system call</p>
<p>child can’t terminate until the parent collects the output of the child.
parent gives a <code>wait</code> command to the child and does the collection.</p>
<p>While the child waits then the child is known as a zombie.</p>
<p>If the parent dies then the child becomes an orphan.</p>
<hr>
<p>fork can be used in a program written by the user.</p>
<p>There are a variety of different reasons why you would want to fork so there’s many things that the child and parent processes can do together or separate.
We could see that they duplicate and continue to execute the same thing or they’ll duplicate and start doing different things and receiving commands from the parent program.</p>
<hr>
<p>Mircrosoft doesn’t like <code>fork()</code></p>
<ul>
<li>fork is insecure</li>
<li>fork gives the child more access than it needs since it copies everything by default</li>
<li>defies the least privilege principle
<ul>
<li>give the least privilege possible to get a job done in order to protect the user and system</li>
</ul>
</li>
<li>programs that fork but don’t exec render address-space layout randomisation ineffective, since each process has the same memory layout</li>
</ul>
<p>fork is fast and ha 0 parameters while windows’ CreateProcess has many parameters.</p>
<p>We also don’t run into the error of running out of memory.</p>
<p><code>prof really likes this paper and found it very interesting.</code></p>
<h5 id="createprocess">CreateProcess</h5>
<p>Windows doesn’t have a direct equivalent to fork.</p>
<p><code>CreateProcess</code> is used by Windows API</p>
<p>Spawn vs Fork</p>
<ul>
<li>fork
<ul>
<li>existing process creates identical copy of itself</li>
</ul>
</li>
<li>spawn
<ul>
<li>more general term for creating new process</li>
<li>implemented in various different ways depending on OS and programing env</li>
<li>doesn’t necessarily involve duplicating the existing process</li>
<li>spawned process may or may not have a relationship with the parent process
<ul>
<li>spawned process can be a different program altogether</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="tree-of-processes-in-linux">Tree of Processes in Linux</h5>
<p><img src="../images/image-37.png" alt="Alt text"></p>
<p><code>pstree</code></p>
<p>prof:
<img src="../images/image-39.png" alt="Alt text"></p>
<p>mine:
<img src="../images/image-38.png" alt="Alt text"></p>
<h4 id="termination">Termination</h4>
<p>A process terminates when it finishes executing its final statement and askss the operating system to delete it by using the <code>exit()</code> system call</p>
<p>all the resources of the process (physical and virtual) are deallocated and reclaimed by the operating system.</p>
<p>Batch job should include a halt instruction or an explicit os service call for termination. Halt will geernate an interrupt to alert the os that a process has completed.</p>
<p>Interactive applications (browsers and shit used by user) are terminated when the user decides typically.</p>
<p>parents can terminate children</p>
<p>WOW:<img src="../images/image-40.png" alt="Alt text"></p>
<p>not reading allat but pretty cool :thumbsup:</p>
<h3 id="five-state-process-model">Five-State Process Model</h3>
<p><em><strong>Note: THis is on the assignemnt (Thanks Cate)</strong></em></p>
<p>USing a single queue the dispatcher could not just select the process at the oldest end.</p>
<p>Dispatcher needs to find a process that is not blocked and that has been in the list for the queue for the longest.</p>
<p>Turn not <code>Not Running</code> into <code>Ready</code> and <code>Blocked</code></p>
<p>State process diagram
<img src="../images/image-41.png" alt="Alt text"></p>
<p>States:</p>
<ul>
<li>new
<ul>
<li>newly created process not yet admitted to the pool of executable processes by the OS</li>
</ul>
</li>
<li>ready
<ul>
<li>prepared to execute when given opportunity</li>
</ul>
</li>
<li>running
<ul>
<li>process that is currently being executed</li>
</ul>
</li>
<li>blocked
<ul>
<li>unix-based: waiting</li>
<li>process cannot execute until some event occurs such as completeion of an I/O operation</li>
</ul>
</li>
<li>exit
<ul>
<li>unix-based: terminated</li>
<li>process released from pool of executable processes by the OS</li>
<li>process has been halted or aborted for whatever reason</li>
</ul>
</li>
</ul>
<p>Transitions:</p>
<ul>
<li>null -&gt; new
<ul>
<li>new process is created to exec program</li>
</ul>
</li>
<li>new -&gt; ready
<ul>
<li>os is prepared to take on additional process</li>
</ul>
</li>
<li>ready -&gt; running
<ul>
<li>dispatcher dispatches the process</li>
<li>OS chooses ready process to run</li>
</ul>
</li>
<li>running -&gt; exit
<ul>
<li>process is terminated by the OS if the process indicates it has completed or if it aborts</li>
</ul>
</li>
<li>running<span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span>ready
<ul>
<li>running process has reached teh maximum allowable time for uninterrupted execution</li>
<li>no longer your turn on the xbox</li>
</ul>
</li>
<li>running<span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span>blocked
<ul>
<li>process requrests something for which it must wait</li>
</ul>
</li>
<li>blocked<span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span>ready
<ul>
<li>process in blocked state is moved to ready state when the event for which is has been waiting occurs</li>
</ul>
</li>
</ul>
<p>remember that we never have blocked to running.</p>
<p>still not perfect but more later</p>
<hr>
<p>Example</p>
<p><img src="../images/image-42.png" alt="Alt text"></p>
<p>while the processses are simply ready but not running, the dispatcher is running in order to go to dispatch them</p>
<p><img src="../images/image-43.png" alt="Alt text"></p>
<p>There are 2 queues:</p>
<ol>
<li>ready queue</li>
<li>blocked queue</li>
</ol>
<p><img src="../images/image-41.png" alt="Alt text"></p>
<p>So when we ready something up it actually goes into a queue and when something gets hit with an event wait it gets put into a blocked queue.</p>
<p>When a process</p>
<ul>
<li>is admitted to the system <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> admit to requdy queue</li>
<li>is chosen to run <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> select from ready queue</li>
<li>has to wait <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> send to blocked queue</li>
<li>times out <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> send to ready queue again</li>
<li>finishes <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> release</li>
</ul>
<p>In the absence of any priority scheme this can be a simple FIFO queue (round-robin).
Otherwise we could use something like a priority queue.</p>
<p>When an event occurs, any process in the blocked queue that has been waiting on that event only is moved to the ready queue.</p>
<p>The problem is that we have to scan the entire blocked queue which could have 100s or 1000s of blocked processes.</p>
<p>We can remedy this with the use of multiple blocked queues</p>
<p><img src="../images/image-44.png" alt="Alt text"></p>
<p>For each event that will cause an interrupt we will make a queue for it that way we don’t have to scan through the whole queue to find a process that corresponds to the event.</p>
<h3 id="suspended-processes">Suspended Processes</h3>
<p>Problem - it will become common for all of th eprocesses in memory to be waiting for I/O, and for the processor to become idle.</p>
<ul>
<li>there’s only so much memory space to store so many processes</li>
<li>we can pretty easily fill up the memory with all the processes and leave the processor idle since it only really works with shit in the memory.</li>
</ul>
<p>Solution - swapping</p>
<ul>
<li>move part or all of a process from mai memory to disk</li>
<li>it’s a very specific part of the disk that’s allocated for the memory to work with</li>
<li>“there is a specific page file dedicated by the operating system”</li>
<li>this is like the linux swap</li>
</ul>
<p>The only problem is how do we do that?</p>
<p>We add another state to our process model</p>
<p>When the OS swaps one of the <code>blocked</code> processes out on to the disk we put it into a <code>suspend</code>ed queue:</p>
<ul>
<li>a queue of existing processes that have been temporarily kicked out of th emain memory or suspended</li>
</ul>
<p>the os then brings in another process from the suspend queue or it honors a new-process request</p>
<p>execution then continues withthe newly arrived process</p>
<p><img src="../images/image-45.png" alt="Alt text"></p>
<p>So now when we block a process from there it can either go back to the ready queue or get sent to the suspend queue.</p>
<p>When it gets sent to the suspend queue then it gets sent to the disk to make more space in the memory.</p>
<p>Once it’s in the suspend queue,
we can activate it again.</p>
<p>So there are now 4 ways to get a process into the ready queue</p>
<ol>
<li>a newly admitted process</li>
<li>a proces times out</li>
<li>a blocked process is unblocked thanks to the event it was waiting on occuring</li>
<li>a suspended process is selected to become active once more</li>
</ol>
<p>If there is nothing in the ready queue and we’re waiting on blocked processes then we will start suspending processes to swap out of main memory so that we can admit new processes or activate one from the suspend.</p>
<p>It’s always preferrable to activate a suspended process.</p>
<p>The swap is always available - it is built into the architecture - and there’s always labels for each state.</p>
<p>When the OS performs a swapping-out operation, it has 2 choices for selecting a process to bring into main meomry:</p>
<ol>
<li>admit a newly created process</li>
<li>bring a previously suspended process(preferred)</li>
</ol>
<p>problem:</p>
<ul>
<li>all suspended processes were blocked when they were suspended</li>
<li>which one do we bring back?</li>
</ul>
<p>Each process in the suspend state was originally blocked on a particular event, something tha twe accounted for with the use of multiple queues.
We also know that once that event is over we know that the processes in its corresponding queue are no longer blocked.</p>
<p>We want to make another state for suspended processes</p>
<p><img src="../images/image-46.png" alt="Alt text"></p>
<p>For the processes in the secondary memory we’re able to have a ready and blocked queue for the suspended.</p>
<p>When we hear/read “suspend” then we think of the disk.</p>
<p><code>Blocked</code> <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> <code>Blocked+Suspend</code>:</p>
<ul>
<li>if there are no <code>Ready</code> processes then at least one blocked process is swapped out to make room for another process that is not blocked.</li>
</ul>
<p><code>Blocked+Suspend</code> <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> <code>Ready+Suspend</code>:</p>
<ul>
<li>a process was waiting for an event</li>
<li>the event finishes</li>
<li>the process is no longer blocked but it’s still suspended so it remains in the disk space but gets sent to a suspended ready queue</li>
</ul>
<p><code>Ready+Suspend</code><span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span><code>Ready</code>:</p>
<ul>
<li>when there are no <code>Ready</code> processes the OS will need to bring oen in to continue execution</li>
</ul>
<p><code>Ready</code><span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span><code>Ready+Suspend</code>:</p>
<ul>
<li>to free up a sufficiently large block of main memory</li>
<li>we have a ton of processes that are ready.</li>
</ul>
<p><code>Running</code><span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span><code>Ready+Suspend</code>:</p>
<ul>
<li>the OS is preempting the process because a higher-priority process on the <code>Blocked+Suspend</code> queue has just become unblocked</li>
<li>something higher priority just got unblocked and we need to execute on that one now instead</li>
<li>the os could move the running process directly to the <code>Read+Suspend</code> queue and fre some main memory</li>
<li>process preemption occurs when an execution process i interrupted by the processor so that another process can be executed</li>
</ul>
<p><code>New</code><span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span><code>Ready+Suspend</code>:</p>
<p><code>New</code><span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span><code>Ready</code>:</p>
<p>We could add more states but then there’s more work involved in changing between states.
There are more states in different designs however.</p>
<p>Q: How do we decide wether a <code>New</code> process goes straight to <code>Ready+Suspend</code> or <code>Ready</code>?</p>
<p>A:
we prefer to send a new process to the suspended queue.
THe OS will prefer grabbing from ready suspend.
Very rare that we will send something straight to ready since that would mean that the suspend is empty as well so there would be no point in sending it there first and wasting compute time on switching</p>
<p>A suspended process</p>
<ul>
<li>non immediately available for execution
<ul>
<li>all info sitting on secondary memory instead of main</li>
</ul>
</li>
<li>process was placed in a suspended state by
<ul>
<li>itself</li>
<li>a parent process</li>
<li>OS</li>
</ul>
</li>
<li>suspended in order to prevent execution</li>
<li>may or may not be waiting on an event</li>
<li>process may not be removed from this state until the agent orders the removal</li>
<li>reasons for suspensions
<ul>
<li>swapping</li>
<li>other OS reason
<ul>
<li>illegal memory access
<ul>
<li>usually terminates in that case</li>
</ul>
</li>
<li>buffer overflow</li>
</ul>
</li>
<li>interactive user request
<ul>
<li>debugging</li>
<li>want to use resource</li>
<li>minimizing applications or switching off of tabs so we don’t really need the program working</li>
</ul>
</li>
<li>timing</li>
<li>parent process request</li>
</ul>
</li>
</ul>
<h2 id="process-description-and-control-1">Process Description and Control</h2>
<p>In a multiprogramming env there are several processes that have been created and exist in virtual memory.</p>
<p><img src="../images/image-47.png" alt="Alt text"></p>
<p>What info doe sthe OS need to control processes and manage resources for them?</p>
<p>OS constructs and maintains tables of information about each entity that it is managing:</p>
<ul>
<li>memory tables</li>
<li>I/O tables</li>
<li>file tables</li>
<li>process tables</li>
</ul>
<p><img src="../images/image-48.png" alt="Alt text"></p>
<h3 id="memory-tables">Memory Tables</h3>
<p>main = real</p>
<p>secondary = virtual</p>
<p>we use memory tables to do:</p>
<ul>
<li>allocation of main meory to processes</li>
<li>allocation of secondary memory to processes</li>
<li>any protection attributes of blocks of main or virtual memory
<ul>
<li>which processes may access certain shared memory regions</li>
<li>prevent programs from accessing main or virtual memory that it’s not allowed to</li>
</ul>
</li>
<li>any information needed to manage virtual memory</li>
</ul>
<h3 id="i%2Fo-tables">I/O Tables</h3>
<p>used by the OS to manage the I/O devices and channels of the computer system</p>
<p>at any given time, an I/O device may be available or assigned toa  particular process</p>
<p>OS needs to know the status of the I/O operation and the location in main memory being used as the source or destination fo the I/O transfer</p>
<h3 id="file-tables">File Tables</h3>
<p>Provide information about the:</p>
<ul>
<li>existence of files</li>
<li>location on secondary memory</li>
<li>current statwus</li>
<li>other attribs</li>
</ul>
<p>may be maintined by a file management system (windows NTFS, linux/unix FAT) or the OS based on different operating system</p>
<h3 id="process-tables">Process Tables</h3>
<p>Must be maintained to manage processes</p>
<p>References memory, I/O, and files directly or indirectly in the process tables to show what the process needs/uses</p>
<p>when the OS is initialized it must have some access to some configuartion data that define the basic environment</p>
<ul>
<li>all the info required to build out the tables</li>
<li>everything you can see and view in the bios</li>
<li>I think anyways</li>
</ul>
<h3 id="process-control">Process Control</h3>
<p>to manage and control a process, the OS must know</p>
<ul>
<li>where the process is located</li>
<li>the attribs of the process that are necessary for its management</li>
<li>basically everything in the PCB</li>
</ul>
<p>What is the physical manifestation of a process?</p>
<p>a process must inclue:</p>
<ul>
<li>a program or set of programs to be executed</li>
<li>a set of data location for local and global variables</li>
<li>stack that is used to keep track of
<ul>
<li>procedure calls</li>
<li>parameter passing between procedures</li>
</ul>
</li>
<li>a number of attributes that are used by the OS for process control (Process control block)</li>
</ul>
<p>We refer to this as the <code>process image</code></p>
<p>Process Layout in Memory</p>
<p><img src="../images/image-49.png" alt="Alt text"></p>
<p>The stack goes from higher to lower addresses while the heap grows from lower addresses to higher addresses.</p>
<h3 id="process-location">Process Location</h3>
<p>location of a process image will depend on the memory managemnt scheem being used</p>
<p>At any given time parts of the process image can be both in the main and secondary memory</p>
<p>so we need process tables maintained by the OS to show the location of each page of each process image</p>
<h3 id="process-attributes">Process Attributes</h3>
<p>info resides in a process control block</p>
<p>there are 3 general categories</p>
<ol>
<li>process identification</li>
<li>processor state information</li>
<li>process control information</li>
</ol>
<p>process identification:</p>
<ul>
<li>each processor gets a unique numeric identifier
<ul>
<li>PID</li>
</ul>
</li>
<li>many of the bales controlled by the OS may use process identifiers to cross-reference process tables</li>
<li>interprocess communication uses PIDs to determine who is who and where</li>
<li>PIDs let us see who are parent and descendent processes
<ul>
<li>the parents have the child PIDs and the children have the parent PID</li>
</ul>
</li>
</ul>
<p>Process State Information</p>
<ul>
<li>what is the current state of the process</li>
<li>consists of the contents of processor registers
<ul>
<li>registers on the cpu itself, very fast</li>
</ul>
</li>
<li>nature of registers involved depend on the design of the processor but typically
<ul>
<li>user-visible registers</li>
<li>control and status registers</li>
<li>stack pointers</li>
</ul>
</li>
<li>all processor designs include a register or set of registers often known as the program status word (PSW) that contains condition codes plus status information
<ul>
<li>EFLAGS registers is an example of a PSW used by any OS running on an x86 processor</li>
<li><img src="../images/image-50.png" alt="Alt text"></li>
<li><img src="../images/image-51.png" alt="Alt text"></li>
</ul>
</li>
</ul>
<p>Process Control Information</p>
<ul>
<li>the additional information needed by the OS to control and coordinate the various active processes</li>
</ul>
<p><img src="../images/image-52.png" alt="Alt text"></p>
<p>Role of the Process Control Block</p>
<ul>
<li>most important data structure in an OS
<ul>
<li>contains all info needed by OS about process</li>
<li>blocks are read and/or modified by virtually every module in the OS</li>
</ul>
</li>
<li>the set of PCBs define that state of the OS</li>
</ul>
<p><img src="../images/image-53.png" alt="Alt text"></p>
<h2 id="process-control-1">Process Control</h2>
<p>Typical mangement functions:</p>
<ul>
<li>creation and termination</li>
<li>scheduling and dispatching</li>
<li>switching</li>
<li>synchronizationand support for interprocess communication</li>
<li>mangaement of PCBs</li>
</ul>
<p>we’re going to be looking at a lot of these.</p>
<h3 id="creation-1">Creation</h3>
<p>OS decides to create a new process</p>
<ol>
<li>assign a unique PID to the new process</li>
<li>allocate space for the process</li>
<li>initialize the process control block</li>
<li>set the appropriate linkages (put it in the queue)</li>
<li>creates or expands other data structures</li>
</ol>
<hr>
<p>Lect start</p>
<hr>
<h3 id="switching">Switching</h3>
<p>A process switch may occur at any time that the OS has gained control from the currently running process</p>
<p>Some possible events that may give control to the OS</p>
<figure class="table-wrapper"><table>
<thead>
<tr>
<th>mechanism</th>
<th>cause</th>
<th>use</th>
</tr>
</thead>
<tbody>
<tr>
<td>interrupt</td>
<td>something external to the execution of the current instruction interrupts</td>
<td>let’s the OS react to that asynchronous external event</td>
</tr>
<tr>
<td>trap</td>
<td>associated with the execution of the current instruction</td>
<td>handling an error or exception condition</td>
</tr>
<tr>
<td>supervisor call</td>
<td>explicit request</td>
<td>call to an operating system function</td>
</tr>
</tbody>
</table>
</figure><p>Interrupt:</p>
<ul>
<li>an event external to and independent of the current process</li>
<li>examples
<ul>
<li>clock interrupt</li>
<li>timeout</li>
<li>I/O interrupt</li>
<li>memory fault
<ul>
<li>wow so epic</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Trap:</p>
<ul>
<li>an error or exception condition generated within the currently running process</li>
<li>OS determines if the condition is <strong>fatal</strong>
<ul>
<li>fatal
<ul>
<li>move to exit state and a process switch occurs</li>
</ul>
</li>
<li>not fatal
<ul>
<li>action will depend on the nature of th eerror and the design of the OS</li>
<li>the OS will try to recover</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Supervisory Call:</p>
<ul>
<li>OS activated by a supervisor call from teh program being executed</li>
<li>getting the manager involved b/c of smth not on ur level</li>
</ul>
<p>Context Switch</p>
<ul>
<li>description:
<ul>
<li>when the cpu switches to another process, the system must save the state of the old process and load the saved state for the new process</li>
<li>process’ context = PCB</li>
</ul>
</li>
<li>we have to efficiently save our old PCB and start using the new PCB to execute</li>
<li>context witch time is overhead
<ul>
<li>no useful work is done while switching</li>
<li>more complex os and pcb = longer switch time</li>
<li>we want to minimize context switches so we don’t waste too much time</li>
</ul>
</li>
<li>time dependent on hardware support
<ul>
<li>multiple sets of registers per CPU = multiple loaded contexts
<ul>
<li>not common</li>
</ul>
</li>
<li>typical speed is several microseconds</li>
</ul>
</li>
</ul>
<p><img src="../images/image-54.png" alt="Alt text"></p>
<p>notice that there is idle time for the operating system to perform the saving of <span class="katex-parse"><span class="visually-hidden">P, C, B, start subscript, 0, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>C</mi><msub><mi>B</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">PCB_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">PC</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and subseqent loading of <span class="katex-parse"><span class="visually-hidden">P, C, B, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>C</mi><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">PCB_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">PC</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="../images/image-55.png" alt="Alt text"></p>
<p><code>"blah blah blah" - professor</code></p>
<h2 id="execution-of-the-operating-system">Execution of the Operating System</h2>
<p>recall:</p>
<ul>
<li>OS functions in the same was as ordinary computer software
<ul>
<li>OS is a set of programs executed by the processor</li>
</ul>
</li>
<li>OS frequently relinquishes control and depends on the processor to restore control to the OS</li>
</ul>
<p>Question</p>
<ul>
<li>OS is just a colection of programs</li>
<li>it’s executed by the processor like any other program</li>
<li>is the OS a process?</li>
<li>how is it controlled?</li>
</ul>
<hr>
<p>OS just throws control back to itself.</p>
<p>Whenever it gives away control there’s always the contingency that it’ll come back.</p>
<p>the collection of processes control one another.</p>
<hr>
<p>3 approaches:</p>
<ol>
<li>separate kernel</li>
<li>execution within user processes</li>
<li>process-based operating system</li>
</ol>
<h3 id="separate-kernel">Separate Kernel</h3>
<p>Execute the kernel of the OS outside of any process</p>
<ul>
<li>the concept of a the proess is considered to apply only to user programs</li>
<li>OS executed as separate entity operated in privileged mode</li>
<li>common on older OSes
<ul>
<li>not often used today</li>
</ul>
</li>
</ul>
<h3 id="user-processes">User Processes</h3>
<p>All OS software is executed in the context of a user process:</p>
<ul>
<li>OS a collection of routines that the user calls to perform variousfunctions, executed within the environment of the user’s process</li>
<li>common on OSes on smaller computers (PCs)
<ul>
<li>commonly used in today’s laptops</li>
</ul>
</li>
</ul>
<h3 id="process-based-os">Process-Based OS</h3>
<p>OS as a collection of system processes</p>
<ul>
<li>software that is part of the kernel executes in a kernel mode</li>
<li>major kernel functgions are organized as separate processes</li>
<li>imposes a program design discipline that encourages the use of a modular OS with minimal, clean interfaces between the modules.</li>
<li>used in
<ul>
<li>servers in more modern computing</li>
<li>modular design</li>
</ul>
</li>
</ul>
<h3 id="summary">Summary</h3>
<p>The most fundamental concept in a modern OS is the process.</p>
<p>The principal function of the OS is to create, manage, and terminate
processes.</p>
<p>While processes are active, the OS must see that each is allocated
time for execution by the processor, coordinate their activities,
manage conflicting demands, and allocate system resources to
processes.</p>
<h1 id="threads">Threads</h1>
<h2 id="processes-and-threads">Processes and Threads</h2>
<p><img src="../images/image-56.png" alt="Alt text"></p>
<p><img src="../images/image-57.png" alt="Alt text"></p>
<p>The actual fetching and execution of the instructions is thought of as a thread or lightweight process (LWP).</p>
<p>Most unix based processing will say threads.</p>
<p>Some OSes don’t differentiate between threads and processes, treating them all as processes.</p>
<p>THe process model introduced so far assumed that a process as an executing program with a single thread of control.</p>
<p>Virtually all modern operating sytems, however, provide features enabling aprocess to contain multiple threads of control.</p>
<p><img src="../images/image-58.png" alt="Alt text"></p>
<h3 id="threaded-approaches">Threaded Approaches</h3>
<p>Single threaded approaches</p>
<p>a single thread of execution per process</p>
<p>threads are not recognized</p>
<p><img src="../images/image-59.png" alt="Alt text"></p>
<p>ex.</p>
<ul>
<li>ms-dos</li>
<li>old linux</li>
</ul>
<p><img src="../images/image-60.png" alt="Alt text"></p>
<p>we can make it seem as though the processes are all working simultaneously but we’re actually just switching around very quickly</p>
<h3 id="what-is-a-thread">What is a Thread</h3>
<p><img src="../images/image-61.png" alt="Alt text"></p>
<p>thread is a basic unit of cpu utilization</p>
<ul>
<li>each thread knows its parent process</li>
<li>thread ID</li>
<li>program counter</li>
<li>a register set</li>
<li>a stack</li>
</ul>
<p>thread = instruction trace</p>
<p><img src="../images/image-62.png" alt="Alt text"></p>
<p>If a process has multiple threads of control then it can perform more than one task at a time.</p>
<p>Threads belonging to the same process</p>
<ul>
<li>share
<ul>
<li>code section</li>
<li>data section</li>
<li>other operating system resources
<ul>
<li>open files</li>
<li>signals</li>
</ul>
</li>
</ul>
</li>
<li>have unqiue
<ul>
<li>registers</li>
<li>stack</li>
<li>PC</li>
<li>ID</li>
</ul>
</li>
</ul>
<h3 id="why-multithread%3F">Why Multithread?</h3>
<p>Most modern applications are multhreaded</p>
<p>an application is typically implemented as a separate process with several threads of control</p>
<p>multiple tasks with the application can be implemented by separate threads for different reasons</p>
<p>ex:</p>
<ul>
<li>making thumbnails of tons of different images at once
<ul>
<li>1 thread per image</li>
</ul>
</li>
<li>loading a webpage
<ul>
<li>1 thread for text</li>
<li>1 thread for images</li>
</ul>
</li>
<li>word processors
<ul>
<li>1 thread for responding to keystrokes</li>
<li>1 thread for displaying graphics</li>
<li>1 thread for spell checking</li>
</ul>
</li>
</ul>
<p>we feed each thread a different task and they don’t interfere with one another</p>
<p>multithreading is also good for client/server applications</p>
<p><img src="../images/image-63.png" alt="Alt text"></p>
<p>Server will have</p>
<ul>
<li>have a port open and a thread to listen for connection requests</li>
<li>make a thread to do what the request wants</li>
<li>the open port
<ul>
<li>very vulnerable</li>
<li>an open door</li>
<li>necessary as otherwise no one can connect</li>
</ul>
</li>
</ul>
<p>Q: why multithread and not multi proces</p>
<p>A: It’s much faster</p>
<ul>
<li>process creation is heavywhite while thread creation is lightweight</li>
<li>creation, termination, and switching of threads is faster than with processes</li>
<li>threads are ten times faster to create than processes in UNIX</li>
</ul>
<p>kernels are generally multithreaded</p>
<ul>
<li>during system boot time on linux system, several kernel threads are created</li>
<li>each thread performs a specific task
<ul>
<li>device management</li>
<li>memory management</li>
<li>interrup handling</li>
<li>etc</li>
</ul>
</li>
</ul>
<p>benefits of multithreading</p>
<ul>
<li>responsiveness
<ul>
<li>allow contonued execution if part of th eprocess is blocked</li>
<li>good for user interfaces</li>
</ul>
</li>
<li>resource sharing
<ul>
<li>threads share resources of process</li>
<li>easier than shared memory or message passing b/w processes</li>
</ul>
</li>
<li>economy
<ul>
<li>cheaper than process creation</li>
<li>thread switching lower overhead than context switching</li>
</ul>
</li>
<li>scalability
<ul>
<li>process can take advantage of multicore architectures</li>
<li>one process can use at most one core</li>
<li>multi-threads could use all available cores or CPUs</li>
<li>speed of execution</li>
</ul>
</li>
</ul>
<h2 id="multicore-programming">Multicore Programming</h2>
<p><img src="../images/image-64.png" alt="Alt text"></p>
<p>multicore:</p>
<ul>
<li>multiple computing cores on a single chip</li>
<li>each core appears as a separate CPU to the operating system</li>
<li>each core can execute 1 trace at a time</li>
</ul>
<pre><code>word on caches, specifically in this intel architecture

L1 cache has all of the instructions and stuff.
All the highest value things

L2 can allow communication between 2 cores physically next to one another. They look separate in the diagram but that's just the allocation we do, they can look at each other's work and talk to one another basically.

L3 is on the chip and is shared by all of the cores

There are different kinds of architectures out there so the interesing L2 cache sharing won't be true of every architecture.
</code></pre>
<p>multithreaded programming</p>
<ul>
<li>provides a mechanism for more efficeint use of these multiple computing cores and improved concurrency</li>
</ul>
<p>we need to program properly in order to take advantage of the presence of multithreading</p>
<h3 id="concurrency-vs-parallelism">Concurrency vs Parallelism</h3>
<p>Parallelism</p>
<ul>
<li>implies a system can perform more than one task simultaneously</li>
<li>2 cores doing 2 threads at the same time</li>
<li>working in parallel</li>
</ul>
<p>Concurrency</p>
<ul>
<li>supports more than one task by allowing all the tasks to make progress</li>
</ul>
<p>Q: Is it possible to have concurrency without parallelism?</p>
<p>A: yes. utilize thread switching.
parallelism requires parallel execution.
We can have all the tasks progress together without parallel execution by way of thread switching.</p>
<pre><code>parallelism cannot happen on a single core

parallelism implies concurrency

there can be concurrency on a single core

parallelism is faster than concurrency alone
</code></pre>
<p><img src="../images/image-65.png" alt="Alt text"></p>
<p>We are either parallelising data or tasks</p>
<p>data parallelism:</p>
<ul>
<li>distribute distinctive chunk of data across multiple cores, and perofmr the same operation on each</li>
<li>ex
<ul>
<li>each core gets a different image</li>
<li>each core performs the same operation of creating a thumbnail</li>
</ul>
</li>
</ul>
<p>task parallelism</p>
<ul>
<li>distributing threads across cores</li>
<li>each thread performs a unique operation</li>
<li>not necessarily all working on the same data
<ul>
<li>1 core is summing rows</li>
<li>1 core is averaging rows</li>
<li>1 core is finding the median</li>
<li>all may or may not be working on the same rows</li>
</ul>
</li>
</ul>
<p>There are a number of challenges that come with programming for multicore or multiprocessor systems</p>
<ul>
<li>dividing activities into separate concurrent takss
<ul>
<li>what takss are independent of each other</li>
</ul>
</li>
<li>balance
<ul>
<li>pick tasks that perform equal work of equal value</li>
</ul>
</li>
<li>data spliting
<ul>
<li>data accessed and manip’d by the tasks must be divided to run on separate cores</li>
</ul>
</li>
<li>data dependency
<ul>
<li>see what tasks require what data and see which pieces of data are shared by tasks</li>
</ul>
</li>
<li>testing and debugging
<ul>
<li>testing and debugging concurrent programs is inherently more difficult than testing and debugging single-threaded applicdations</li>
</ul>
</li>
</ul>
<p>Many deveopers argue that the advent of multicore systems will require an entirely new approach to designing software systems in the future.</p>
<p>Many educators believe that there should be an increased emphasis on parallel programming in software development.</p>
<h3 id="amdahl%E2%80%99s-law">Amdahl’s Law</h3>
<p>Identifies performance gains from adding additional cores to an application that has both serial and parallel components</p>
<span class="katex-parse katex-parse-display"><span class="visually-hidden">s, p, e, e, d, u, p, is less than or equal to, start fraction, 1, divided by, S, plus, start fraction, left parenthesis, 1, minus, S, right parenthesis, divided by, N, end fraction, end fraction</span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>u</mi><mi>p</mi><mo>≤</mo><mfrac><mn>1</mn><mrow><mi>S</mi><mo>+</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><mi>N</mi></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">speedup\le\frac{1}{S+\frac{(1-S)}{N}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ee</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5664em;vertical-align:-1.245em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.24em;"><span class="pstrut" style="height:3.01em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.687em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.245em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">S</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span> - serial portion</li>
<li><span class="katex-parse"><span class="visually-hidden">N</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> - processing cores</li>
</ul>
<p>example:</p>
<ul>
<li>application is
<ul>
<li>75% parallel</li>
<li>25% serial</li>
</ul>
</li>
<li>1 core <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> 2 cores</li>
</ul>
<span class="katex-parse katex-parse-display"><span class="visually-hidden">Unsupported equation</span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>u</mi><mi>p</mi><mo>≤</mo><mfrac><mn>1</mn><mrow><mn>0.25</mn><mo>+</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>0.25</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mfrac><mn>1</mn><mrow><mn>0.25</mn><mo>+</mo><mfrac><mn>0.75</mn><mn>2</mn></mfrac></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mfrac><mn>1</mn><mrow><mn>0.25</mn><mo>+</mo><mn>0.375</mn></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mfrac><mn>1</mn><mn>0.625</mn></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mn>1.6</mn></mrow><annotation encoding="application/x-tex">speedup\le\frac{1}{0.25+\frac{(1-0.25)}{2}}
\newline
= \frac{1}{0.25+\frac{0.75}{2}}
\newline
= \frac{1}{0.25+0.375}
\newline
= \frac{1}{0.625}
\newline
= 1.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ee</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5664em;vertical-align:-1.245em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord">0.25</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight">0.25</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.24em;"><span class="pstrut" style="height:3.01em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.687em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.245em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4015em;vertical-align:-1.0801em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2649em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.25</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.75</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0801em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.25</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.375</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.625</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.6</span></span></span></span></span></span>
<ul>
<li>1 core <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> 4 cores</li>
</ul>
<span class="katex-parse katex-parse-display"><span class="visually-hidden">Unsupported equation</span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>e</mi><mi>d</mi><mi>u</mi><mi>p</mi><mo>≤</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn><mo>+</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn><mo stretchy="false">)</mo></mrow><mn>4</mn></mfrac></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn><mo>+</mo><mfrac><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow><mn>4</mn></mfrac></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn><mo>+</mo><mn>3</mn><mi mathvariant="normal">/</mi><mn>16</mn></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mfrac><mn>1</mn><mrow><mn>7</mn><mi mathvariant="normal">/</mi><mn>16</mn></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mn>16</mn><mi mathvariant="normal">/</mi><mn>7</mn><mspace linebreak="newline"></mspace><mo>≈</mo><mn>2.28</mn></mrow><annotation encoding="application/x-tex">speedup\le\frac{1}{1/4+\frac{(1-1/4)}{4}}
\newline
=\frac{1}{1/4+\frac{3/4}{4}}
\newline
=\frac{1}{1/4+3/16}
\newline
= \frac{1}{7/16}
\newline
= 16/7
\newline
\approx 2.28</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ee</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5664em;vertical-align:-1.245em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord">1/4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight">1/4</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.24em;"><span class="pstrut" style="height:3.01em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.687em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.245em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5664em;vertical-align:-1.245em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord">1/4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.24em;"><span class="pstrut" style="height:3.01em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.687em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.245em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1/4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3/16</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7/16</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">16/7</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.4831em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2.28</span></span></span></span></span></span>
<p>as <span class="katex-parse"><span class="visually-hidden">N</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> approchaes infinity</p>
<ul>
<li>speedup approaches 1/S</li>
<li>50% of application is serial, maximum speedup = 2 regardless of <span class="katex-parse"><span class="visually-hidden">N</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span></li>
</ul>
<p>serial portion of an application has a dispropportionate effect on performance gained by adding cores.</p>
<hr>
<p>Knowledge Check:</p>
<ul>
<li>parallelism involves distributing tasks across multiple computing cores</li>
<li>use amdahl’s law to find the speedup gain for an application that is 60% parallel component for 2 processing cores
<ul>
<li>1.43</li>
</ul>
</li>
<li>it is possible to have concurrency without parallelism</li>
</ul>
<hr>
<h3 id="thread-states-and-operations">Thread States and Operations</h3>
<p>Key states for a thread</p>
<ul>
<li>running</li>
<li>ready</li>
<li>blocked</li>
</ul>
<p>thread operations associated with a change in thread state are:</p>
<ul>
<li>spawn
<ul>
<li>new process is spawned, a thread for that process is also spawned</li>
</ul>
</li>
<li>block
<ul>
<li>a thread needs to wait for an event and is blocked</li>
</ul>
</li>
<li>unblock
<ul>
<li>the event the thread was waiting for has occured, the thread is moved to the ready queue</li>
</ul>
</li>
<li>finish
<ul>
<li>thread completes. deallocate register, context, and stacks</li>
</ul>
</li>
</ul>
<h3 id="thread-synchronization">Thread Synchronization</h3>
<p>We need to synch up the activities on the threads because:</p>
<ul>
<li>all threads share the same resources
<ul>
<li>namely address space</li>
</ul>
</li>
<li>one thread altering the shared resource will affect the other threads in the same process
<img src="../images/image-66.png" alt="Alt text"></li>
</ul>
<h2 id="multithreading-models">Multithreading Models</h2>
<p>Types of threads:</p>
<ul>
<li>user threads
<ul>
<li>supported above the kernel</li>
<li>managed by user-level thread library w/o kernel support</li>
</ul>
</li>
<li>kernel threads
<ul>
<li>supported and managed directly by the kernel</li>
</ul>
</li>
</ul>
<p>virtually all contemporary operating systems support kernel threads</p>
<p>thread libraries contain code for:</p>
<ul>
<li>creating an ddestroying threads</li>
<li>passing messages and data between threads</li>
<li>scheduling thread execution</li>
<li>saving and restoring thread contexts</li>
</ul>
<p>3 primary thread libraries</p>
<ul>
<li>POSIX Pthreads</li>
<li>Windows threads</li>
<li>Java threads</li>
</ul>
<h3 id="user-threads">User Threads</h3>
<p>User Threads</p>
<ul>
<li>many are mapped to a single kernel thread</li>
<li>kernel is not aware of the existence of threads</li>
<li>thread management is done by threda library at the user level</li>
</ul>
<p><img src="../images/image-67.png" alt="Alt text"></p>
<hr>
<p>examples</p>
<p><img src="../images/image-68.png" alt="Alt text"></p>
<p>Process <code>B</code> has 2 threads.
OS only sees process <code>B</code>,
not its threads</p>
<p><img src="../images/image-69.png" alt="Alt text"></p>
<p>We’re blocking the whole process.</p>
<p>The threads remain in their states but they aren’t actually doing anything.</p>
<p>We can’t just switch to thread 1 as the kernel isn’t aware of the threads,
only the process.</p>
<p><img src="../images/image-70.png" alt="Alt text"></p>
<p><img src="../images/image-71.png" alt="Alt text"></p>
<p><img src="../images/image-72.png" alt="Alt text"></p>
<hr>
<p>pros:</p>
<ul>
<li>thread switching does not require kernel mode privileges
<ul>
<li>saves overhead of two mode switches</li>
</ul>
</li>
<li>scheduling can be application specific
<ul>
<li>scheduling algo can be tailored to the application</li>
</ul>
</li>
<li>ULTs can run on any OS</li>
</ul>
<p>cons:</p>
<ul>
<li>entire process wil block if a single thread makes a blocking system call</li>
<li>pure ULT strat, multithreaded application cannot take advantage of multiprocessing/parallelism</li>
<li>very few systems use this model because of its inability to utilize multiple cores
<ul>
<li>solaris green threads</li>
</ul>
</li>
</ul>
<h3 id="kernel-threads">Kernel Threads</h3>
<p>thread management is all done by the kernel</p>
<p>creating a user thread creates a kernel thread (one-to-one)</p>
<p>kernel maintains context information fo rthe process as a whole and for individual threads within the process</p>
<p><img src="../images/image-73.png" alt="Alt text"></p>
<p>pros:</p>
<ul>
<li>kernel can simultaneously schedule multiple threads from the same process on multiple processes</li>
<li>if one theread in a process is blocked, the kernel can schedule another thread of the same process</li>
<li>linux and windows implement this</li>
</ul>
<p>cons:</p>
<ul>
<li>1-1 correspondence b/w user and kernel threads will burden the performance of a system after creating a large number of threads
<ul>
<li>so many threads to have to switch between</li>
</ul>
</li>
</ul>
<h3 id="combined-user-and-kernel-level-threading">Combined User and Kernel level threading</h3>
<ul>
<li>thread creation done in user space</li>
<li>most of scheudling and synchronization of threads within an application</li>
<li>multiple user-level threads from a single application are mapped onto smaller or equal number of kernel threads
<ul>
<li>many-to-many</li>
</ul>
</li>
<li>number of kernel threads may be specific to either a particular application or a particular machine</li>
</ul>
<p><img src="../images/image-74.png" alt="Alt text"></p>
<p>Note:</p>
<ul>
<li>we can’t map 3 threads to 4 cores.</li>
<li>a kernel thread can only belong to one processor</li>
<li>a user thread can only map to one kernel thread</li>
</ul>
<p>pros:</p>
<ul>
<li>appears flexible</li>
<li>number of threads and parallelism
<ul>
<li>many-to-one (pure ULT)
<ul>
<li>create many threads but no parallelism</li>
</ul>
</li>
<li>one-to-one (pure KLT)
<ul>
<li>better concurrency but high overhead</li>
</ul>
</li>
<li>many-to-many (combined approach)
<ul>
<li>as many threads as needed running parallel on a multiprocessor</li>
</ul>
</li>
</ul>
</li>
<li>blocking
<ul>
<li>when a thread performs a blocking system call, the kernel can schedule another thread for execution</li>
</ul>
</li>
</ul>
<p>cons:</p>
<ul>
<li>difficult to implement
<ul>
<li>windows with the <code>ThreadFiber</code> package</li>
<li>not very common outside of the above</li>
</ul>
</li>
</ul>
<p>Whether KLT or ULT remember that</p>
<p>a relationship must exist between user threads and kernel threads no matter the cardinality</p>
<p><img src="../images/image-75.png" alt="Alt text"></p>
<p><img src="../images/image-76.png" alt="Alt text"></p>
<p>2-level model is like many-to-many but we’re able to bind a user thread to a kernel thread.</p>
<p>we can basically dedicate a core to a thread.</p>
<p>Q: can we interleave threads from different processes?</p>
<p>A:
This is just normal process switching.</p>
<hr>
<p>knowledge check</p>
<p><img src="../images/image-77.png" alt="Alt text"></p>
<hr>
<p><img src="../images/image-78.png" alt="Alt text"></p>
<p>prof:</p>
<p>“the threads need to have a connection to the processor in order for execution”</p>
<h1 id="concurrency%3A-mutual-exclusion-and-synchronization">Concurrency: Mutual Exclusion and Synchronization</h1>
<h2 id="background-for-concurrency">Background for Concurrency</h2>
<p>processes can execute concurrently or in parallel</p>
<p>may be interrupted at any time, partially completing execution</p>
<p><img src="../images/image-80.png" alt="Alt text"></p>
<p>we have a shared memory where we store variables and everything we want to work with.</p>
<p>If we don’t manage that shared memory properly we end up with data inconsistency</p>
<p><img src="../images/image-81.png" alt="Alt text"></p>
<p>make sure the processes execute in an orderly fashion and don’t fuck with each other when they share a resources</p>
<p>Race Condition</p>
<ul>
<li>several processes access and manip the same data at the same time</li>
<li>outcome depends on who got there first</li>
</ul>
<p><img src="../images/image-82.png" alt="Alt text"></p>
<h2 id="critical-section-problem">Critical-Section Problem</h2>
<p>critical segement of code:</p>
<ul>
<li>process may be accessing and updating data that is shared with at least one other process</li>
<li>only one process in critical section at a time</li>
</ul>
<p>when a process wants to enter the critical section</p>
<ul>
<li>entry section - process asks permission to enter</li>
<li>it does the critical section</li>
<li>exit section - let’s eeryone know it’s done</li>
<li>remainder section is the rest of the noncritical stuff</li>
</ul>
<p>we need to ensure the 3 following conditions</p>
<ol>
<li>mutual exclusion
<ul>
<li>only one process in critical section at a time</li>
</ul>
</li>
<li>progress
<ul>
<li>if no one else is in critical and someone else wants to go critical then we have to select the next process</li>
<li>we can’t postpone this selection indefinitely</li>
</ul>
</li>
<li>bounded waiting
<ul>
<li>there must be a limit on the number of times that other processes can enter the critical sections after a process has made a request to enter</li>
<li>assume same speed of all processes</li>
</ul>
</li>
</ol>
<p><img src="../images/image-83.png" alt="Alt text"></p>
<h3 id="single-core">Single Core</h3>
<p>very shrimple</p>
<p>we could prevent interrupts from occuring whilue a shared variable was being modified</p>
<p>useless when we try to move to multiprocessor since it would just start disabling everything.</p>
<h3 id="os">OS</h3>
<p>2 approaches depending on preemption</p>
<ul>
<li>preemptive
<ul>
<li>allows preemption of process when running in kernel mode</li>
<li>processor can tell the process to pack all their bags and get ready to move</li>
</ul>
</li>
<li>non-preemptive
<ul>
<li>runs until kernel mode, blocks, or voluntarily yields CPU</li>
<li>essentially free of race conditions as only one process is active in the kernel at a time</li>
</ul>
</li>
</ul>
<p>preemptive are difficult to design.</p>
<p>it allows two kernel-mode processes to run simultaneously on diff cores</p>
<p>it also makes things more responsive</p>
<hr>
<p>knowledge check</p>
<p><img src="../images/image-84.png" alt="Alt text">
<img src="../images/image-85.png" alt="Alt text">
<img src="../images/image-87.png" alt="Alt text">
<img src="../images/image-86.png" alt="Alt text">
<img src="../images/image-88.png" alt="Alt text"></p>
<hr>
<p><img src="../images/image-89.png" alt="Alt text"></p>
<p>atomic operations</p>
<h2 id="mutual-exclusion">Mutual Exclusion</h2>
<h3 id="software-approaches">Software Approaches</h3>
<h4 id="dekker%E2%80%99s-algo">Dekker’s Algo</h4>
<p>Dijkstra went to go publish it for him so that’s why there’s a jpeg of him on the slide</p>
<p>first known sol’n to the mutual exclusion problem in concurrent programming</p>
<p>allows 2 threads to shar ea single-use resource without conflict, using on ly shared memory for communication</p>
<p>only one access to a memory location can be made at a time</p>
<p>we have a global memory location labelled <code>turn</code> that is shared between the two processes</p>
<p>Processes check to see if it’s their turn and execute accordingly.
Once their done they give the turn to the other process.</p>
<p>Mutual exclusion is guaranteed.</p>
<p>What is the problem?</p>
<hr>
<p>prof left off here for 05/02/24 lect</p>
<hr>
<p>midterm is all question formats and on paper</p>
<hr>
<p>Porcesses must strictly alternate in their use of their critical section</p>
<ul>
<li>the pace of execution is dictated by teh slower of the two processes</li>
</ul>
<p>One process being slow makes the whole things slower since everyone has to wait on that slower process.</p>
<p>if one process fails then the other process is permanently blocked</p>
<ul>
<li>this happens because the failed process can’t give the turn over to the other process by exiting and setting the flag</li>
<li>this happens whether or not the process is in the critical section or not</li>
</ul>
<p>2nd attempt - a revision:</p>
<ul>
<li>each process has it’s <strong>own key <em>(flag)</em></strong></li>
<li>if one fails, the other can still access its critical section</li>
<li>processes can look at others flags</li>
<li>one process can’t change the flag of another process</li>
<li>processes share a boolean vector that holds the flags
<ul>
<li><code>Boolean vector flag[2]</code></li>
</ul>
</li>
</ul>
<p><img src="../images/image-90.png" alt="Alt text"></p>
<p>drawbacks:</p>
<ul>
<li>permanent blocking still possible
<ul>
<li>process fails inside critical section or after setting flag to true w/o entering</li>
</ul>
</li>
<li>no guaranteed mutual exclusion
<ul>
<li>P0 exeutes the while statement and finds flag[1] set to false</li>
<li>P1 executes the while statement and finds flag[0] set to false</li>
<li>P0 sets flag[0] to true and enters its critical section</li>
<li>P1 sets flag[1] to true and enters its critical section</li>
<li>now both processes arenow executing their critical sections so the program is incorrect</li>
</ul>
</li>
</ul>
<p>3rd attempt - another revision</p>
<ul>
<li>the problem from before was that a process can change its state after the other process has checked it but before the other process can enter its critical section</li>
<li>swap around the two stateemnts to guarantee mutual exclusion</li>
</ul>
<p><img src="../images/image-91.png" alt="Alt text"></p>
<p>we set the flag’s value before we execute the while loop</p>
<p>drawbacks:</p>
<ul>
<li>this results in a deadlock</li>
<li>both processes set their flags to true</li>
<li>later on they will check each other’s flags and decide they need to wait for the other
<ul>
<li>the flag value makes them think the other process is in their critical section</li>
</ul>
</li>
</ul>
<p>4th attempt - yet another revision:</p>
<ul>
<li>Each process sets its flag to indicate its desire to enter its critical section but is prepared to reset the flag to defer to the other process</li>
<li>mtuual exclusion is guaranteed under this model</li>
</ul>
<p><img src="../images/image-92.png" alt="Alt text"></p>
<p>drawbacks:</p>
<ul>
<li><img src="../images/image-93.png" alt="Alt text">
<ul>
<li>each process sets their flag to true</li>
</ul>
</li>
<li><img src="../images/image-94.png" alt="Alt text">
<ul>
<li>each process checks the other’s flag before proceeding with the while loop</li>
</ul>
</li>
<li><img src="../images/image-95.png" alt="Alt text">
<ul>
<li>each flag flips from false and back to true</li>
</ul>
</li>
<li>the loop ends up repeating in what’s known as a <em>livelock</em></li>
<li>this won’t sustain for a long time
<ul>
<li>the processes are different and we can presume that the while loops won’t always take the same amount of time and that one will finish their while loop before the other can so they’ll enter the critical section first</li>
</ul>
</li>
</ul>
<p>5th iteration - the correct solution:</p>
<ul>
<li>we introduce <em><strong>the right to insist</strong></em></li>
</ul>
<p><img src="../images/image-96.png" alt="Alt text"></p>
<ul>
<li>when P0 wants to enter the critical section
<ul>
<li>it sets its flag to true</li>
<li>checks P1’s flag
<ul>
<li>if P1 flag is false then P0 gets to go critical</li>
<li>else, P0 consults turn
<ul>
<li>turn==0
<ul>
<li>it’s P0’s turn to insist</li>
<li>P0 will just keep on checking P1’s flag in order to try and enter its critical section</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>P1 will at some point note that it is its turn to defer and set its flag to false, allowing P0 to proceed</li>
<li>after P0 has used its critical section
<ul>
<li>P0 flag set to false</li>
<li>turn set to 1 to transfer the right to sinsit to P1</li>
</ul>
</li>
</ul>
<h4 id="peterson%E2%80%99s-solution">Peterson’s Solution</h4>
<p>Dekker’s algo solves things but it’s hard to follow</p>
<p>Peterson has a simpler sol’n that allows two processes to share a single-use resource w/o conflict</p>
<p>only shared memory is used for communication</p>
<p>it is kind of rewriting Dekker’s algorithm</p>
<hr>
<p><img src="../images/image-97.png" alt="Alt text"></p>
<p><code>int turn</code> - indicates whose turn it is to enter the critical section</p>
<p><code>bool flag[2]</code> - indicate if a process is ready to enter the critical section</p>
<p><code>flag[i]==true</code> implies that process <span class="katex-parse"><span class="visually-hidden">P, start subscript, i, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is ready</p>
<p><img src="../images/image-98.png" alt="Alt text"></p>
<p>3 critical-section requirements are met(provably):</p>
<ol>
<li>mutual exclusion is preserved
<ul>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, i, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> enters critical section only if: either <code>flag[j]==false</code> or <code>turn == i</code>
<ul>
<li>the other process is not ready or</li>
<li>it is <span class="katex-parse"><span class="visually-hidden">P, start subscript, i, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>’s turn</li>
</ul>
</li>
</ul>
</li>
<li>Progress requirements is satisfied</li>
<li>Bounded-waiting requirement is met</li>
</ol>
<p>Useful for demonstrating an algo but not guaranteed to work on modern architectures.</p>
<p>to improve performance, processors and/or compilers may reorder operations that have no dependencies</p>
<ul>
<li>fine for single-threaded as result is always the same</li>
<li>may produce inconsistent or unexpected results for multithreading</li>
</ul>
<pre><code>two threads share _flag_ and _x_ variables

boolean flag = false;
int x = 0;

Thread 1 performs

while (!flag)
  print x;

Thread 2 performs

x = 100;
flag = true;

what is the expected output

100 is the expected output however the operations for thread 2 may be reordered so the output might be 0
</code></pre>
<p><img src="../images/image-99.png" alt="Alt text"></p>
<p><img src="../images/image-100.png" alt="Alt text"></p>
<p>We have to use a _<strong>Memory Barrier</strong> to make sure that Peterson’s solution will work correctly on modern computer architecture.</p>
<p>So this software based support will need the aid of some hardware.</p>
<hr>
<p>Knowledge check:</p>
<ul>
<li>In Peterson’s solution, the ___ variable indicates if a process is ready to enter its critical section
<ul>
<li><code>flag[i]</code></li>
</ul>
</li>
</ul>
<h3 id="hardware-support-approaches">Hardware Support Approaches</h3>
<hr>
<p>“There is no bullet solution… all solutions build on each other”</p>
<hr>
<p>Many systems provide hardware support for implementing the cirtical section code</p>
<p>uniprocessors - could disable interrupts</p>
<ul>
<li>currently running code would execute w/o preemption</li>
<li>genearlly, too inefficient on multiprocessor systems
<ul>
<li>OS using this are not broadly scalable</li>
</ul>
</li>
</ul>
<p>looking at 3 forms of hardware support</p>
<ol>
<li>memory barriers (aka memory fences)</li>
<li>hardware instructions</li>
<li>atomic variables</li>
</ol>
<h5 id="memory-barrier">Memory Barrier</h5>
<p>How a computer architecture determines what memory guarantees it
will provide to an application program is known as its memory model.</p>
<p>models may be either</p>
<ul>
<li>strongly ordered
<ul>
<li>memory modification of one processor is immediately visible to all other processors</li>
</ul>
</li>
<li>weakly ordered
<ul>
<li>not always immediately visible to all other processors</li>
</ul>
</li>
</ul>
<p>developers cannot make an assumption about whether or not the memory model is strongly or weakly ordered.</p>
<p>in lieu of this guarantee,
we use memory barriers</p>
<p>memory barriers</p>
<ul>
<li>computer instructions that force any changes in memory to be propogated to all other processors in the system</li>
</ul>
<p><code>Sfence</code> is a memory barrier instruction for example with regards to storing</p>
<p><code>lfence</code> is another type of instruction with regards to loading</p>
<p><code>mfence</code> prevents reording of reading and writing before or after the fence</p>
<p>do not reorder anything before the barrier with anything that comes after the barrier</p>
<p><img src="../images/image-101.png" alt="Alt text"></p>
<p>we’re not able to mov the loads to either side of the fence</p>
<p><img src="../images/image-102.png" alt="Alt text"></p>
<h4 id="hardware-instructions">Hardware Instructions</h4>
<pre><code class="language-c">boolean <span class="hljs-title function_">test_and_set</span> <span class="hljs-params">(boolean *target)</span>{
  boolean rv = *target;
  *target = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> rv;
}
</code></pre>
<p><code>test_and_set()</code></p>
<ul>
<li>executed atomically</li>
<li>read a value in memory</li>
<li>set it to true</li>
<li>return the value that was in memory</li>
</ul>
<p>This let’s us make a lock out of the flag we want us to make sure we don’t enter the critical section while anothre program is in its critical section.</p>
<pre><code class="language-c"><span class="hljs-keyword">do</span> {
  <span class="hljs-keyword">while</span> (test_and_set(&amp;lock));
  <span class="hljs-comment">/*critical section*/</span>
  lock = <span class="hljs-literal">false</span>;
  <span class="hljs-comment">/*remainder section*/</span>
} <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>);
</code></pre>
<p>This is suported by nearly every architecture.</p>
<p><code>compare_and_swap()</code></p>
<pre><code class="language-c"><span class="hljs-type">int</span> <span class="hljs-title function_">compare_and_swap</span><span class="hljs-params">(<span class="hljs-type">int</span> *value, <span class="hljs-type">int</span> expected, <span class="hljs-type">int</span> new_value)</span> {
  <span class="hljs-type">int</span> temp = *value;
  <span class="hljs-keyword">if</span> (*value == expected)
    *value = new_value;
  <span class="hljs-keyword">return</span> temp;
}
</code></pre>
<ul>
<li>executed atomically</li>
<li>returns the original value of <code>value</code></li>
<li>set the <code>value</code> to the value of <code>new_value</code>
<ul>
<li>but only if <code>*value == expected</code></li>
</ul>
</li>
</ul>
<p>We can also use this to make a shared lock for mutual exclusion.
Have it initialized to 0.</p>
<pre><code class="language-c"><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-comment">//lock is the lock, 0 is the expected value, 1 is the prospective new value</span>
  <span class="hljs-keyword">while</span> (compared_and_swap(&amp;lock, <span class="hljs-number">0</span> ,<span class="hljs-number">1</span>) != <span class="hljs-number">0</span>) {<span class="hljs-comment">/*do nothing, someone else is in critical section*/</span>}
  <span class="hljs-comment">/*critical section, lock has been set to by us*/</span>
  lock = <span class="hljs-number">0</span>;     <span class="hljs-comment">//we left the critical section so we're able to set the lock back to 0</span>
  <span class="hljs-comment">/*remainder section*/</span>
}
</code></pre>
<h4 id="atomic-variables">Atomic Variables</h4>
<p>Typically instructions such as compare-and-swap are used as bhilding blocks for other synchronization tools.</p>
<p>One tool is an atomic variable that provdes <em>atomic</em> (uninterruptible) updates on basic data types such as integers and booleans.</p>
<p>Ex:</p>
<ul>
<li><code>sequence</code> - our atomic variable</li>
<li><code>increment()</code> - an operation on <code>sequence</code></li>
<li>command
<ul>
<li><code>increment(&amp;sequence)</code></li>
<li>ensures the sequence is inremented without interruption</li>
</ul>
</li>
</ul>
<p>we make atomic updates so that we’re guaranteed to update a variable.</p>
<p><code>increment()</code> can be implemented like so:</p>
<pre><code class="language-c"><span class="hljs-type">void</span> <span class="hljs-title function_">increment</span> <span class="hljs-params">(<span class="hljs-type">atomic_int</span> *v)</span> {
  <span class="hljs-type">int</span> temp;
  <span class="hljs-keyword">do</span> {
    temp = *v;
  }
  <span class="hljs-keyword">while</span> (temp != compare_and_swap(v, temp, temp+<span class="hljs-number">1</span>));
  <span class="hljs-comment">// the above keeps looping until we are able to successfully swap, effectively incrementing the value of `v`</span>
}
</code></pre>
<hr>
<p>Knowledge Check:</p>
<ul>
<li>race conditions are prevented by requiring that critical regions be protected by locks
<ul>
<li>true</li>
</ul>
</li>
<li><code>test_and_set()</code> instruction is executed atomically
<ul>
<li>true</li>
</ul>
</li>
<li>an instruction that executes atomically
<ul>
<li>executes as a single, uninterruptible unit</li>
</ul>
</li>
</ul>
<h3 id="os-%26-programming-languages-approaches">OS &amp; Programming Languages Approaches</h3>
<h4 id="mutex-locks">Mutex Locks</h4>
<p>Previous solutions are compicated and generally inaccessible to application programmers.</p>
<p>OS designers build software tools to solve critical section problem.</p>
<p>The simplest solution is the mutex lock.</p>
<blockquote>
<p>fun fact: mutex is a portmanteau of <code>mut</code>ual <code>ex</code>clusion, as it was created to solve that problem</p>
</blockquote>
<p><img src="../images/image-103.png" alt="Alt text"></p>
<p>note that the mutex is an integer that alternates between 0 for locked and 1 to unlocked, this is effectively a boolean.</p>
<p>Protect a critical section by first <code>acquire()</code> a lock then <code>release()</code> the lock.
Boolean variable indicating if <code>lock</code> is available or not.</p>
<p><code>acquire()</code> and <code>release()</code> must be atomic.
Usually implemented via hardware atomic instructions such as compare-and-swap.</p>
<pre><code class="language-c"><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
  acquire lock

  critical section

  release lock

  remainder section
}
</code></pre>
<p>You <code>acquire()</code> the lock and no one else can touch it while you’re in the critical section.
Afterwards you can <code>release()</code> since you’re done with the critical section.</p>
<p>The instructions look something like this in implementation.</p>
<pre><code class="language-c">acquire() {
  <span class="hljs-keyword">while</span> (!available) { <span class="hljs-comment">/* busy wait */</span>}
  available = <span class="hljs-literal">false</span>;
}
release () {
  available = <span class="hljs-literal">true</span>;
}
</code></pre>
<ul>
<li>these two functions must be implemented atomically, typically through the use of something like <code>test_and_set()</code> and <code>compare_and_swap()</code></li>
</ul>
<p>cons:</p>
<ul>
<li>sol’n requires busy waiting
<ul>
<li>a process trying to enter enter its critical section will loop call <code>acquire()</code> over and over again to try and grab hold of it</li>
</ul>
</li>
<li>this lock is called a <em>spinlock</em>
<ul>
<li>if a lock is to be held for a <code>short duration</code>, one thread can “spin” on one processing core while another thread performs its critical section on another core.</li>
</ul>
</li>
</ul>
<p>short duration:</p>
<ul>
<li>how short is short?</li>
<li>waiting on a lock requires 2 context switches
<ul>
<li>move the thread to the waiting state
<ul>
<li>storing away all of the process info (pcb, psw, etc.) introduces overhead</li>
</ul>
</li>
<li>restore the waiting thread once the lock becomes available</li>
</ul>
</li>
<li>the general rule is to use a spinlock if the lock will be held for a duration of less than two context switches</li>
<li>we don’t know how long it will take for a critical section to take but we can get some good estimates</li>
</ul>
<hr>
<p>Knowledge check</p>
<ul>
<li>a mutex lock
<ul>
<li>is essentially a boolean variable</li>
</ul>
</li>
<li>what is the correct order of operations for protecting a critical section using mutex locks?
<ul>
<li><code>acquire()</code> followed by <code>release()</code></li>
</ul>
</li>
<li>busy waiting refers to the phenomenonthat while a process is in its critical section, any other prcess that tries to enter its critical section must loop continuously in the call to acquire the mutex lock
<ul>
<li>yes</li>
</ul>
</li>
</ul>
<pre><code>Prof very briefly touched upon a notion of 2 different kinds of implementation of semaphore and mutex.
Something about a classic implementation versus some other implementation.
</code></pre>
<h4 id="semaphores">Semaphores</h4>
<p>One problem we had with the mutex was the busy waiting.</p>
<p>basic idea:</p>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">is greater than or equal to</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo></mrow><annotation encoding="application/x-tex">\ge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≥</span></span></span></span></span> 2 processes can work together using simple signals</li>
<li>a process can be forced to stop at a specified place until it has received a specific signal</li>
<li>any complex coordination can be done with an appropriate amount of signals</li>
<li>our previously mentioned mutex is akin to a single flag that we can raise up and down.</li>
</ul>
<p>Sempahores are a more sophisticated synchronization tool than mutex locks.</p>
<p>A semaphore <code>S</code> is an integer variable, that can only be accessed through 2 atomic operations:</p>
<ol>
<li><code>wait()</code> - decrements the semaphore value</li>
<li><code>signal()</code> - increments the semaphore value</li>
</ol>
<pre><code>these each have other names.
wait() originally P() from Dutch proberen, "to test", semWait()
signal() originally V() from verhogen, "to increment", semSignal()

we may find these in other literature
</code></pre>
<p>Implementation</p>
<pre><code class="language-c">wait(S) {
  <span class="hljs-keyword">while</span> (S &lt;= <span class="hljs-number">0</span>) {<span class="hljs-comment">/* busy wait */</span>}
  S--;
}
signal(S) {
  S++;
}
</code></pre>
<p>There are 2 different kinds of semaphores:</p>
<ol>
<li>counting sempahore</li>
<li>binary semaphore</li>
</ol>
<p>Counting semaphores (aka general semaphore) is an integer value that can range over an unrestricted domain</p>
<p>Binary semaphores are an integer value that can only range between 0 and 1.
This is a mutex lock.</p>
<p>We can implement a counting semaphore as a binary semaphore.</p>
<p>Good tool to solve synch problems.</p>
<p><img src="../images/image-104.png" alt="Alt text"></p>
<p>Initializing the semaphore to 0 will allow us to only allow <span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> to execute <span class="katex-parse"><span class="visually-hidden">S, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">S_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> after the execution of <span class="katex-parse"><span class="visually-hidden">S, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">S_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>A semaphore must guarantee that no 2 processes can execute the <code>wait()</code> and <code>signal()</code> on the same semaphore at the same time</p>
<p>implementation becomes the critical sectin problem where the <code>wait</code> and <code>signal</code> code are placed in critical section.</p>
<p>Could now have busy waiting in critical section implementation.</p>
<p>Process can just suspend instead of waiting for the semaphore.
Each semaphore has a waiting queue w/ 2 items</p>
<ul>
<li>value (of type integer)</li>
<li>pointer to next record in the list</li>
</ul>
<p>2 operations:</p>
<ul>
<li>block (aka sleep) - place the process invoking the operation on the appropriate waiting queue</li>
<li>wakeup - remove one of the processes from the waiting queue and place in ready queue</li>
</ul>
<p>waiting queue:</p>
<pre><code class="language-c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
  <span class="hljs-type">int</span> value;
  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">process</span> *<span class="hljs-title">list</span>;</span>
} semaphore
</code></pre>
<p>No busy waiting implementation:</p>
<pre><code class="language-c">wait (semaphore *S) {
  S-&gt;value--;

  <span class="hljs-keyword">if</span> (S-&gt;value &lt; <span class="hljs-number">0</span>) {
    add this process to S-&gt;<span class="hljs-built_in">list</span>;
    block;
  }
}

signal(semaphore *S) {
  S-&gt;value++;
  <span class="hljs-keyword">if</span> (S-&gt;value &lt;= <span class="hljs-number">0</span>) {
    remove a process P from S-&gt;<span class="hljs-built_in">list</span>;
    wakeup(P);
  }
}
</code></pre>
<p><img src="../images/image-105.png" alt="Alt text"></p>
<p>We’re using the incrementing and decrementing to iterate through the queue.</p>
<p>A strong semaphore uses a queue of blocked processes, the process unblocked is the one in the queue for the longest time.</p>
<p>A weak semaphore uses a set of blocked processes.
The processes unblocked is unpredictable.
This can lead to process starvation as a process may remained blocked forever</p>
<p><img src="../images/image-106.png" alt="Alt text"></p>
<hr>
<p>knowledge check</p>
<ul>
<li>a counting semaphore
<ul>
<li>is essentially an integer variable</li>
</ul>
</li>
<li>___ can be used to prevent busy waiting when implementing a semaphore
<ul>
<li>waiting queues</li>
</ul>
</li>
<li>mutex locks and binary sempahores are essentially the same thing
<ul>
<li>true</li>
</ul>
</li>
</ul>
<h4 id="monitors">Monitors</h4>
<h1 id="deadlock-and-starvation">Deadlock and Starvation</h1>
<h2 id="principles-of-deadlocks">Principles of Deadlocks</h2>
<p>Systems have different resources</p>
<p>Threads must:</p>
<ul>
<li>request a resource before using it</li>
<li>release the resource after using it</li>
</ul>
<p>The number of resources requested cannot exceed the total number of resources available in the system</p>
<ul>
<li>a thread cannot request 2 net interface if there is only 1</li>
<li><code>can't ask for what we don't have</code></li>
</ul>
<p>Request:</p>
<ul>
<li>Thread requests the resource</li>
<li>if you can give it, then give it immediately</li>
<li>If it can’t be given right now then the requesting thread must wait until it can acquire the resource</li>
</ul>
<p>Use:</p>
<ul>
<li>the thread can operate on the resource</li>
<li>ex: use the mutex lock to access a process’ critical section</li>
</ul>
<p>Release:</p>
<ul>
<li>resource is released and made usable again</li>
</ul>
<p>Reusable Resources:</p>
<ul>
<li>can be used safely by one process at a time</li>
<li>not depleted by that use</li>
<li>not consumable</li>
<li>ex: proessors, I/O channels, memory (main and secondary), I/O devices, data structures (files, databases, and semaphores)</li>
</ul>
<p>Consumable Resources:</p>
<ul>
<li>created/produced and destroyed/consumed</li>
<li>ceases to exist after being acquired by the consuming process</li>
<li>ex: interrupts, singals, messages, info in I/O buffers</li>
</ul>
<h3 id="deadlock">Deadlock</h3>
<p>A deadlock is the <strong>permanent</strong> block.</p>
<p>Two or more processes are waiting for the other process to release a shared resource.</p>
<p><img src="../images/image-114.png" alt="Alt text"></p>
<p>A set of processes is deadlocked when each process
in the set is blocked awaiting an event that can only
be triggered by another blocked process in the set.</p>
<p>The block is permanenet because none of the events ever get triggered.</p>
<p><img src="../images/image-115.png" alt="Alt text"></p>
<p><img src="../images/image-116.png" alt="Alt text"></p>
<p>Trace 1 sees process <span class="katex-parse"><span class="visually-hidden">Q</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span> execute all of its desire operations before process <span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> can perform any single operation</p>
<p>Trace 2 sees process <span class="katex-parse"><span class="visually-hidden">Q</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span> get A then make process <span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> wait until it was done.</p>
<p>Trace 3 sees <span class="katex-parse"><span class="visually-hidden">Q</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span> get B and <span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> get A. 4 does the same but in reverse order</p>
<p>Traces 3 &amp; 4 eventually leads to a deadlock as each process will want the other’s acquired resource that they can’t release until they get the resource they want.</p>
<p>Trace 5 sees process <span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> get B then make process <span class="katex-parse"><span class="visually-hidden">Q</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span> wait until it’s done.</p>
<p>Trace 6 sees <span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> exectute everything before <span class="katex-parse"><span class="visually-hidden">Q</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span> gets make some meaningful progress.</p>
<p><img src="../images/image-117.png" alt="Alt text"></p>
<blockquote>
<p>“I would like to leave that for the banking algorithm” - Prof, no one knows what she meant by that</p>
</blockquote>
<p>This rearrangement is not always a possible solution since we don’t know what the order of the instructions/operations will be beforehand.</p>
<p>Traces 1, 2, 5, and 6 are unaffected but now traces 3 and 4 don’t lead to deadlock.</p>
<p>instead with Trace 3</p>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">Q</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span> gets B</li>
<li><span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> gets A then releases A</li>
<li><span class="katex-parse"><span class="visually-hidden">Q</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span> gets A, releases B, then releases A</li>
<li><span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> gets B then releases B</li>
</ul>
<p>Similarly with trace 4</p>
<p><img src="../images/image-118.png" alt="Alt text"></p>
<p>These are reusable resources.</p>
<p>There will be a deadlock.</p>
<p><span class="katex-parse"><span class="visually-hidden">p, start subscript, 0, end subscript, q, start subscript, 0, end subscript, p, start subscript, 1, end subscript, q, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><msub><mi>q</mi><mn>0</mn></msub><msub><mi>p</mi><mn>1</mn></msub><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_0 q_0 p_1 q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> introduces the possibility of a deadlock</p>
<p><span class="katex-parse"><span class="visually-hidden">p, start subscript, 0, end subscript, q, start subscript, 0, end subscript, p, start subscript, 1, end subscript, q, start subscript, 1, end subscript, p, start subscript, 2, end subscript, q, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><msub><mi>q</mi><mn>0</mn></msub><msub><mi>p</mi><mn>1</mn></msub><msub><mi>q</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_0 q_0 p_1 q_1 p_2 q_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is where the deadlock happens.</p>
<p><img src="../images/image-119.png" alt="Alt text"></p>
<p>These are reusable resources.</p>
<p>There will be a deadlock.</p>
<p>P1 and P2 can make their requests then the next requests will cause a deadlock.</p>
<p>P1 or P2 can make both requests but then upon the next request from the other process we will run into deadlock. That is unless there is some kind of release condition that we don’t see beyond the processes’ second requests.</p>
<p>The cause of the deadlock being that we don’t have enough resources to give.</p>
<p><img src="../images/image-120.png" alt="Alt text"></p>
<p>Consumable resource.</p>
<p>There is a deadlock as they are both waiting on each other.</p>
<p>If receive is not blocking - i.e. the processes just make themself open to receiving and don’t wait - then there is no deadlock.</p>
<p>It depends on the nature of the receive operation.</p>
<pre><code>Prof will tell us if it's blocking or not blocking.
</code></pre>
<h2 id="deadlock-in-multithreaded-applications">Deadlock in Multithreaded Applications</h2>
<p>2 mutex locks are created and initialized:</p>
<p><img src="../images/image-121.png" alt="Alt text"></p>
<p>2 threads are created and both threads have access to both mutex locks.</p>
<p><img src="../images/image-122.png" alt="Alt text"></p>
<p>Deadlock is possible if thread 1 acquires <code>first_mutex</code> and thread 2 acquires <code>second_mutex</code></p>
<p>Each thread then waits for the other’s mutex.</p>
<p><img src="../images/image-123.png" alt="Alt text"></p>
<p>THe order depends on how the threads are scheduled by the cpu scheduler.
hard to test for deadlocks as they may only occur under certain scheduling circumstances.</p>
<p>this is the livelock of waiting continually trying to acquire</p>
<hr>
<p>knowledge check:</p>
<ul>
<li>a deadlocked state occurs whenever
<ul>
<li>every process in a set is waiting for an event that can only be cauesd by another process in the set</li>
</ul>
</li>
<li>Deadlock occurs when every thread in a set is blocked waiting for an event that can be caused only by another thread in the set, while livelock occurs when a thread continuously attempts an action that fails.
<ul>
<li>true</li>
</ul>
</li>
<li>in the dining philosophers problem, there is a possibility of deadlock but not livelock
<ul>
<li>false</li>
<li>everyone picks a fork up then there is deadlock</li>
<li>if they keep picking it up and putting it down then there is livelock</li>
</ul>
</li>
</ul>
<h2 id="deadlock-characterization">Deadlock Characterization</h2>
<p>deadlock can arise if 4 conditions hold at the same time:</p>
<ul>
<li>mutual exclusion
<ul>
<li>only one process at a time can use a resource</li>
</ul>
</li>
<li>hold and wait
<ul>
<li>a process holding at least one resource is waiting to acquire additional resources held by other processes</li>
</ul>
</li>
<li>no preemption (for resources no the process)
<ul>
<li>resource only released by the process holding it after it’s done its task</li>
<li>resource cannot be preempted
<ul>
<li>processor can’t take resources from process and give it to other processes arbitrarily</li>
</ul>
</li>
</ul>
</li>
<li>circular wait
<ul>
<li>process 1 is waiting on process 2</li>
<li>process 2 is waiting on process 3</li>
<li>…</li>
<li>process n-1 is waiting on process n</li>
<li>process n is waiting on process 1</li>
</ul>
</li>
</ul>
<div class="mermaid"><svg id="mermaid-1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="99.5859375" style="max-width: 677.156px; max-height: 99.5859px;" viewBox="0 0 677.15625 99.5859375"><style>#mermaid-1 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-1 .error-icon{fill:#a44141;}#mermaid-1 .error-text{fill:#ddd;stroke:#ddd;}#mermaid-1 .edge-thickness-normal{stroke-width:2px;}#mermaid-1 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1 .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-1 .marker.cross{stroke:lightgrey;}#mermaid-1 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#ccc;}#mermaid-1 .cluster-label text{fill:#F9FFFE;}#mermaid-1 .cluster-label span{color:#F9FFFE;}#mermaid-1 .label text,#mermaid-1 span{fill:#ccc;color:#ccc;}#mermaid-1 .node rect,#mermaid-1 .node circle,#mermaid-1 .node ellipse,#mermaid-1 .node polygon,#mermaid-1 .node path{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-1 .node .label{text-align:center;}#mermaid-1 .node.clickable{cursor:pointer;}#mermaid-1 .arrowheadPath{fill:lightgrey;}#mermaid-1 .edgePath .path{stroke:lightgrey;stroke-width:2.0px;}#mermaid-1 .flowchart-link{stroke:lightgrey;fill:none;}#mermaid-1 .edgeLabel{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}#mermaid-1 .edgeLabel rect{opacity:0.5;background-color:hsl(0, 0%, 34.4117647059%);fill:hsl(0, 0%, 34.4117647059%);}#mermaid-1 .cluster rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:rgba(255, 255, 255, 0.25);stroke-width:1px;}#mermaid-1 .cluster text{fill:#F9FFFE;}#mermaid-1 .cluster span{color:#F9FFFE;}#mermaid-1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(20, 1.5873015873%, 12.3529411765%);border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g transform="translate(0, 0)"><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M31.90625,48.355179653953016L40.223958333333336,44.74520179496085C48.541666666666664,41.135223935968675,65.17708333333333,33.91526821798434,81.8125,30.30529035899217C98.44791666666667,26.6953125,115.08333333333333,26.6953125,123.40104166666667,26.6953125L131.71875,26.6953125" id="L-1-2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-1 LE-2" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M155.625,26.6953125L163.94270833333334,26.6953125C172.26041666666666,26.6953125,188.89583333333334,26.6953125,205.53125,26.6953125C222.16666666666666,26.6953125,238.80208333333334,26.6953125,247.11979166666666,26.6953125L255.4375,26.6953125" id="L-2-3-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-2 LE-3" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M279.34375,26.6953125L287.6614583333333,26.6953125C295.9791666666667,26.6953125,312.6145833333333,26.6953125,329.25,26.6953125C345.8854166666667,26.6953125,362.5208333333333,26.6953125,370.8385416666667,26.6953125L379.15625,26.6953125" id="L-3-...-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-3 LE-..." style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M407.5,26.6953125L415.8177083333333,26.6953125C424.1354166666667,26.6953125,440.7708333333333,26.6953125,457.40625,26.6953125C474.0416666666667,26.6953125,490.6770833333333,26.6953125,498.9947916666667,26.6953125L507.3125,26.6953125" id="L-...-n-1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-... LE-n-1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M545.4375,26.6953125L553.7552083333334,26.6953125C562.0729166666666,26.6953125,578.7083333333334,26.6953125,595.34375,30.30529035899217C611.9791666666666,33.91526821798434,628.6145833333334,41.135223935968675,636.9322916666666,44.74520179496085L645.25,48.355179653953016" id="L-n-1-n-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-n-1 LE-n" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M645.25,58.730757846046984L636.9322916666666,62.34073570503915C628.6145833333334,65.95071356403132,611.9791666666666,73.17066928201565,592.1666666666666,76.78064714100783C572.3541666666666,80.390625,549.3645833333334,80.390625,526.375,80.390625C503.3854166666667,80.390625,480.3958333333333,80.390625,458.2213541666667,80.390625C436.046875,80.390625,414.6875,80.390625,393.328125,80.390625C371.96875,80.390625,350.609375,80.390625,329.6197916666667,80.390625C308.6302083333333,80.390625,288.0104166666667,80.390625,267.390625,80.390625C246.77083333333334,80.390625,226.15104166666666,80.390625,205.53125,80.390625C184.91145833333334,80.390625,164.29166666666666,80.390625,143.671875,80.390625C123.05208333333333,80.390625,102.43229166666667,80.390625,83.8046875,76.78064714100783C65.17708333333333,73.17066928201565,48.541666666666664,65.95071356403132,40.223958333333336,62.34073570503915L31.90625,58.730757846046984" id="L-n-1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-n LE-1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(81.8125, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(205.53125, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(329.25, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(457.40625, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(595.34375, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(329.25, 80.390625)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-1-7" transform="translate(19.953125, 53.54296875)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-2-8" transform="translate(143.671875, 26.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">2</span></div></foreignObject></g></g><g class="node default default" id="flowchart-3-9" transform="translate(267.390625, 26.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">3</span></div></foreignObject></g></g><g class="node default default" id="flowchart-...-10" transform="translate(393.328125, 26.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-14.171875" y="-18.6953125" width="28.34375" height="37.390625"></rect><g class="label" style="" transform="translate(-6.671875, -11.1953125)"><foreignObject width="13.34375" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">...</span></div></foreignObject></g></g><g class="node default default" id="flowchart-n-1-11" transform="translate(526.375, 26.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-19.0625" y="-18.6953125" width="38.125" height="37.390625"></rect><g class="label" style="" transform="translate(-11.5625, -11.1953125)"><foreignObject width="23.125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">n-1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-n-12" transform="translate(657.203125, 53.54296875)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">n</span></div></foreignObject></g></g></g></g></g></svg></div><p><img src="../images/image-124.png" alt="Alt text"></p>
<h3 id="resource-allocation-graph">Resource Allocation Graph</h3>
<p><img src="../images/image-125.png" alt="Alt text"></p>
<p>A digraph with vertices <span class="katex-parse"><span class="visually-hidden">V</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span> partitioned into <span class="katex-parse"><span class="visually-hidden">P</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> processes and <span class="katex-parse"><span class="visually-hidden">R</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span> resources</p>
<p><img src="../images/image-126.png" alt="Alt text"></p>
<p><img src="../images/image-127.png" alt="Alt text"></p>
<p>There are 3 threads and 4 resources.</p>
<figure class="table-wrapper"><table>
<thead>
<tr>
<th>.</th>
<th><span class="katex-parse"><span class="visually-hidden">T, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex-parse"><span class="visually-hidden">T, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex-parse"><span class="visually-hidden">T, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">T_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="katex-parse"><span class="visually-hidden">R, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td>
<td>req</td>
<td>assigned</td>
<td></td>
</tr>
<tr>
<td><span class="katex-parse"><span class="visually-hidden">R, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td>
<td>assigned</td>
<td>assigned</td>
<td></td>
</tr>
<tr>
<td><span class="katex-parse"><span class="visually-hidden">R, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">R_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td>
<td></td>
<td>req</td>
<td>assigned</td>
</tr>
<tr>
<td><span class="katex-parse"><span class="visually-hidden">R, start subscript, 4, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">R_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</figure><p>There are 1 instance of <span class="katex-parse"><span class="visually-hidden">R, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">R, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>2 of <span class="katex-parse"><span class="visually-hidden">R, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and 3 of <span class="katex-parse"><span class="visually-hidden">R, start subscript, 4, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">R_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>There are no cycles in the graph.</p>
<p>Therefore there are no deadlocks</p>
<p>If there is no cycle then there is no deadlock.</p>
<p><img src="../images/image-128.png" alt="Alt text"></p>
<p>There are 2 cycles.</p>
<p>T1 is assigned R2 and wants R1</p>
<p>T2 is assigned R1+R2 and wants R3</p>
<p>T3 is assigned R3 and wants R2 which it can’t get since there’s no more instances of R2</p>
<pre><code>It might seem like there's no deadlock if we look at the smaller cycle.

T2 is assigned R2 and wants R3
T3 is assigned R3 and wants R2 which it can get since there's another instance of R2

T3 finishes with R3 and gives it up for T2.

This is a static situation so we have a deadlock
</code></pre>
<p><img src="../images/image-129.png" alt="Alt text"></p>
<p>There is a cycle with the middle 4 nodes.</p>
<p>There is no deadlock.</p>
<p>The outter threads of <span class="katex-parse"><span class="visually-hidden">T, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">T, start subscript, 4, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">T_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> can finish and release their instances of <span class="katex-parse"><span class="visually-hidden">R, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">R, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> respectively.</p>
<p>Then <span class="katex-parse"><span class="visually-hidden">T, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">T, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">T_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> can get hold of the resources and work on them.</p>
<hr>
<p>If there is no cycle,
then there is no deadlock</p>
<p>If there is a cycle then there may or may not be a deadlock</p>
<ul>
<li>if only one instance per resource type, then deadlock</li>
<li>if there are several instances per resource type, possibility of deadlock</li>
</ul>
<hr>
<p>deadlock:</p>
<p><img src="../images/image-130.png" alt="Alt text"></p>
<p>no deadlock:</p>
<p><img src="../images/image-131.png" alt="Alt text"></p>
<div class="mermaid"><svg id="mermaid-2" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="170.03125" style="max-width: 423.266px; max-height: 170.031px;" viewBox="0 0 423.265625 170.03125"><style>#mermaid-2 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-2 .error-icon{fill:#a44141;}#mermaid-2 .error-text{fill:#ddd;stroke:#ddd;}#mermaid-2 .edge-thickness-normal{stroke-width:2px;}#mermaid-2 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-2 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-2 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-2 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-2 .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-2 .marker.cross{stroke:lightgrey;}#mermaid-2 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-2 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#ccc;}#mermaid-2 .cluster-label text{fill:#F9FFFE;}#mermaid-2 .cluster-label span{color:#F9FFFE;}#mermaid-2 .label text,#mermaid-2 span{fill:#ccc;color:#ccc;}#mermaid-2 .node rect,#mermaid-2 .node circle,#mermaid-2 .node ellipse,#mermaid-2 .node polygon,#mermaid-2 .node path{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-2 .node .label{text-align:center;}#mermaid-2 .node.clickable{cursor:pointer;}#mermaid-2 .arrowheadPath{fill:lightgrey;}#mermaid-2 .edgePath .path{stroke:lightgrey;stroke-width:2.0px;}#mermaid-2 .flowchart-link{stroke:lightgrey;fill:none;}#mermaid-2 .edgeLabel{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}#mermaid-2 .edgeLabel rect{opacity:0.5;background-color:hsl(0, 0%, 34.4117647059%);fill:hsl(0, 0%, 34.4117647059%);}#mermaid-2 .cluster rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:rgba(255, 255, 255, 0.25);stroke-width:1px;}#mermaid-2 .cluster text{fill:#F9FFFE;}#mermaid-2 .cluster span{color:#F9FFFE;}#mermaid-2 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(20, 1.5873015873%, 12.3529411765%);border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-2 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g transform="translate(0, 0)"><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"><g class="cluster default" id="Rb"><rect style="" rx="0" ry="0" x="8" y="8" width="158.90625" height="69.453125"></rect><g class="cluster-label" transform="translate(77.2265625, 13)"><foreignObject width="20.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Rb</span></div></foreignObject></g></g><g class="cluster default" id="Ra"><rect style="" rx="0" ry="0" x="186.90625" y="8" width="228.359375" height="69.453125"></rect><g class="cluster-label" transform="translate(290.859375, 13)"><foreignObject width="20.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Ra</span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M52.7265625,52.453125L52.7265625,56.619791666666664C52.7265625,60.786458333333336,52.7265625,69.11979166666667,52.7265625,77.453125C52.7265625,85.78645833333333,52.7265625,94.11979166666667,53.730131889066364,102.53045919506475C54.73370127813272,110.94112672346284,56.74084005626545,119.42912844692569,57.744409445331804,123.67312930865711L58.747978834398175,127.91713017038853" id="L-4-P1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-4 LE-P1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M122.1796875,52.453125L122.1796875,56.619791666666664C122.1796875,60.786458333333336,122.1796875,69.11979166666667,132.96744791666666,77.453125C143.75520833333334,85.78645833333333,165.33072916666666,94.11979166666667,190.8118445788714,104.25084757899118C216.29295999107612,114.38190349131571,245.6796699821522,126.31068198263141,260.37302497769025,132.27507122828925L275.0663799732283,138.2394604739471" id="L-5-P2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-5 LE-P2" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M231.6328125,52.453125L231.6328125,56.619791666666664C231.6328125,60.786458333333336,231.6328125,69.11979166666667,220.84505208333334,77.453125C210.05729166666666,85.78645833333333,188.48177083333334,94.11979166666667,163.0006554211286,104.25084757899118C137.51954000892388,114.38190349131571,108.13283001784778,126.31068198263141,93.43947502230975,132.27507122828925L78.74612002677169,138.2394604739471" id="L-1-P1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-1 LE-P1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M301.0859375,52.453125L301.0859375,56.619791666666664C301.0859375,60.786458333333336,301.0859375,69.11979166666667,301.0859375,77.453125C301.0859375,85.78645833333333,301.0859375,94.11979166666667,300.08236811093366,102.53045919506475C299.07879872186726,110.94112672346284,297.0716599437346,119.42912844692569,296.06809055466823,123.67312930865711L295.06452116560183,127.91713017038853" id="L-2-P2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-2 LE-P2" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-1-31" transform="translate(231.6328125, 42.7265625)"><circle style="" rx="0" ry="0" r="9.7265625" width="19.453125" height="37.390625"></circle><g class="label" style="" transform="translate(-2.2265625, -11.1953125)"><foreignObject width="4.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">.</span></div></foreignObject></g></g><g class="node default default" id="flowchart-2-32" transform="translate(301.0859375, 42.7265625)"><circle style="" rx="0" ry="0" r="9.7265625" width="19.453125" height="37.390625"></circle><g class="label" style="" transform="translate(-2.2265625, -11.1953125)"><foreignObject width="4.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">.</span></div></foreignObject></g></g><g class="node default default" id="flowchart-3-33" transform="translate(370.5390625, 42.7265625)"><circle style="" rx="0" ry="0" r="9.7265625" width="19.453125" height="37.390625"></circle><g class="label" style="" transform="translate(-2.2265625, -11.1953125)"><foreignObject width="4.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">.</span></div></foreignObject></g></g><g class="node default default" id="flowchart-4-34" transform="translate(52.7265625, 42.7265625)"><circle style="" rx="0" ry="0" r="9.7265625" width="19.453125" height="37.390625"></circle><g class="label" style="" transform="translate(-2.2265625, -11.1953125)"><foreignObject width="4.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">.</span></div></foreignObject></g></g><g class="node default default" id="flowchart-5-35" transform="translate(122.1796875, 42.7265625)"><circle style="" rx="0" ry="0" r="9.7265625" width="19.453125" height="37.390625"></circle><g class="label" style="" transform="translate(-2.2265625, -11.1953125)"><foreignObject width="4.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">.</span></div></foreignObject></g></g><g class="node default default" id="flowchart-P1-29" transform="translate(62.7265625, 144.7421875)"><circle style="" rx="0" ry="0" r="17.2890625" width="34.578125" height="37.390625"></circle><g class="label" style="" transform="translate(-9.7890625, -11.1953125)"><foreignObject width="19.578125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">P1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-P2-30" transform="translate(291.0859375, 144.7421875)"><circle style="" rx="0" ry="0" r="17.2890625" width="34.578125" height="37.390625"></circle><g class="label" style="" transform="translate(-9.7890625, -11.1953125)"><foreignObject width="19.578125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">P2</span></div></foreignObject></g></g></g></g></g></svg></div><p>Resource Allocation graph for the car deadlock example showing circular wait</p>
<p><img src="../images/image-132.png" alt="Alt text"></p>
<p>We can take the numbers on the cars to be the numbers of the processes.</p>
<p>Car 1 is sitting lane <strong>Ra</strong> and wants to cross lane Rb</p>
<p>Car 2 is sitting lane Rb and wants to cross lane Rc</p>
<p>Car 3 is sitting lane Rc and wants to cross lane Rd</p>
<p>Car 4 is sitting lane Rd and wants to cross lane <strong>Ra</strong></p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>one necessary condition for deadlock is ___, which states taht a process must be holding one resource and waiting to acquire additional resources
<ul>
<li>a: hold and wait</li>
</ul>
</li>
<li>a cycle in a resource-allocation graph is ___
<ul>
<li>d. a necessary and sufficient condition for a deadlock in the case that each resource has exactly one instance</li>
</ul>
</li>
<li>if a resource-allocation graph has a cycle, the system must be in a deadlocked state.
<ul>
<li>false</li>
</ul>
</li>
</ul>
<h2 id="methods-for-handling-deadlocks">Methods for Handling Deadlocks</h2>
<p>In general,
there are 3 ways to deal with deadlocks:</p>
<ol>
<li>prevention and avoidance</li>
<li>detection and recovery</li>
<li>ignoring it</li>
</ol>
<p>most OSes including windows and linux just pretend that deadlocks don’t happen <code>???</code></p>
<pre><code>Prof later explained that this is just left up to the programmer/user and it's not up to the OS.

pulled a pontius pilate and washed their hands of the whole situ
</code></pre>
<h3 id="prevention">Prevention</h3>
<p>In order to prevent deadlocks we have to invalidate one of the 4 necessary conditions for deadlock</p>
<pre><code>as a refresher

deadlock can arise if 4 conditions hold at the same time:
- mutual exclusion
  - only one process at a time can use a resource
- hold and wait
  - a process holding at least one resource is waiting to acquire additional resources held by other processes
- no preemption (for resources no the process)
  - resource only released by the process holding it after it's done its task
  - resource cannot be preempted
    - processor can't take resources from process and give it to other processes arbitrarily
- circular wait
  - process 1 is waiting on process 2
  - process 2 is waiting on process 3
  - ...
  - process n-1 is waiting on process n
  - process n is waiting on process 1
</code></pre>
<p>Though there are shareable resources,
we cannot invalidate mutual exclusion as a whole since some resources just cannot be shared and used at the same time.</p>
<h4 id="deny-hold-and-wait">Deny Hold and Wait</h4>
<p>We can invalidate hold and wait by ensuring that whenever a requests a resource it won’t be holding any other resources.
Put another way,
If the process is holding a resource then they won’t be making any requests.</p>
<p>how:</p>
<ul>
<li>require process to request and allocate all resources before execution
<ul>
<li><strong>dynamic nature of resource requesting makes this impractical</strong></li>
</ul>
</li>
<li>only allow resource requests when process has no resource allocated
<ul>
<li>must release resources before requesting for more</li>
</ul>
</li>
</ul>
<p>cons:</p>
<ul>
<li>low resource utilization
<ul>
<li>resources allocated but not used</li>
</ul>
</li>
<li>starvation possible
<ul>
<li>a thread may have to wait indefinitely if it needs several popular resources</li>
<li>those resources will always end up allocated to processes that will only need those resources</li>
<li><code>I imagine that even with bounded wait time considerations, priority will cause this to happen as well</code></li>
</ul>
</li>
</ul>
<h4 id="deny-no-preemption">Deny No Preemption</h4>
<p><code>reminder: non-preemptive is when a process enters into the processor and only leaves when it's finished or voluntarily leaves when waiting on something</code></p>
<p>if</p>
<ul>
<li>a process is holding some resources</li>
<li>the process requests another resources</li>
<li>that resource cannot be immediately allocated to it</li>
</ul>
<p>then <strong>all resources currently being held are preempted</strong>, released by the processor.</p>
<p>Preempted resources are added to the list of resources that the process is waiting for.</p>
<p>The process starts again once it regains all of the resources it’s requesting
(the old preempted ones and the new ones).</p>
<p>This is often <code>selectively</code> applied to resources whose state can be easily saved and restored later,
such as cpu registers and database transactions.</p>
<p>cons:</p>
<ul>
<li>cannot be applied to resources like mutex locks and semaphores which are the type of resources where deadlock occurs most commonly
<ul>
<li>it’s hard to save the condition of a mutex when a process wants to lock for a critical section</li>
<li>not easy to store and retrieve <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> not easy to preempt</li>
<li><code>we can't do this for the shit we actually care about bruhhhhhhh</code></li>
</ul>
</li>
</ul>
<h4 id="deny-circular-wait">Deny Circular Wait</h4>
<p>This is the most common approach</p>
<div class="mermaid"><svg id="mermaid-3" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="99.5859375" style="max-width: 677.156px; max-height: 99.5859px;" viewBox="0 0 677.15625 99.5859375"><style>#mermaid-3 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-3 .error-icon{fill:#a44141;}#mermaid-3 .error-text{fill:#ddd;stroke:#ddd;}#mermaid-3 .edge-thickness-normal{stroke-width:2px;}#mermaid-3 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-3 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-3 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-3 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-3 .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-3 .marker.cross{stroke:lightgrey;}#mermaid-3 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-3 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#ccc;}#mermaid-3 .cluster-label text{fill:#F9FFFE;}#mermaid-3 .cluster-label span{color:#F9FFFE;}#mermaid-3 .label text,#mermaid-3 span{fill:#ccc;color:#ccc;}#mermaid-3 .node rect,#mermaid-3 .node circle,#mermaid-3 .node ellipse,#mermaid-3 .node polygon,#mermaid-3 .node path{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-3 .node .label{text-align:center;}#mermaid-3 .node.clickable{cursor:pointer;}#mermaid-3 .arrowheadPath{fill:lightgrey;}#mermaid-3 .edgePath .path{stroke:lightgrey;stroke-width:2.0px;}#mermaid-3 .flowchart-link{stroke:lightgrey;fill:none;}#mermaid-3 .edgeLabel{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}#mermaid-3 .edgeLabel rect{opacity:0.5;background-color:hsl(0, 0%, 34.4117647059%);fill:hsl(0, 0%, 34.4117647059%);}#mermaid-3 .cluster rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:rgba(255, 255, 255, 0.25);stroke-width:1px;}#mermaid-3 .cluster text{fill:#F9FFFE;}#mermaid-3 .cluster span{color:#F9FFFE;}#mermaid-3 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(20, 1.5873015873%, 12.3529411765%);border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-3 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g transform="translate(0, 0)"><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M31.90625,48.355179653953016L40.223958333333336,44.74520179496085C48.541666666666664,41.135223935968675,65.17708333333333,33.91526821798434,81.8125,30.30529035899217C98.44791666666667,26.6953125,115.08333333333333,26.6953125,123.40104166666667,26.6953125L131.71875,26.6953125" id="L-1-2-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-1 LE-2" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M155.625,26.6953125L163.94270833333334,26.6953125C172.26041666666666,26.6953125,188.89583333333334,26.6953125,205.53125,26.6953125C222.16666666666666,26.6953125,238.80208333333334,26.6953125,247.11979166666666,26.6953125L255.4375,26.6953125" id="L-2-3-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-2 LE-3" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M279.34375,26.6953125L287.6614583333333,26.6953125C295.9791666666667,26.6953125,312.6145833333333,26.6953125,329.25,26.6953125C345.8854166666667,26.6953125,362.5208333333333,26.6953125,370.8385416666667,26.6953125L379.15625,26.6953125" id="L-3-4-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-3 LE-4" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M407.5,26.6953125L415.8177083333333,26.6953125C424.1354166666667,26.6953125,440.7708333333333,26.6953125,457.40625,26.6953125C474.0416666666667,26.6953125,490.6770833333333,26.6953125,498.9947916666667,26.6953125L507.3125,26.6953125" id="L-4-n-1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-4 LE-n-1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M545.4375,26.6953125L553.7552083333334,26.6953125C562.0729166666666,26.6953125,578.7083333333334,26.6953125,595.34375,30.30529035899217C611.9791666666666,33.91526821798434,628.6145833333334,41.135223935968675,636.9322916666666,44.74520179496085L645.25,48.355179653953016" id="L-n-1-n-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-n-1 LE-n" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M645.25,58.730757846046984L636.9322916666666,62.34073570503915C628.6145833333334,65.95071356403132,611.9791666666666,73.17066928201565,592.1666666666666,76.78064714100783C572.3541666666666,80.390625,549.3645833333334,80.390625,526.375,80.390625C503.3854166666667,80.390625,480.3958333333333,80.390625,458.2213541666667,80.390625C436.046875,80.390625,414.6875,80.390625,393.328125,80.390625C371.96875,80.390625,350.609375,80.390625,329.6197916666667,80.390625C308.6302083333333,80.390625,288.0104166666667,80.390625,267.390625,80.390625C246.77083333333334,80.390625,226.15104166666666,80.390625,205.53125,80.390625C184.91145833333334,80.390625,164.29166666666666,80.390625,143.671875,80.390625C123.05208333333333,80.390625,102.43229166666667,80.390625,83.8046875,76.78064714100783C65.17708333333333,73.17066928201565,48.541666666666664,65.95071356403132,40.223958333333336,62.34073570503915L31.90625,58.730757846046984" id="L-n-1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-n LE-1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(81.8125, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(205.53125, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(329.25, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(457.40625, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(595.34375, 26.6953125)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(329.25, 80.390625)"><g class="label" transform="translate(-24.90625, -11.1953125)"><foreignObject width="49.8125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">waiting</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-1-53" transform="translate(19.953125, 53.54296875)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-2-54" transform="translate(143.671875, 26.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">2</span></div></foreignObject></g></g><g class="node default default" id="flowchart-3-55" transform="translate(267.390625, 26.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">3</span></div></foreignObject></g></g><g class="node default default" id="flowchart-4-56" transform="translate(393.328125, 26.6953125)"><circle style="" rx="0" ry="0" r="14.171875" width="28.34375" height="37.390625"></circle><g class="label" style="" transform="translate(-6.671875, -11.1953125)"><foreignObject width="13.34375" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">...</span></div></foreignObject></g></g><g class="node default default" id="flowchart-n-1-57" transform="translate(526.375, 26.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-19.0625" y="-18.6953125" width="38.125" height="37.390625"></rect><g class="label" style="" transform="translate(-11.5625, -11.1953125)"><foreignObject width="23.125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">n-1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-n-58" transform="translate(657.203125, 53.54296875)"><rect class="basic label-container" style="" rx="0" ry="0" x="-11.953125" y="-18.6953125" width="23.90625" height="37.390625"></rect><g class="label" style="" transform="translate(-4.453125, -11.1953125)"><foreignObject width="8.90625" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">n</span></div></foreignObject></g></g></g></g></g></svg></div><p>how:</p>
<ul>
<li>assign each resource a unique number</li>
<li>resources must be acquired in the order of their unique number</li>
</ul>
<hr>
<p>Knowledge check:</p>
<ul>
<li>to handle deadlocks, operating systems most often ___
<ul>
<li>a. pretend that deadlocks never occur</li>
</ul>
</li>
<li>both deadlock prevention and deadlock avoidance techniques ensure that the system will never enter a deadlocked state
<ul>
<li>true</li>
</ul>
</li>
<li>most operating systems choose to ignore deadlocks, because
<ul>
<li>d. all of the above</li>
<li>handling is expensive, they occur infrequently, livelock  recovery methods can be use on deadlocks</li>
</ul>
</li>
</ul>
<h3 id="deadlock-avoidance">Deadlock Avoidance</h3>
<p>Dynamically made decision to see if an allocation request will potentially lead to a deadlock if granted.</p>
<p>System considers</p>
<ul>
<li>currently available resources</li>
<li>currently allocated resources</li>
<li>and the future requests and releases of each thread</li>
</ul>
<p>requires knowledge of future process requests.</p>
<p>basics:</p>
<ul>
<li>state
<ul>
<li>reflects current allocation of resources to processes</li>
</ul>
</li>
<li>safe state
<ul>
<li>state where there is at least one execution path where all the processes will finish</li>
<li>there will be no deadlock</li>
</ul>
</li>
<li>unsafe state
<ul>
<li>state resulting in possibility of deadlock</li>
</ul>
</li>
<li>avoidance
<ul>
<li>ensuring system will never enter an unsafe state</li>
</ul>
</li>
</ul>
<h4 id="safe-state">Safe State</h4>
<p><img src="../images/image-133.png" alt="Alt text"></p>
<p><img src="../images/image-134.png" alt="Alt text"></p>
<hr>
<p><img src="../images/image-135.png" alt="Alt text"></p>
<p>In the above example we only have 3 resources available.</p>
<p>For T1 we give it 2 then release back 4 once it’s done.</p>
<p>Then the above steps just go as shown.</p>
<p>So we are in a safe state</p>
<p><img src="../images/image-136.png" alt="Alt text"></p>
<p>This is the same example as seen above but now <span class="katex-parse"><span class="visually-hidden">T, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> needs 1 more resource,
requests the resource and receives it,
resulting in only 2 resources available at the beginning.</p>
<p>We can start the sequence with <span class="katex-parse"><span class="visually-hidden">T, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and allocate 2 then get back 2 once done.</p>
<p>We end up with only 4 available resources which isn’t enough to satisfy the maximum needs of <span class="katex-parse"><span class="visually-hidden">T, start subscript, 0, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">T_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">T, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="avoidance-algos">Avoidance Algos</h4>
<p>There are 2 algos:</p>
<ol>
<li>using a resource-allocation when there’s a single instance of a resource type</li>
<li>use the Banker’s Algo when there’s multiple instances of a resource type</li>
</ol>
<h5 id="resource-allocation-graph-scheme">Resource-Allocation Graph Scheme</h5>
<p><img src="../images/image-137.png" alt="Alt text"></p>
<p><code>a priori</code> = <code>ahead of time</code></p>
<p>claims turn into requests which turn into assignments before turning back into claim edges</p>
<p><img src="../images/image-138.png" alt="Alt text"></p>
<div class="mermaid"><svg id="mermaid-4" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="210.78125" style="max-width: 268.797px; max-height: 210.781px;" viewBox="0 0 268.796875 210.78125"><style>#mermaid-4 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}#mermaid-4 .error-icon{fill:#a44141;}#mermaid-4 .error-text{fill:#ddd;stroke:#ddd;}#mermaid-4 .edge-thickness-normal{stroke-width:2px;}#mermaid-4 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-4 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-4 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-4 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-4 .marker{fill:lightgrey;stroke:lightgrey;}#mermaid-4 .marker.cross{stroke:lightgrey;}#mermaid-4 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-4 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#ccc;}#mermaid-4 .cluster-label text{fill:#F9FFFE;}#mermaid-4 .cluster-label span{color:#F9FFFE;}#mermaid-4 .label text,#mermaid-4 span{fill:#ccc;color:#ccc;}#mermaid-4 .node rect,#mermaid-4 .node circle,#mermaid-4 .node ellipse,#mermaid-4 .node polygon,#mermaid-4 .node path{fill:#1f2020;stroke:#81B1DB;stroke-width:1px;}#mermaid-4 .node .label{text-align:center;}#mermaid-4 .node.clickable{cursor:pointer;}#mermaid-4 .arrowheadPath{fill:lightgrey;}#mermaid-4 .edgePath .path{stroke:lightgrey;stroke-width:2.0px;}#mermaid-4 .flowchart-link{stroke:lightgrey;fill:none;}#mermaid-4 .edgeLabel{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}#mermaid-4 .edgeLabel rect{opacity:0.5;background-color:hsl(0, 0%, 34.4117647059%);fill:hsl(0, 0%, 34.4117647059%);}#mermaid-4 .cluster rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:rgba(255, 255, 255, 0.25);stroke-width:1px;}#mermaid-4 .cluster text{fill:#F9FFFE;}#mermaid-4 .cluster span{color:#F9FFFE;}#mermaid-4 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(20, 1.5873015873%, 12.3529411765%);border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-4 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g transform="translate(0, 0)"><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g class="root" transform="translate(0.5, 0)"><g class="clusters"><g class="cluster default" id="subGraph0"><rect style="" rx="0" ry="0" x="8" y="8" width="252.796875" height="194.78125"></rect><g class="cluster-label" transform="translate(73.46875, 13)"><foreignObject width="121.859375" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">good assignment</span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M61.47919203606686,93.2298924845524L66.51130586338905,87.97412915379367C71.54341969071125,82.71836582303493,81.60764734535563,72.20683916151746,90.8064278393445,66.95107583075874C100.00520833333333,61.6953125,108.33854166666667,61.6953125,112.50520833333333,61.6953125L116.671875,61.6953125" id="L-T2-R1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-T2 LE-R1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M152.125,61.6953125L156.29166666666666,61.6953125C160.45833333333334,61.6953125,168.79166666666666,61.6953125,177.99044716065552,66.95107583075874C187.18922765464438,72.20683916151746,197.2534553092888,82.71836582303493,202.28556913661097,87.97412915379367L207.31768296393315,93.2298924845524" id="L-R1-T1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-R1 LE-T1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M152.125,149.0859375L156.29166666666666,149.0859375C160.45833333333334,149.0859375,168.79166666666666,149.0859375,177.99044716065552,143.83017416924127C187.18922765464438,138.57441083848252,197.2534553092888,128.06288417696507,202.28556913661097,122.80712084620633L207.31768296393315,117.5513575154476" id="L-R2-T1-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-R2 LE-T1" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M61.47919203606686,117.5513575154476L66.51130586338905,122.80712084620633C71.54341969071125,128.06288417696507,81.60764734535563,138.57441083848252,90.8064278393445,143.83017416924127C100.00520833333333,149.0859375,108.33854166666667,149.0859375,112.50520833333333,149.0859375L116.671875,149.0859375" id="L-T2-R2-0" class=" edge-thickness-normal edge-pattern-dotted flowchart-link LS-T2 LE-R2" style="fill:none;stroke-width:2px;stroke-dasharray:3;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-T1-71" transform="translate(218.9609375, 105.390625)"><circle style="" rx="0" ry="0" r="16.8359375" width="33.671875" height="37.390625"></circle><g class="label" style="" transform="translate(-9.3359375, -11.1953125)"><foreignObject width="18.671875" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">T1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-T2-72" transform="translate(49.8359375, 105.390625)"><circle style="" rx="0" ry="0" r="16.8359375" width="33.671875" height="37.390625"></circle><g class="label" style="" transform="translate(-9.3359375, -11.1953125)"><foreignObject width="18.671875" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">T2</span></div></foreignObject></g></g><g class="node default default" id="flowchart-R1-73" transform="translate(134.3984375, 61.6953125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-17.7265625" y="-18.6953125" width="35.453125" height="37.390625"></rect><g class="label" style="" transform="translate(-10.2265625, -11.1953125)"><foreignObject width="20.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">R1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-R2-74" transform="translate(134.3984375, 149.0859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-17.7265625" y="-18.6953125" width="35.453125" height="37.390625"></rect><g class="label" style="" transform="translate(-10.2265625, -11.1953125)"><foreignObject width="20.453125" height="22.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">R2</span></div></foreignObject></g></g></g></g></g></g></g></svg></div><p><img src="../images/image-139.png" alt="Alt text"></p>
<p>make sure there is no cycles forming if you convert a request edge to an assignment edge</p>
<h5 id="banker%E2%80%99s-algorithm">Banker’s Algorithm</h5>
<p><code>prof misspells this is as Baker at some point. It's Banker.</code></p>
<p>conditions:</p>
<ul>
<li>multiple instances of resources</li>
<li>each process must have a prior claim maximum use</li>
<li>when a process requests a resource, it may have to wait</li>
<li>when aprocess gets all its resources it must return them in a finite amount of time</li>
</ul>
<p><img src="../images/image-140.png" alt="Alt text"></p>
<p><img src="../images/image-141.png" alt="Alt text"></p>
<p><img src="../images/image-142.png" alt="Alt text"></p>
<hr>
<p><img src="../images/image-143.png" alt="Alt text"></p>
<p><img src="../images/image-144.png" alt="Alt text"></p>
<p>Q: Does the sequence <span class="katex-parse"><span class="visually-hidden">is less than, P, start subscript, 1, end subscript, comma, P, start subscript, 3, end subscript, comma, P, start subscript, 4, end subscript, comma, P, start subscript, 2, end subscript, comma, P, start subscript, 0, end subscript, is greater than</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>4</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>0</mn></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;P_1, P_3, P_4, P_2, P_0&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span> satisfy safety criteria?</p>
<p>A: yes</p>
<p>we start with <span class="katex-parse"><span class="visually-hidden">is less than, 3, comma, 3, comma, 2, is greater than</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>3</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>2</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;3, 3, 2&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></p>
<p><span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> can be allocated and give back <span class="katex-parse"><span class="visually-hidden">is less than, 5, comma, 3, comma, 2, is greater than</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>5</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>2</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;5, 3, 2&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></p>
<p><span class="katex-parse"><span class="visually-hidden">P, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> can be allocated and give back <span class="katex-parse"><span class="visually-hidden">is less than, 7, comma, 4, comma, 3, is greater than</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>7</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>3</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;7, 4, 3&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></p>
<p><span class="katex-parse"><span class="visually-hidden">P, start subscript, 4, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> can be allocated and give back <span class="katex-parse"><span class="visually-hidden">is less than, 7, comma, 4, comma, 5, is greater than</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>7</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;7, 4, 5&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></p>
<p><span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> can be allocated and give back <span class="katex-parse"><span class="visually-hidden">is less than, 10, comma, 4, comma, 7, is greater than</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>10</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>7</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;10, 4, 7&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>, making all instances of <span class="katex-parse"><span class="visually-hidden">A</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">C</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span> available</p>
<p><span class="katex-parse"><span class="visually-hidden">P, start subscript, 0, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> can be allocated and give back <span class="katex-parse"><span class="visually-hidden">is less than, 10, comma, 5, comma, 7, is greater than</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>10</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>7</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;10, 5, 7&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>,
making all instances of all resources available.</p>
<hr>
<p><img src="../images/image-145.png" alt="Alt text"></p>
<p>you do the same process with this.</p>
<p>A: the sequence satisfies safety requirement</p>
<p><img src="../images/image-146.png" alt="Alt text"></p>
<hr>
<p>In essence:</p>
<ul>
<li>we are in a safe setaet if there is at least one sequence of resource allocations to processes that does not result in a deadlock</li>
<li>for <span class="katex-parse"><span class="visually-hidden">i, \in, open bracket, 0, point, point, n, close bracket</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0..</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">i\in[0..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></span>
<ul>
<li>compare the available with the need vector</li>
<li>if the available is lesser than the need vector then unsafe</li>
<li>else, it can be allocated</li>
<li>add allocation vector to available vector as the resources are now returned from process</li>
</ul>
</li>
<li>at no point should the available exceed the maximum for each entry in the vector</li>
<li>if at any point in the vector of processes does the above <code>for-loop</code> exit then it does not satisfy the safety requirement</li>
</ul>
<hr>
<p>Knowledge Check:</p>
<ul>
<li>which of the following statements is true:
<ul>
<li>d. An unsafe state may lead to a deadlocked state</li>
<li>we may avoid the deadlocked state</li>
</ul>
</li>
<li><img src="../images/image-147.png" alt="Alt text">
<ul>
<li>b. It is not safe</li>
</ul>
</li>
<li><img src="../images/image-148.png" alt="Alt text">
<ul>
<li>It is safe</li>
</ul>
</li>
</ul>
<h3 id="deadlock-detection">Deadlock Detection</h3>
<p>If we don’t use deadlock prevention or avoidance then a deadlock situation may occur</p>
<p>in lieu of prevention and avoidance we can use detection and recovery</p>
<p>A detection algorithm to look at the system state see if a deadlock has happened.</p>
<p>A recovery scheme to recovery from the deadlock.</p>
<p>For situations where we have a single instance of each resource type:</p>
<ul>
<li>maintain a <code>wait-for</code> graph
<ul>
<li>nodes are processes</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, i, end subscript, right arrow, P, start subscript, j, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>→</mo><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_i\rarr P_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> if <span class="katex-parse"><span class="visually-hidden">P, start subscript, i, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is waiting for <span class="katex-parse"><span class="visually-hidden">P, start subscript, j, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>Periodically check for a cycle in the graph
<ul>
<li>if there is a cycle then there is a deadlock</li>
</ul>
</li>
<li>takes <span class="katex-parse"><span class="visually-hidden">O, left parenthesis, n, squared, right parenthesis</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> where <span class="katex-parse"><span class="visually-hidden">n</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> is the number of vertices in the graph</li>
</ul>
<p><img src="../images/image-149.png" alt="Alt text"></p>
<p>In the above,
we see that there is a deadlock as there are cycles so we are in deadlock.</p>
<p>For situations where we have multiple instances for each resource type:</p>
<ul>
<li>we use something similar to the banker’s algo</li>
<li>all the matrices and all of that</li>
<li>“it’s exactly similar to the Banker’s algorithm” - prof</li>
</ul>
<p>How often we invoke this depends on how likely it is to occur and how many threads would be affected by a deadlock if it happens.</p>
<p>The more often and the more impactful then the more frequently we should invoke.</p>
<p>Invoking everytime there is a resource request is expensive (except in the case of Banker’s algo since we use it anyways).</p>
<p>A less expensive alternative is to invoke the algo at defined intervals.</p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>the wait-for graph scheme is not applicable to a resource allocation system with mutliple instances of each resource type
<ul>
<li>True</li>
</ul>
</li>
<li>in a wait-for graph
<ul>
<li>d. None of the above</li>
<li>b and c are each others’ contrapositive so they’re both false</li>
</ul>
</li>
<li>The decision of when to invoke a detection algorithm depends on the likely frequency of deadlocks and the number of threads likely to be affected by a deadlock when it happens
<ul>
<li>True</li>
</ul>
</li>
</ul>
<h2 id="recovery-from-deadlock">Recovery from Deadlock</h2>
<p>We have 2 options in a deadlock:</p>
<ul>
<li>break circular wait by aborting one or more involved threads</li>
<li>preempt some resources from one or more of the deadlocked threads
<ul>
<li>take some resources away</li>
</ul>
</li>
</ul>
<p>for abortion we have some options</p>
<ul>
<li>abort all the deadlocked processes</li>
<li>abort one at a time until the deadlock cycle is eliminated</li>
</ul>
<p>Let’s not kill everything.</p>
<p>What affects the process abortion order:</p>
<ol>
<li>priorty of process</li>
<li>elapsed and remaining computation time</li>
<li>allocated resources</li>
<li>required resources</li>
<li>number of processes to be terminated</li>
</ol>
<p><code>copying slides now</code></p>
<p>selecting a victim that minimizes cost</p>
<p>rollback to some safe state, restart process for that state once the resources are available.</p>
<p>We may have starvation if we keep selecting the same victim over and over again</p>
<p>we have to include the number of rollbacks as part of the cost factor</p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>a system can recover from a deadlock by
<ul>
<li>d. All of the above</li>
</ul>
</li>
<li>to recover from a deadlock using resource preemption,
<ul>
<li>d. All of the above</li>
</ul>
</li>
</ul>
<p>This concludes the <code>Deadlock and Starvation</code> slide deck.</p>
<h1 id="cpu-scheduling">CPU Scheduling</h1>
<p>toc:</p>
<ul>
<li><a href="#recap">Recap</a></li>
<li><a href="#basics">Basics</a></li>
<li><a href="#scheduling-criteria">Scheduling Criteria</a></li>
<li><a href="#scheduling-algos">Scheduling Algos</a></li>
<li><a href="#multi-processor-scheduling">Multi-Processor Scheduling</a>
<ul>
<li><a href="#multicore">Multicore</a></li>
<li><a href="#multithreaded-cores">Multithreaded Cores</a></li>
<li><a href="#load-balancing">Load Balancing</a></li>
<li><a href="#processor-affinity">Processor Affinity</a></li>
<li><a href="#numa-systems">NUMA Systems</a></li>
<li><a href="#hetereogeneous-multiprocessing">Hetereogeneous Multiprocessing</a></li>
</ul>
</li>
<li><a href="#real-time-cpu-scheduling">Real-Time CPU Scheduling</a>
<ul>
<li><a href="#priority-based-scheduling">Priority Based Scheduling</a></li>
</ul>
</li>
<li><a href="#algo-eval">Algo Eval</a>
<ul>
<li><a href="#deterministic">Deterministic</a></li>
<li><a href="#queueing-models">Queueing Models</a></li>
<li><a href="#simulations">Simulations</a></li>
<li><a href="#real-implementation">Real Implementation</a></li>
</ul>
</li>
</ul>
<p><img src="../images/image-152.png" alt="Alt text"></p>
<h2 id="recap-for-cpu-scheduling">Recap for CPU Scheduling</h2>
<p><img src="../images/image-150.png" alt="Alt text"></p>
<p><img src="../images/image-151.png" alt="Alt text"></p>
<h2 id="basics-for-cpu-scheduling">Basics for CPU Scheduling</h2>
<p>Kernel threads are ht eones being scheduled.</p>
<p>“Process scheduling” and “thread scheduling” are often used interchangeably.</p>
<p>We say CPU to mean CPU core as a computation unit</p>
<p>Maximum CPU utilization obtained with multiprogramming</p>
<p><img src="../images/image-153.png" alt="Alt text"></p>
<p>We alternate working (cpu) and wait (i/o) bursts.</p>
<p>We end on an I/O burst as the process is ending</p>
<p><img src="../images/image-154.png" alt="Alt text"></p>
<p>On the histogram:</p>
<ul>
<li>above is cpu-bound</li>
<li>below is i/o bound</li>
</ul>
<p><img src="../images/image-155.png" alt="Alt text"></p>
<p>Reminder: the whole process itself isn’t in the queue, just the pcb (which has all the info and points to where the process actually is)</p>
<p><img src="../images/image-156.png" alt="Alt text"></p>
<p>Preemptive scheduling makes decisions at all these times.</p>
<p><img src="../images/image-157.png" alt="Alt text"></p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>which of the following is true of cooperative scheduling
<ul>
<li>b. A process keeps the CPU until the releases the CPU either by terminating or by switching to the waiting state.</li>
</ul>
</li>
<li>In preemptive scheduling, the sections of code affected by interrupts must be guarded from simultaneous use
<ul>
<li>True</li>
<li>we want to ensure mutual exclusion</li>
<li>we want to make sure no other process is accessing at the same time</li>
</ul>
</li>
</ul>
<h2 id="scheduling-criteria">Scheduling Criteria</h2>
<ul>
<li>cpu util
<ul>
<li>keep as busy as possible</li>
<li>maximize this</li>
</ul>
</li>
<li>throughput
<ul>
<li>num of processes that complete their execution per time unit</li>
<li>maximize this</li>
</ul>
</li>
<li>turnaround time
<ul>
<li>amount of time to execute a particular process</li>
<li>minimize this</li>
</ul>
</li>
<li>waiting time
<ul>
<li>aggregate amount of time a process has been waiting int eh ready queue</li>
<li>will be affected by scheduling algo</li>
<li>minimize this</li>
</ul>
</li>
<li>response time
<ul>
<li>time between request submission and first response for interactive systems</li>
<li>minimize this</li>
</ul>
</li>
</ul>
<p>All numbers in milliseconds (ms) unless stated otherwise.</p>
<p>For now we assume we have 1 cpu.</p>
<p><img src="../images/image-159.png" alt="Alt text"></p>
<h2 id="scheduling-algos">Scheduling Algos</h2>
<p><img src="../images/image-158.png" alt="Alt text"></p>
<p><img src="../images/image-160.png" alt="Alt text"></p>
<p>we’re assuming these all arrived at (more or less) the same time since there is no <code>arrival time</code> column in the chart.
We assume in order of number just because it’s convenient here.</p>
<p><img src="../images/image-161.png" alt="Alt text"></p>
<p>different orders will result in different wait times but FCFS can’t account for that</p>
<p><img src="../images/image-162.png" alt="Alt text"></p>
<p><img src="../images/image-163.png" alt="Alt text"></p>
<p>Convoy effect:</p>
<ul>
<li>short process behind long process</li>
<li>consider one cpu-bound and many i/o-bound processes</li>
</ul>
<p>FCFS is not good for interactive systems</p>
<ul>
<li>important that each process get a share of the cpu at regular intervals</li>
</ul>
<p><img src="../images/image-164.png" alt="Alt text"></p>
<p>Shortest-Job-First (SJF) Scheduling</p>
<ul>
<li>for each process, associate the length of its next CPU burst
<ul>
<li>use these lengths to schedule the process with the shortest time</li>
<li>shortest-next-cpu-burst is a more accurate description</li>
</ul>
</li>
<li>SJF is optimal
<ul>
<li>gives minimum average waiting time for a given set of processes</li>
</ul>
</li>
</ul>
<p>If the next bursts of 2 processes are the same, FCFS scheduling is used to break the tie.</p>
<p>But how do we know how long the next cpu burst is?
We can ask the user but there’s more to it.</p>
<p><img src="../images/image-165.png" alt="Alt text"></p>
<p>Remember that waiting time is the time that the process waits to <em><strong>start</strong></em> not to finish.</p>
<p>So the above calculation w/ start time <span class="katex-parse"><span class="visually-hidden">s, start subscript, i, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> for process <span class="katex-parse"><span class="visually-hidden">p, start subscript, i, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> would look like this:</p>
<p>average waiting time <span class="katex-parse"><span class="visually-hidden">equals, left parenthesis, w, start subscript, 1, end subscript, plus, w, start subscript, 2, end subscript, plus, w, start subscript, 3, end subscript, plus, w, start subscript, 4, end subscript, right parenthesis, slash, 4</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>3</mn></msub><mo>+</mo><msub><mi>w</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">= (w_1 + w_2 + w_3 + w_4)/4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/4</span></span></span></span></span></p>
<p>For FCFS we’d have</p>
<p>average waiting time <span class="katex-parse"><span class="visually-hidden">equals, left parenthesis, 0, plus, 6, plus, 14, plus, 21, right parenthesis, slash, 4, equals, 10, point, 75</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo>+</mo><mn>6</mn><mo>+</mo><mn>14</mn><mo>+</mo><mn>21</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>4</mn><mo>=</mo><mn>10.75</mn></mrow><annotation encoding="application/x-tex">= (0+6+14+21)/4=10.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">14</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">21</span><span class="mclose">)</span><span class="mord">/4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10.75</span></span></span></span></span></p>
<p>We can only estimate the length,
typically assumiing it to be similar to the previous one.
Then pick the process with the shortest predicted next CPU burst.</p>
<p>We use an exponential averaging of the length of the previous cpu bursts</p>
<p><span class="katex-parse"><span class="visually-hidden">tau, start subscript, n, plus, 1, end subscript, equals, alpha, t, start subscript, n, end subscript, plus, left parenthesis, 1, minus, alpha, right parenthesis, tau, start subscript, n, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>α</mi><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><msub><mi>τ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\tau_{n+1}=\alpha t_n + (1-\alpha)\tau_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">t, start subscript, n, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">t_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> = actual length of <span class="katex-parse"><span class="visually-hidden">n, start superscript, t, h, end superscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">n^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> CPU burst</li>
<li><span class="katex-parse"><span class="visually-hidden">tau, start subscript, n, plus, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\tau_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span> = predicted value of the next CPU burst</li>
<li><span class="katex-parse"><span class="visually-hidden">alpha, \in, open bracket, 0, comma, 1, close bracket</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\alpha\in[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>, typically <span class="katex-parse"><span class="visually-hidden">start fraction, 1, divided by, 2, end fraction</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> for our applications</li>
</ul>
<p><img src="../images/image-166.png" alt="Alt text"></p>
<p>We start by predicting 10 ms for the first burst.</p>
<p>It actually uses 6 ms.</p>
<p>We use these values to predict the next burst.</p>
<span class="katex-parse katex-parse-display"><span class="visually-hidden">tau, start subscript, n, plus, 1, end subscript, equals, alpha, t, start subscript, n, end subscript, plus, left parenthesis, 1, minus, alpha, right parenthesis, tau, start subscript, n, end subscript, equals, start fraction, 1, divided by, 2, end fraction, 6, plus, left parenthesis, 1, minus, start fraction, 1, divided by, 2, end fraction, right parenthesis, 10, equals, 8</span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>τ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>α</mi><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><msub><mi>τ</mi><mi>n</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mn>6</mn><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">)</mo><mn>10</mn><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">\tau_{n+1}=\alpha t_n + (1-\alpha)\tau_n
=\frac{1}{2}6+(1-\frac{1}{2})10
=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord">10</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span></span></span>
<p>Then we check against the next actual burst length.</p>
<p>So on and so forth.</p>
<p>The predictions aren’t the tightest at times but they’re not too too far off.</p>
<p>Note that we’re using the actual previous burst time as well as the prebious prediction in our calculations to predict the next burst time.</p>
<hr>
<p>More on exponential averaging:</p>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">alpha, equals, 0</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">tau, start subscript, n, plus, 1, end subscript, equals, tau, start subscript, n, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>τ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\tau_{n+1}=\tau_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li>
<li>recent history does not count</li>
</ul>
</li>
<li><span class="katex-parse"><span class="visually-hidden">alpha, equals, 1</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">tau, start subscript, n, plus, 1, end subscript, equals, alpha, t, start subscript, n, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>α</mi><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\tau_{n+1}=\alpha t_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li>
<li>only the actual last CPU burst counts</li>
</ul>
</li>
</ul>
<p>Exponential averaging is a series that we use for prediction in genearl,
not just for processors.</p>
<p>Tweaking the <span class="katex-parse"><span class="visually-hidden">alpha</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span> value will allow us to put more weight on near or far.</p>
<hr>
<p>Preemptive vs Non-Preemptive</p>
<ul>
<li>SJF can be either</li>
<li>the choice arises when anew process arrives at the ready queue while a previous process is still executing</li>
<li>the next burst of the newer process may be shorter than what is left of the currently executing process</li>
<li>in this scenario
<ul>
<li>if preemptive
<ul>
<li>preempt the currently executing process</li>
<li>sometimes known as <code>shortest-remaining-time-first-scheduling</code></li>
</ul>
</li>
<li>if non-preemptive
<ul>
<li>allow the currently running process to finish its CPU burst</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The context switches take about 10 microseconds so preempting here is fine for us as we’re typically just working in milliseconds.</p>
<p><img src="../images/image-167.png" alt="Alt text"></p>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> arrives and works for 1 ms</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> arrives and has 4 ms compared to <span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>’s 7 ms</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is preempted and <span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> begins execution</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> arrives and has 9 ms compared to <span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>’s 3 ms</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 4, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> arrives and has 5 ms compared to <span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>’s 2 ms</li>
<li>@ <span class="katex-parse"><span class="visually-hidden">t, equals, 5</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">t=5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span></span>, <span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> finishes</li>
<li>We choose <span class="katex-parse"><span class="visually-hidden">P, start subscript, 4, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> as it has the least remaining time to finish</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 4, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> finishes</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is chosen to execute as it has 7 ms remaining</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is chosen after <span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> finishes as it has 9 ms reamining</li>
</ul>
<p>Average waiting time
<span class="katex-parse"><span class="visually-hidden">equals, open bracket, P, start subscript, 1, end subscript, plus, P, start subscript, 2, end subscript, plus, P, start subscript, 3, end subscript, plus, P, start subscript, 4, end subscript, close bracket, slash, 4</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mi>P</mi><mn>1</mn></msub><mo>+</mo><msub><mi>P</mi><mn>2</mn></msub><mo>+</mo><msub><mi>P</mi><mn>3</mn></msub><mo>+</mo><msub><mi>P</mi><mn>4</mn></msub><mo stretchy="false">]</mo><mi mathvariant="normal">/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">= [P_1+P_2+P_3+P_4]/4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord">/4</span></span></span></span></span></p>
<p>Remember that waiting time is the time waiting in the queue.
So we have to add in the 9 ms that <span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> was sent back to the queue for.</p>
<p>Round Robin (RR) Scheduling</p>
<ul>
<li>each process gets a time quantum (q)
<ul>
<li>a small unit of cpu time</li>
<li>usually 10-100 ms</li>
</ul>
</li>
<li>after the quantum has passed
<ul>
<li>process is preempted</li>
<li>process added to end of ready queue</li>
<li><img src="../images/image-168.png" alt="Alt text"></li>
</ul>
</li>
</ul>
<p><img src="../images/image-169.png" alt="Alt text"></p>
<p><img src="../images/image-170.png" alt="Alt text"></p>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> starts executing</li>
<li>4 ms pass and the cpu checks the queue</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is preempted and <span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is put in its place for execution</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> finishes execution</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> executes and finishes</li>
<li><span class="katex-parse"><span class="visually-hidden">P, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> begins to execute once more and runs the course of the 4 ms quantum</li>
</ul>
<p>averaging waiting time <span class="katex-parse"><span class="visually-hidden">equals, start fraction, 6, plus, 4, plus, 7, divided by, 3, end fraction, equals, 5, point, 666, point, point, point</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mfrac><mrow><mn>6</mn><mo>+</mo><mn>4</mn><mo>+</mo><mn>7</mn></mrow><mn>3</mn></mfrac><mo>=</mo><mn>5.666...</mn></mrow><annotation encoding="application/x-tex">= \frac{6+4+7}{3}=5.666...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mbin mtight">+</span><span class="mord mtight">4</span><span class="mbin mtight">+</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5.666...</span></span></span></span></span></p>
<p><img src="../images/image-171.png" alt="Alt text"></p>
<p><img src="../images/image-172.png" alt="Alt text"></p>
<p>Priority Scheduling</p>
<ul>
<li>priority number (integer) associated w/ each process</li>
<li>CPU is allocated to the process with the highest priority
<ul>
<li>can be done preemptively or nonpreemptively</li>
</ul>
</li>
<li>SJF is priority scheudling where priority is the inverse of predicted next CPU burst time
<ul>
<li>larger burst = lower priority</li>
<li>smaller burst = higher priority</li>
</ul>
</li>
</ul>
<p><img src="../images/image-173.png" alt="Alt text"></p>
<p>Linux and Windows use the same numbering system</p>
<p><img src="../images/image-174.png" alt="Alt text"></p>
<p>Starvation is a problem for both preemptive and nonpreemptive.</p>
<p>We up priority for old processes</p>
<p><img src="../images/image-175.png" alt="Alt text"></p>
<p><img src="../images/image-176.png" alt="Alt text"></p>
<p>A process can’t be preempted for a process with a lower priority.
If a process is the only process within its priority tier and there are no other higher priority processes then the process gets to run with impunity.</p>
<p><img src="../images/image-177.png" alt="Alt text"></p>
<p><img src="../images/image-178.png" alt="Alt text"></p>
<p><img src="../images/image-179.png" alt="Alt text"></p>
<p><img src="../images/image-180.png" alt="Alt text"></p>
<p>Aging is done via moving them do a different queue.</p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>___ scheduling is approximated by predictin the next CPU burst with an exponential average of the measued lengths of previous CPU bursts
<ul>
<li>d. SJF</li>
</ul>
</li>
<li>The ___ scheduling algo is designed especially for time-sharing systems
<ul>
<li>c. RR</li>
</ul>
</li>
<li>which of the following is ture of multilevel queue scheduling?
<ul>
<li>b. each queue has its own scheduling algorithm</li>
<li>the most general CPU-scheduling algo is multilevel feedback</li>
<li>processes can only move between queues using the feedback variant</li>
</ul>
</li>
</ul>
<h2 id="multi-processor-scheduling">Multi-Processor Scheduling</h2>
<p>CPU scheduling is more complex when multiple CPUs available.</p>
<p>multiprocessor may be any one of the following architectures:</p>
<ul>
<li>multicore CPUs</li>
<li>multithreaded cores</li>
<li>NUMA systems</li>
<li>heterogeneous multiprocessing</li>
</ul>
<h3 id="multicore">Multicore</h3>
<p>Symmetric Multi Processing</p>
<ul>
<li>each processor is self scheduling</li>
<li>all threads may be in a common ready queue</li>
<li>each processor may have its own private queue of threads</li>
</ul>
<p><img src="../images/image-181.png" alt="Alt text"></p>
<p>Lately we’ve been making multicore chips that are faster and less power hungry.</p>
<p>Multithreaded cores are also a recent advancement we’ve made.</p>
<p>This takes advantage of memory stall to make progress on another thread while memory retrieve happens.</p>
<p><img src="../images/image-182.png" alt="Alt text"></p>
<hr>
<p>What is Memory Stall?</p>
<p>When a processor acceses memory it waits around for the data to become available.</p>
<p>THe processor is much faster than the memory so it has to wait on the memory.</p>
<p>THis can also occur during due to a cache miss</p>
<hr>
<h3 id="multithreaded-cores">Multithreaded Cores</h3>
<p>Each core as &gt; 1 hardware thread</p>
<p>if one thread has amemory stall then we switch to another thread for 0 downtime.</p>
<p><img src="../images/image-183.png" alt="Alt text"></p>
<p><img src="../images/image-184.png" alt="Alt text"></p>
<p>each thread is basically treated as their own cpu from a logical perspective</p>
<p><img src="../images/image-185.png" alt="Alt text"></p>
<p>choose a chip then choose a thread</p>
<h3 id="load-balancing">Load Balancing</h3>
<p>a concept for symmetric multiprocessing systems</p>
<p><img src="../images/image-186.png" alt="Alt text"></p>
<p>push migration</p>
<ul>
<li>periodic task checks load on each processor</li>
<li>imbalance found <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> task pushed from overloaded CPU to other CPUs</li>
</ul>
<p>pull migration</p>
<ul>
<li>idle processors pull a waiting task from a busy processor</li>
</ul>
<h3 id="processor-affinity">Processor Affinity</h3>
<p>When a thread has been running on one processor, the cache contents of that processor stores the memory accesses by that thread.</p>
<p>Successive memory accesses by thread are often satisfied in cache memory (aka “warm cache”).</p>
<pre><code>Prof uses an example of repititive actions on a data structure, something like a for-loop iterating through an array or spreadsheet.

We start to move things to the cache to speed things up
</code></pre>
<p>If load balancing causes a thread to migrate to another processor:</p>
<ul>
<li>contents of cache memory must be invalidated for the 1st processor</li>
<li>cache for 2nd processor must be repopulated</li>
<li><em><strong>high cost</strong></em></li>
</ul>
<p>This high cost is undesireable so OS and SMP try to avoid migrating a thread from one processor to another.</p>
<p>Proceesor Affinity:</p>
<ul>
<li>a process has an affinity for the processor on which it is currently running</li>
<li>the warm cache is there for the process to take advantage of</li>
</ul>
<p>Soft Affinity</p>
<ul>
<li>OS attempts to keep a thread running on the same processor</li>
<li>no guarantees</li>
</ul>
<p>Hard Affinity</p>
<ul>
<li>allows a process to specify a set of processor it may run on</li>
</ul>
<pre><code>initially the cache is empty (usually almost all 16 kilobytes)

when the process starts it misses over and over again but then starts filling out the cache

processor starts prepopulating the cache in order to help it out.
seeing what to remove and what to get rid of.

for hard affinity the process decides on a number of CPUs.

It can choose CPUs to benefit from a shared L2 cache
</code></pre>
<h3 id="numa-systems">NUMA Systems</h3>
<p><img src="../images/image-187.png" alt="Alt text"></p>
<p><img src="../images/image-188.png" alt="Alt text"></p>
<h3 id="hetereogeneous-multiprocessing">Hetereogeneous Multiprocessing</h3>
<p>so far we have assumed all processors are identical so we can allow any thread to run on any processing core.</p>
<p>We only differed based on load balancing, processor affinity policies, and NUMA systems</p>
<p>Some mobile systems are now designed using cores that run the same instruction set but vary in terms of their clocks peed and power management.</p>
<p>They can also adjust the power draw of a core to the point of idling.</p>
<p>These are known as Heterogeneous Multiprocessing (HMP).</p>
<p>This type of architecture is known as <code>big.LITTLE</code>:</p>
<ul>
<li><code>big</code> cores are higher-performance cores
<ul>
<li>greater power draw <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> used for short periods of time</li>
<li>interactive tasks</li>
</ul>
</li>
<li><code>LITTLE</code> are energy efficient cores
<ul>
<li>use less energy <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> used for longer periods of time</li>
<li>background tasks</li>
</ul>
</li>
</ul>
<p>Windows 10 supports HMP scheduling by allowing a thread to select a scheduling policy that best supports its power management</p>
<hr>
<p>knowledge check</p>
<ul>
<li>___ allows a thread to run on only one processor
<ul>
<li>a. processor affinity</li>
</ul>
</li>
<li>two general approaches to load balancing are ___ and ___
<ul>
<li>d. push migration, pull migration</li>
<li>course grained is when a process keeps executing on a core until there’s a huge stall event</li>
<li>fine grained is when we are switching on a very fine level of granularity between processes
<ul>
<li>the boundary of an instruction cycle
<ul>
<li>fetch and execute then now we switch to another thread</li>
</ul>
</li>
</ul>
</li>
<li>each comes with their pros and cons with relation to process switching</li>
</ul>
</li>
</ul>
<h2 id="real-time-cpu-scheduling">Real-Time CPU Scheduling</h2>
<p>can present special issues</p>
<p>2 types</p>
<ul>
<li>soft real-time systems
<ul>
<li>critical real-time tasks have the highest priority</li>
<li>no guarantee as to when tasks will be scheduled</li>
</ul>
</li>
<li>hard real-time systems
<ul>
<li>task must be serviced by its deadline</li>
<li>service after deadlin has expired
<ul>
<li>same as no service at all</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>event latency</p>
<ul>
<li>amount of time that elapses from when an event occurs to when it is serviced</li>
<li>2 types that affect performance
<ul>
<li>interrupt</li>
<li>dispatch
<ul>
<li>time for schedule to take current process off CPU and switch to another</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="../images/image-189.png" alt="Alt text"></p>
<p><img src="../images/image-190.png" alt="Alt text"></p>
<p>conflict phase of dispatch latency:</p>
<ol>
<li>preemption of any process running in kernel mode</li>
<li>release by low-priority process of resources needed by high-preiority processes</li>
</ol>
<h3 id="priority-based-scheduling">Priority Based Scheduling</h3>
<p>for soft real-time scheduling, scheduler must support preemptive, priority-based scheduling.</p>
<p>For hard real-time we must also provide the ability to meet deadlines which requires additional scheduling features.</p>
<p><img src="../images/image-191.png" alt="Alt text"></p>
<p><img src="../images/image-192.png" alt="Alt text"></p>
<p><img src="../images/image-193.png" alt="Alt text"></p>
<p><img src="../images/image-194.png" alt="Alt text"></p>
<p><img src="../images/image-195.png" alt="Alt text"></p>
<p><img src="../images/image-196.png" alt="Alt text"></p>
<hr>
<p>knowledge check</p>
<ul>
<li>the reate of a periodic tasks in a hard real-time system is ___, where p is a period and t is the processing time.
<ul>
<li>a. 1/p</li>
</ul>
</li>
<li>which of the following is true of the rate-monotonic scheduling algo?
<ul>
<li>a is for first scheduling</li>
<li>rate-monotonic scheduling does not have a dynamic priority policy</li>
<li>it has to be preemptive</li>
<li>answer: c. cpu utilization is bounded when using this algo</li>
</ul>
</li>
<li>which of the following is true of earliest-deadline-first (EDF) scheduling algo?
<ul>
<li>the rule for <code>b</code> is reversed</li>
<li>priorities aren’t assigned statically</li>
<li>priorities are not fixed</li>
<li>answer: a. when a proces becomes runnable, it must announce its deadline</li>
</ul>
</li>
</ul>
<h2 id="algo-eval">Algo Eval</h2>
<p>How to select CPU-scheduling algo for an OS?</p>
<p>Determine criteria, then eval algos</p>
<p>example of criteria:</p>
<ul>
<li>maximizing utilization under the constratint that the maximum response time is 300 milliseconds</li>
<li>maximizing throughput such that turnaround time is (on average) linearly proportional to total execution time</li>
</ul>
<h3 id="deterministic">Deterministic</h3>
<p>Deterministic Modelling:</p>
<ul>
<li>type of analytic evaluation</li>
<li>takes a particular predetermined workload and defines the performance of each algo for that workload</li>
</ul>
<p><img src="../images/image-197.png" alt="Alt text"></p>
<p><img src="../images/image-198.png" alt="Alt text"></p>
<h3 id="queueing-models">Queueing Models</h3>
<p><img src="../images/image-199.png" alt="Alt text"></p>
<p><img src="../images/image-200.png" alt="Alt text"></p>
<h3 id="simulations">Simulations</h3>
<p>Queueing models are complicated and limited.</p>
<p>Simulations give more accurate evlaution of scheduling algos:</p>
<ul>
<li>programmed model of computer system</li>
<li>clock is a variable</li>
<li>gather stats indicating algo performance</li>
<li>data to drive sim gathered via:
<ul>
<li>rng according ot probabilities</li>
<li>dists defined mathematically or empirically</li>
<li>trace files record sequences of real events in real systems</li>
</ul>
</li>
</ul>
<p><img src="../images/image-201.png" alt="Alt text"></p>
<p><code>I did not fucking hear anything she said about this</code></p>
<h3 id="real-implementation">Real Implementation</h3>
<p>The best way is to just implement this stuff for real.</p>
<p>This is very costly.</p>
<p>In general,
most flexible scheduling algos are those that can be altered by the system amangers or by the users so that they can be tuned for a specific (set of) app(s)</p>
<p>Envionments can vary however.</p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>in little’s formula, <span class="katex-parse"><span class="visually-hidden">lambda</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>, represents the ___:
<ul>
<li>b. average arrival time for new processes in the queue</li>
</ul>
</li>
<li></li>
</ul>
<h1 id="main-memory-1">Main Memory</h1>
<h2 id="background-for-memory-management">Background for Memory Management</h2>
<p>recap:</p>
<ul>
<li>a program must be brought from the disk into the memory and placed within a process for it to be run</li>
<li>main memory and registers are the only storage the CPU can access directly
<ul>
<li>accessing the non-volatile memory is limited to copying over data to the memory to work with</li>
<li>we don’t work directly off of disk</li>
</ul>
</li>
</ul>
<p>a memory unit only sees a stream of either:</p>
<ul>
<li>addresses &amp; read reqeusts</li>
<li>addresses &amp; data and write requests</li>
</ul>
<p>register access is done in one CPU clock cycle.</p>
<p>main memory can take many cycles, causing a stall where the cpu hasd to wait on the memory.</p>
<p>cache sits b/w main mem &amp; cpu regs for faster access than mem</p>
<ul>
<li>principle of locality
<ul>
<li>whenever a task is being done on a specific collection of data, it is very likely that we’re going to select the next piece of data in the collection so we may fetch it preemptively as we anticipate that it will be required next</li>
<li>hit ratio keeps increasing</li>
<li>at some point we start doing something else however</li>
</ul>
</li>
</ul>
<h3 id="memory-protection">Memory Protection</h3>
<p>Protection is required to ensure correct operation.
<code>recall: mutual exclusion</code></p>
<p>Make sure that a proccess can only access its allocated area in the address space.</p>
<p>We can use a pair of <code>base</code> and <code>limit</code> registers to define the logical address space of a process</p>
<p><img src="../images/image-202.png" alt="Alt text"></p>
<p><code>base</code> = smallest legal physical mem address</p>
<p><code>limit</code> = size of range</p>
<p><code>base+limit</code> = highest legal physical mem address</p>
<p>trying to access anything outside of the range is not allowed.</p>
<p>In the above we see a base of 300040 and a limit of 120900 added together to get the highest legal address of 420940.</p>
<pre><code>prof brought up the fact that modern operating systems sit in the highest addresses while older operating systems may do other things like sitting at the oldest

prof will designate which one is which on assessment(s)
</code></pre>
<pre><code>Q: Are all the ranges mutually exclusive?
A: Yes. All the ranges are mutually exclusive
</code></pre>
<p>Hardware Address Protection</p>
<ul>
<li>CPU has to check every memory access request generated in user mode to make sure it’s inside of the range</li>
<li>the instructions to loading the base and limit registers are privileged</li>
</ul>
<p><img src="../images/image-203.png" alt="Alt text"></p>
<pre><code>malicious programs often try to break out of this limit.
</code></pre>
<p>Address Binding</p>
<ul>
<li>programs are stored on disk, ready to be brought into memory to execute form an input queue
<ul>
<li>most systems allow a user process to reside in any part of the physical memory</li>
<li>the address space of the computer may start at 00000 but the first address of the user process does not need to be 00000
<ul>
<li>it’s inconvenient to enforce it to be 00000
<ul>
<li>why?
<ul>
<li>you can waste memory as you get closer to the OS in mem space</li>
<li>we have processes starting and finishing all the time so we have to fit them in whereever we can</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="../images/image-204.png" alt="Alt text"></p>
<ul>
<li>we start out with the source code</li>
<li>compile it</li>
<li>link with the object file</li>
<li>turn it into an executable</li>
<li>dynamically linked libraries are provided by the OS and are linked by the loader</li>
<li>program gets swapped in and swapped out as it needs the libraries</li>
</ul>
<p>addresses are represented in different ways at different stages of a program’s life:</p>
<ul>
<li>source code addresses are usually symbolic (<code>int x</code>)</li>
<li>compiled code addresses bind to relocatable addresses
<ul>
<li>“14 bytes from beginning of this module”</li>
</ul>
</li>
<li><code>after this point we have to have actual concrete physical addresses</code></li>
<li>linker or loader will bind relocatable addresses to absolute addresses
<ul>
<li>ex: 74014</li>
</ul>
</li>
<li>each binding maps one address space to another</li>
</ul>
<p><img src="../images/image-205.png" alt="Alt text"></p>
<p>it’s very unlikely that you will know at compile time where the process will reside in memory.</p>
<p><img src="../images/image-206.png" alt="Alt text"></p>
<p><img src="../images/image-207.png" alt="Alt text"></p>
<p>Most OSes do this binding during execution time.</p>
<h3 id="logical-vs-physical-address-space">Logical vs Physical Address Space</h3>
<p>Logical Address</p>
<ul>
<li>generated by cpu</li>
<li>aka virtual address</li>
</ul>
<p>Physical Address</p>
<ul>
<li>address seen by the memory unit</li>
</ul>
<p><img src="../images/image-208.png" alt="Alt text"></p>
<p>logical address space is bound to the phsyical address space.</p>
<p>The CPU does not directly see/access the physical addresses, only the logical.</p>
<p>Both types of addresses are the same in compile-time and load-time address-binding schemes.</p>
<p>They differ in the execution-time address-binding schemes (so most OSes)</p>
<p>The addresses are all generated by a program by refer to different address spaces (logical or physical)</p>
<h3 id="memory-mangement-unit">Memory Mangement Unit</h3>
<p>The memory management unit (MMU) is a hardware device that maps virtual to physical addresses at run time.</p>
<p>many methods to do this mapping</p>
<p><img src="../images/image-209.png" alt="Alt text"></p>
<p>simple scheme:</p>
<ul>
<li>generalization of the base-register scheme</li>
<li>base register is now called relocation register</li>
<li>value of in the relocation register is added to every address generated by a user process at the time it is sent to memory</li>
<li>user program deals with logical addresses
<ul>
<li>never sees real physical addresses</li>
</ul>
</li>
<li>execution-time binding occurs when a reference is made to a location in memory</li>
<li>memory-mapping hardware converts logical addresses into physical addresses</li>
</ul>
<h3 id="dynamic-loading">Dynamic Loading</h3>
<p>sometimes the program is larger than the size of memory</p>
<p>with dynamic loading, a routine is not loaded until it is called</p>
<ul>
<li>better memory-space util
<ul>
<li>unused routine never loaded</li>
</ul>
</li>
<li>all routines kept on disk in relocatable load format</li>
</ul>
<p>this is very useful when large amounts of code are needed to handle infrequently occuring cases.
<code>heavy, memory-hungry edge cases</code></p>
<p>There is no special support from the OS required</p>
<ul>
<li>implement via program design</li>
<li>OS <em>can</em> help by providing libraries to implement dynamic loading</li>
</ul>
<h3 id="dynamic-linking">Dynamic Linking</h3>
<p>Dynamically Linked Libraries (DLLs) are system libraries that are linked to user programs when the run (during execution time)</p>
<p>DLLs are also known as shared libraries</p>
<ul>
<li>used extensivley in windows and linux systems</li>
<li>small pieces of code (stub) used to locate the appropriate memory-resident library routine</li>
<li>stub replaces itself with the address of the routine and executes the routine</li>
</ul>
<p>Dyn. Linking and DLLs require help from the OS</p>
<ul>
<li>if the processes in mem are protected from one another, OS is th eonly one that can check to see that
<ul>
<li>whether the needed reoutines is in another process’ memory space</li>
<li>can allow multiple processes to access the same memory address</li>
</ul>
</li>
<li>w/o this each program needs to include its own copy of its language library</li>
</ul>
<p>Static linking</p>
<ul>
<li>used only by older computers</li>
<li>system libraries and program code combined by the loader into the binary program image</li>
</ul>
<hr>
<p>Knowledge Check</p>
<ul>
<li>absolute code can be generated for ___
<ul>
<li>a. compile-time binding</li>
<li>load-time binding can gen relocatable</li>
</ul>
</li>
<li>In a dynamically linked library, ___
<ul>
<li>d. a stub is included in the image for each library-routine reference</li>
</ul>
</li>
<li>the mapping of a logical address to a physical address is done in hardware by the ___
<ul>
<li>a. memory-management-unit (MMU)</li>
</ul>
</li>
</ul>
<h2 id="contiguous-memory-allocation">Contiguous Memory Allocation</h2>
<blockquote>
<p>Contiguous means continuous. No broken pieces. Only one large piece</p>
</blockquote>
<p>mem support OS and user processes</p>
<p>contiguous allocation is an earlyo method of memory management</p>
<p>mem usually divided into 2 partitions</p>
<ul>
<li>OS partition
<ul>
<li>usually held in high memory with interrupt vector</li>
<li>used to be in the lowest vector in older systems</li>
</ul>
</li>
<li>user processes held in low memory
<ul>
<li>each process contained in single contiguous section of memory.</li>
</ul>
</li>
</ul>
<h3 id="memory-protection-in-contiguous-memory-allocation">Memory Protection in Contiguous Memory Allocation</h3>
<p>Relocation Registers</p>
<ul>
<li>protect user processes from each other</li>
<li>prevent user processes from chaing operating-system code and data</li>
<li>base contains value of smallest physical address</li>
<li>limit contains range of logical addresses
<ul>
<li>example: relocation = 100040 and limit = 74600</li>
</ul>
</li>
<li>MMU maps logical address dynamically</li>
<li>relocation-register scheme allows OS’ size to chnage dyanmically</li>
</ul>
<p><img src="../images/image-210.png" alt="Alt text"></p>
<h3 id="memory-allocation">Memory Allocation</h3>
<p>a simple method to allocate memory is to use variably sized partitions</p>
<ul>
<li>used for efficiency</li>
<li>hole
<ul>
<li>block of available memory</li>
<li>holes of various size are scattered throughout memory</li>
</ul>
</li>
</ul>
<p><img src="../images/image-211.png" alt="Alt text"></p>
<ul>
<li>Process 8 finishes and leaves a hole b/w processes 5 and 2.</li>
<li>we allocate process 9 and and it fits into the hole</li>
<li>process 5 finishes and makes another hole</li>
</ul>
<p>Holes are a problem that we need to deal with later on.</p>
<p>When a process arrives,
it is allocated memory form a hole large enouhg to accomodate it.</p>
<p>A process exiting frees its partition.</p>
<p>Adjacent free partitions are combined.</p>
<p>OS maintains info about</p>
<ul>
<li>allocated partitions</li>
<li>free partitions (holes)</li>
</ul>
<p>How do we satisfy an allocation request of size <code>n</code> from a list of free holes?</p>
<p>fitting approaches:</p>
<ul>
<li>first-fit
<ul>
<li>allocate the first hole that is big enough</li>
</ul>
</li>
<li>best-fit
<ul>
<li>allocate the smallest hole that is big enough</li>
<li>must search entire list unless ordered by size</li>
<li>produces smallest leftover hole</li>
</ul>
</li>
<li>worst-fit
<ul>
<li>allocate the largest hole</li>
<li>must search entire list unless ordered by size</li>
<li>produces the largest leftover hole
<ul>
<li>may be more useful than the smaller leftover hole from a best-fit approach</li>
<li>not so much smaller fragments of memory</li>
<li>usually not used</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>- next-best-fit
  - not used in the course
  - we find the best-fit then take the next one
  - prof thought it was cool so she brought it up
</code></pre>
<p>simulations show</p>
<ul>
<li>first-fit and best-fit are better thatn worst-fit in terms of
<ul>
<li>decreasing time util</li>
<li>decreasing storage util</li>
</ul>
</li>
<li>neither is clearly better than the other in terms of storage util</li>
<li>first-fit is generally faster than best-fit</li>
</ul>
<h3 id="fragmentation">Fragmentation</h3>
<p>External Fragmentation</p>
<ul>
<li>outside the process</li>
<li>total memory space exists to satisfy a request but not contiguous
<ul>
<li>the holes are not within an assigned space of a process</li>
</ul>
</li>
</ul>
<p><img src="../images/image-212.png" alt="Alt text"></p>
<p>Internal Framgentation</p>
<ul>
<li>allocated memory may be slightly larger than requested memory</li>
<li>size difference is memory interla to a partition but not being used</li>
</ul>
<p><img src="../images/image-213.png" alt="Alt text"></p>
<p>The processes in the above don’t use up all of their allocated memory</p>
<p>given <span class="katex-parse"><span class="visually-hidden">N</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> blocks allocated, <span class="katex-parse"><span class="visually-hidden">N, slash, 2</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">N/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord">/2</span></span></span></span></span> blocks will be lost to (internal and external) fragmentation.</p>
<ul>
<li>1/3<code>?</code> may be unusuable -&gt; 50% rule</li>
</ul>
<p>Reduce external fragmentation by compaction:</p>
<ul>
<li>shuffle memory contents to place all fre memory together in one largeblock</li>
<li>requires
<ul>
<li>dynamic relocation</li>
<li>done at execution time
<ul>
<li>not compile or load time</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Fragmentation applies to more than just memory and can occur wherever we manage blocks of data (disk, external storages, etc.)</p>
<p>The simplest compaction is algo is to move all processes toward one end of memory</p>
<ul>
<li>all holes move in the other direction to make one large hole</li>
<li>can be very expensive</li>
</ul>
<p>We will discuss other strategies in the following 2 sections</p>
<hr>
<p>Knowledge Check:</p>
<ul>
<li>___ is the dynamic storage-allocation algo which results in the smallest leftover hole in memory.
<ul>
<li>b. best fit</li>
</ul>
</li>
<li>___ is the dynamic storage-allocation algorithm which results in the largest leftover hole in memory
<ul>
<li>c. worst fit</li>
</ul>
</li>
<li>which of the following is true of compaction
<ul>
<li>c. it is possible only fif relocation is dynamic and done at execution time</li>
</ul>
</li>
</ul>
<h2 id="paging">Paging</h2>
<p>Permitting the physical address space of processes to be non-contiguous in order to solve the external-fragmentation problem.</p>
<p>This still has internal fragmentation.</p>
<p>set up a <code>page table</code> to translate logical to physical addresses</p>
<ul>
<li>divide physical memory into fixed-sized blocks called <code>frames</code>
<ul>
<li>size is a power of 2
<ul>
<li>between 512 bytes and 16 Mbytes</li>
</ul>
</li>
</ul>
</li>
<li>divide logical memory into fixed-sized blocks called <code>pages</code>
<ul>
<li>size is a power of 2
<ul>
<li>typically either 4 kb or 8kb in size</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>These aren’t equivalent to one another so frames can be different sizes as pages.</p>
<p>We can eventually use paging to load processes that are too big for our memory.</p>
<ul>
<li>keep track of all free frames</li>
</ul>
<p>to run a program of size <span class="katex-parse"><span class="visually-hidden">N</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> pages, need to find <span class="katex-parse"><span class="visually-hidden">N</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> free frames and the program.</p>
<p>Address generated by CPU divided into:</p>
<ul>
<li>p - page number
<ul>
<li>index into page table</li>
<li>contains base address of each page in physical memory</li>
</ul>
</li>
<li>d - page offset
<ul>
<li>conbinedw with base address to define the physical memory address that is sent to the memory unit</li>
</ul>
</li>
</ul>
<p><img src="../images/image-214.png" alt="Alt text"></p>
<p>page size:</p>
<ul>
<li>defined by hardware
<ul>
<li>like frame size</li>
</ul>
</li>
<li>size is a power of 2
<ul>
<li>makes translation of logilcal address to page number and page offset easier this way</li>
</ul>
</li>
<li>if the size of the logical address space is <span class="katex-parse"><span class="visually-hidden">2, start superscript, m, end superscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">2^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span> and page size is <span class="katex-parse"><span class="visually-hidden">2, start superscript, n, end superscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>
<ul>
<li>the high-order <span class="katex-parse"><span class="visually-hidden">m, minus, n</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m-n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> bits of a logicla address designate the page number</li>
<li><span class="katex-parse"><span class="visually-hidden">n</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> low-order bits designate the page offset</li>
</ul>
</li>
</ul>
<p><img src="../images/image-215.png" alt="Alt text"></p>
<h3 id="paging-hardware">Paging Hardware</h3>
<p><img src="../images/image-218.png" alt="Alt text"></p>
<p><img src="../images/image-217.png" alt="Alt text"></p>
<p><img src="../images/image-219.png" alt="Alt text"></p>
<p><img src="../images/image-220.png" alt="Alt text"></p>
<p>steps the MMU takes to translate a logical address gen’d by cpu to a phys address</p>
<ul>
<li>extract page number <code>p</code> and use it to index into page table</li>
<li>get corresponding frame number <code>f</code> from page table</li>
<li>replace <code>p</code> in the logcal address with <code>f</code> to get physical address</li>
</ul>
<p>the offset <code>d</code> is unchanged and unreplaced, combining with <code>f</code> to get the physical address</p>
<p><img src="../images/image-221.png" alt="Alt text"></p>
<p>Logically we see the pages as being contiguous but physically they are all over the place and in a different order.</p>
<p>our paging scheme makes it so that there is no external fragmentation since any free frame can be allocated to a process that needs it.</p>
<h3 id="example">Example</h3>
<p>given</p>
<ul>
<li>n = 2</li>
<li>m = 4</li>
</ul>
<p>map the following logical addresses to physical addresses:</p>
<ul>
<li>0</li>
<li>3</li>
<li>4</li>
<li>13</li>
</ul>
<p><img src="../images/image-222.png" alt="Alt text"></p>
<p>using a page size of <span class="katex-parse"><span class="visually-hidden">2, start superscript, n, end superscript, equals, 4</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">2^n = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span> bytes
and a physical memory of <span class="katex-parse"><span class="visually-hidden">2, start superscript, m, end superscript, equals, 32</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>m</mi></msup><mo>=</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">2^m=32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span></span></span></span></span>
bytes (8 pages)</p>
<p>so the logical addresses translate as follows:</p>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">0, equals, left parenthesis, 5, times, 4, right parenthesis, plus, 0, equals, 20</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><mo stretchy="false">(</mo><mn>5</mn><mo>×</mo><mn>4</mn><mo stretchy="false">)</mo><mo>+</mo><mn>0</mn><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">0=(5\times 4)+0=20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span></span></li>
<li><span class="katex-parse"><span class="visually-hidden">3, equals, left parenthesis, 5, times, 4, right parenthesis, plus, 3, equals, 23</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>=</mo><mo stretchy="false">(</mo><mn>5</mn><mo>×</mo><mn>4</mn><mo stretchy="false">)</mo><mo>+</mo><mn>3</mn><mo>=</mo><mn>23</mn></mrow><annotation encoding="application/x-tex">3=(5\times 4)+3=23</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">23</span></span></span></span></span></li>
<li><span class="katex-parse"><span class="visually-hidden">4, equals, left parenthesis, 6, times, 4, right parenthesis, plus, 0, equals, 24</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>=</mo><mo stretchy="false">(</mo><mn>6</mn><mo>×</mo><mn>4</mn><mo stretchy="false">)</mo><mo>+</mo><mn>0</mn><mo>=</mo><mn>24</mn></mrow><annotation encoding="application/x-tex">4=(6\times 4)+0=24</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">24</span></span></span></span></span></li>
<li><span class="katex-parse"><span class="visually-hidden">13, equals, left parenthesis, 2, times, 4, right parenthesis, plus, 1, equals, 9</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>13</mn><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo>×</mo><mn>4</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">13=(2\times 4)+1=9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">13</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span></span></li>
</ul>
<p><img src="../images/image-223.png" alt="Alt text"></p>
<p><img src="../images/image-224.png" alt="Alt text"></p>
<h3 id="calculating-internal-fragmentation">Calculating Internal Fragmentation</h3>
<p>if page size = 2048 bytes, how many pages will a process of size 72,766 bytes need?</p>
<ul>
<li>35 pages + 1,086 bytes</li>
</ul>
<p>It will be allocated 36 pages with an internal framgentation of 2048 - 1086 = 962 bytes</p>
<p>can you think of a worst case internal fragmentation scenario</p>
<ul>
<li>process needs n pages + 1 byte</li>
<li>will be allocated n+1 frames with an internal fragmentation of almost a frame</li>
</ul>
<p>on average fragmentation = 1/2 frame size. so are the small frames more desirable?</p>
<ul>
<li>not necessarily as each page table entry takes memory to track.</li>
</ul>
<h3 id="free-frames">Free Frames</h3>
<p>The frame table has one entry for each physical page frame indicating whether the latter is free or allocated and, if it is allocated, to whihc page of whihc process.</p>
<p><img src="../images/image-225.png" alt="Alt text"></p>
<h3 id="implementation-of-page-table">Implementation of Page Table</h3>
<p>OS maintains a copy of the page table for each process just as it maintains a copy of the instruction counter and register contents</p>
<p>page table is kept in main memory</p>
<ul>
<li>page-table base register (PTBR) points to the page table</li>
<li>page-table length register (PLTR) indicates size of the page table</li>
</ul>
<p>in this scheme ever data/instruction access requires two memory accesses</p>
<ul>
<li>one for the page table</li>
<li>one for the actual data or instruction</li>
<li>memory access is slowed by a factor of 2</li>
</ul>
<p>sol’n:</p>
<ul>
<li>se a special fast-lookup hardware cached called translation look-aside buffers (TLBs) (aka associative memory)</li>
</ul>
<h4 id="tlb">TLB</h4>
<p><img src="../images/image-226.png" alt="Alt text"></p>
<p>each entry in the TLB has 2 parts:</p>
<ol>
<li>key/tag</li>
<li>value</li>
</ol>
<p>TLB is associative, hihg-speed memory</p>
<ul>
<li>when the associative memory is presented with an item</li>
<li>the item is compared with all keys simultaneously</li>
</ul>
<p>typically small</p>
<ul>
<li>32-1024 entries</li>
</ul>
<p>tlb is a hardware feature</p>
<p><code>This is a lot like a cache</code></p>
<p>on hit:</p>
<ul>
<li>mmu checks if page number is present in the tlb</li>
<li>if the number is found then its frame number is immediately available and is used to access memory</li>
</ul>
<p>on miss:</p>
<ul>
<li>page number is not in the tlb</li>
<li>have to reference the page table</li>
<li>page and frame number are loaded into TLB for faster access next time</li>
</ul>
<p>if TLB is full:</p>
<ul>
<li>an existing entry must be selected for replacement
<ul>
<li>replacement policies must be considered
<ul>
<li>range from least recently used (LRU) through round-robin to random</li>
</ul>
</li>
<li>some CPUs allow the OS to participate in LRU entry replacment
<ul>
<li>other handle the matter themselves</li>
</ul>
</li>
<li>some entries can be wired down for permanent fast access
<ul>
<li>never replaced</li>
<li>entries for key kernel code are wired down, typically</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="effective-access-time">Effective Access Time</h5>
<p>Hit ratio</p>
<ul>
<li>% of times that a page number is found in the TLB</li>
<li>% of the time we find our desired page number</li>
</ul>
<p>ex:</p>
<ul>
<li>suppose it takes 10 nanoseconds to access memory</li>
<li>if we find the desired page in TLB then a mapped-memory access takes 10 ns</li>
<li>otherwise we need 2 memory accesses, one to the page table and frame number then one more to access the desired byte in memory, which takes 20 ns</li>
<li>calculate effective access time</li>
</ul>
<p>Effective Access Time</p>
<ul>
<li>statistical or real measure of how long it takes the CPU to read or write to memory
<ul>
<li>80% hit ratio
<ul>
<li>EAT = 0.8 * 10 + 0.2 * 20 = 12 ns</li>
<li>20% slowdown in access time implied</li>
<li>((12-20)/10)*100%</li>
</ul>
</li>
<li>99% hit ratio (more realistic)
<ul>
<li>EAT = 0.99 * 10 + 0.01 * 20 = 10.1 ns</li>
<li>1% slowdown in access time implied</li>
<li>((10.1-10)/10)*100%</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="memory-protection-in-page-table">Memory Protection in Page Table</h5>
<p>memory protection implemented by associating protection bit with each frame to indicate if read-only or read-write acces is allowed</p>
<ul>
<li>can also add more bits to indicate page execute-only, and so on</li>
</ul>
<p>for now we’re doing a valid-invalid bit attached to each entry in the page table</p>
<ul>
<li>valid
<ul>
<li>the associated page is in the process’ logical address space</li>
<li>thus a legal page</li>
</ul>
</li>
<li>invalid
<ul>
<li>indicates the page is no tin the process’ logical address space</li>
</ul>
</li>
<li>or we can use the page-table length register (PTLR)</li>
</ul>
<p>any violations result in a trap to the kernel</p>
<p><img src="../images/image-227.png" alt="Alt text"></p>
<p><img src="../images/image-236.png" alt="Alt text"></p>
<h5 id="shared-pages">Shared Pages</h5>
<p>shared code</p>
<ul>
<li>one copy of read-only code shared among processes
<ul>
<li>text editors, compilers, window systems</li>
</ul>
</li>
<li>multiple threads sharing the same process space</li>
</ul>
<p>private code and data</p>
<ul>
<li>each process keeps a separate copy of the code and data</li>
<li>th epages for the private code and data can appear anywhere in the logical address space</li>
</ul>
<p><img src="../images/image-228.png" alt="Alt text"></p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>consider a logical address with a page size of 8 kb. How many bits must be used to represent the page offset in the logical address?
<ul>
<li>the page offset in a logical address is determined by the size of the page</li>
<li>to represent the page offset iwthin this 8 kb page we need enough bits to address each byte within the page
<ul>
<li>(8*1024=8192)</li>
</ul>
</li>
<li>nnumber of bits required <span class="katex-parse"><span class="visually-hidden">equals, l, o, g, start subscript, 2, end subscript, left parenthesis, start text, P, a, g, e, space, S, i, z, e, end text, right parenthesis, equals, l, o, g, start subscript, 2, end subscript, left parenthesis, 8192, right parenthesis, equals, 13</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mtext>Page&nbsp;Size</mtext><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>8192</mn><mo stretchy="false">)</mo><mo>=</mo><mn>13</mn></mrow><annotation encoding="application/x-tex">=log_2(\text{Page Size})=log_2(8192)=13</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Page&nbsp;Size</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">8192</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">13</span></span></span></span></span></li>
</ul>
</li>
</ul>
<p><code>prof recommends doing the knowledge checks at home.</code></p>
<h2 id="swapping">Swapping</h2>
<p><img src="../images/image-229.png" alt="Alt text"></p>
<p>the backing store can be a harddrive or ssd or whatever</p>
<p>standard swapping</p>
<ul>
<li>moving entire processes between main memory and a backing store</li>
</ul>
<p>backing store</p>
<ul>
<li>fast disk large enough to accomodate copies of all memory images for all users</li>
<li>must provide direct access to these memory images</li>
</ul>
<p><img src="../images/image-230.png" alt="Alt text"></p>
<p>page out</p>
<ul>
<li>move page from memory to the backing store</li>
</ul>
<p>page in</p>
<ul>
<li>move page from backing store to memory</li>
</ul>
<h1 id="virtual-memory">Virtual Memory</h1>
<h2 id="background-for-virtual-memory">Background for Virtual Memory</h2>
<p>code needs to be in physical memory to execute but entire program is rarely used</p>
<ul>
<li>error code
<ul>
<li>used to handle unusual error conditions</li>
<li>almost never executed</li>
</ul>
</li>
<li>large data structures
<ul>
<li>often allocated more mem than needed</li>
</ul>
</li>
<li>unusual routines
<ul>
<li>lesser used options and features of a program</li>
</ul>
</li>
</ul>
<p>we only have to load what we need for execution</p>
<p>ability to execute partially-loaded program</p>
<ul>
<li>no longer limited by physicla mem</li>
<li>each program takes less memory while running
<ul>
<li>more programs can run at the same time
<ul>
<li>cpu util and throughput increase</li>
<li>response time and turnaround time the same</li>
</ul>
</li>
</ul>
</li>
<li>less i/o needed to load or swap programs into mem
<ul>
<li>each user program runs faster</li>
</ul>
</li>
</ul>
<p>virtual mem</p>
<ul>
<li>separation of user logical mem from physical mem</li>
<li>only part of the pgram needs to be in mem for execution</li>
<li>logical address space can be larger than physical address space</li>
<li>allows address spaces to be shared by several processes</li>
<li>allows for more efficient process creation</li>
<li>more programs running concurrently</li>
<li>less i/o needed to load or swap processes</li>
</ul>
<p><img src="../images/image-231.png" alt="Alt text"></p>
<p><img src="../images/image-232.png" alt="Alt text"></p>
<p><img src="../images/image-233.png" alt="Alt text"></p>
<p><img src="../images/image-234.png" alt="Alt text"></p>
<p><img src="../images/image-235.png" alt="Alt text"></p>
<ul>
<li>logical memory
<ul>
<li>memory space perceived by a process</li>
</ul>
</li>
<li>real/physical memory
<ul>
<li>physical ram sticks in you’re machine</li>
</ul>
</li>
<li>virtual memory
<ul>
<li>memory management technique</li>
<li>used by operating system</li>
<li>extends beyond available physical ram</li>
</ul>
</li>
</ul>
<hr>
<p>Knowledge check:</p>
<ul>
<li>which of the following is a benefit of allowing a program that is only partially in memory to execute?
<ul>
<li>d. all of the above</li>
<li>programs can be written to use more memory than is available in physical memory</li>
<li>cpu util and throughput is incdreased</li>
<li>less io needed to load or swap each user program into mem</li>
</ul>
</li>
<li>in general virtual memory decreases the degree of multiprogramming in a system
<ul>
<li>false</li>
<li>why would these even effect each other???</li>
</ul>
</li>
</ul>
<h2 id="demand-paging">Demand Paging</h2>
<p>virtual memory can be implemented via</p>
<ul>
<li>demand paging</li>
<li>demand segmation</li>
</ul>
<p>demand paging:</p>
<ul>
<li>bring a page into memeory ONLY when it is needed
<ul>
<li>less required
<ul>
<li>I/O</li>
<li>memory</li>
</ul>
</li>
<li>faster response</li>
<li>more users</li>
</ul>
</li>
<li>similar to a paging system with swapping</li>
</ul>
<p><img src="../images/image-237.png" alt="Alt text"></p>
<p>valid-invlid bit</p>
<ul>
<li>with each page entry there is a valid-invalid bit
<ul>
<li>v <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> in-memory - memory resident</li>
<li>i <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> not-in-memory</li>
</ul>
</li>
<li>initially valid-invalid bit is set to <code>i</code> on all entries
<ul>
<li>all invalid</li>
</ul>
</li>
<li>during MMU address translation
<ul>
<li>if bit is invalid for a page entry then there’s a page fault</li>
</ul>
</li>
</ul>
<p><img src="../images/image-239.png" alt="Alt text"></p>
<p><img src="../images/image-240.png" alt="Alt text"></p>
<p><img src="../images/image-241.png" alt="Alt text"></p>
<p><img src="../images/image-238.png" alt="Alt text"></p>
<p><img src="../images/image-242.png" alt="Alt text"></p>
<p><img src="../images/image-243.png" alt="Alt text"></p>
<p><code>there are some more slides that are the same thing</code></p>
<p>free-frame list</p>
<ul>
<li>a pool of free frames for satisfying such requests</li>
<li>maintained by most operating systems</li>
<li>when a page fault occurs, the operating system must bring the desired page from secondary storage into main memory</li>
<li>OS typically allocate free frames using zero-fill-on-demand
<ul>
<li>we flush out the frame</li>
<li>the content of the frames zeroed-out before being allocated</li>
</ul>
</li>
<li>when a system starts up, all available memory is placed on the free-frame list
<ul>
<li>this lets us start allocating frames as they are demanded</li>
</ul>
</li>
</ul>
<p><img src="../images/image-244.png" alt="Alt text"></p>
<p>performance of demand paging</p>
<ul>
<li>3 major activities of servicing a page-fault
<ul>
<li>serivce the page-fault interrupt</li>
<li>read in the page
<ul>
<li>this is where most of the time is spent</li>
</ul>
</li>
<li>restart the process</li>
</ul>
</li>
<li>page fault rate <span class="katex-parse"><span class="visually-hidden">0, is less than or equal to, p, is less than or equal to, 1</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>p</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0\le p\le 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>
<ul>
<li><span class="katex-parse"><span class="visually-hidden">p, equals, 0, right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn><mo>→</mo></mrow><annotation encoding="application/x-tex">p=0 \rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span></span></span></span></span> no page faults</li>
<li><span class="katex-parse"><span class="visually-hidden">p, equals, 1, right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mo>→</mo></mrow><annotation encoding="application/x-tex">p=1 \rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span></span></span></span></span> every reference is a fault</li>
</ul>
</li>
<li>Effective Access Time (EAT) =
<ul>
<li><span class="katex-parse"><span class="visually-hidden">left parenthesis, 1, minus, p, right parenthesis, times, start text, m, e, m, o, r, y, space, a, c, c, e, s, s, end text, plus, p, left parenthesis, start text, p, a, g, e, space, f, a, u, l, t, space, o, v, e, r, h, e, a, d, end text, plus, start text, s, w, a, p, space, p, a, g, e, space, o, u, t, end text, plus, start text, s, w, a, p, space, p, a, g, e, space, i, n, end text, right parenthesis</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo><mo>×</mo><mtext>memory&nbsp;access</mtext><mo>+</mo><mi>p</mi><mo stretchy="false">(</mo><mtext>page&nbsp;fault&nbsp;overhead</mtext><mo>+</mo><mtext>swap&nbsp;page&nbsp;out</mtext><mo>+</mo><mtext>swap&nbsp;page&nbsp;in</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-p) \times \text{memory access} + p (\text{page fault overhead} + \text{swap page out} + \text{swap page in})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">memory&nbsp;access</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">page&nbsp;fault&nbsp;overhead</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">swap&nbsp;page&nbsp;out</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">swap&nbsp;page&nbsp;in</span></span><span class="mclose">)</span></span></span></span></span></li>
<li>we’re basically averaging it out</li>
</ul>
</li>
</ul>
<hr>
<p>Example of Demand Paging</p>
<p>memory access time = 200 ns</p>
<p>avg page-fault service time = 8 ms</p>
<span class="katex-parse katex-parse-display"><span class="visually-hidden">Unsupported equation</span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>EAT</mtext><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo><mo>×</mo><mn>200</mn><mo>+</mo><mi>p</mi><mo stretchy="false">(</mo><mn>8</mn><mtext>ms</mtext><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo><mo>×</mo><mn>200</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mi>p</mi><mo>×</mo><mn>8</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>000</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>=</mo><mn>200</mn><mo>+</mo><mo stretchy="false">(</mo><mi>p</mi><mo>×</mo><mn>7</mn><mo separator="true">,</mo><mn>999</mn><mo separator="true">,</mo><mn>800</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{EAT} = (1-p) \times 200 + p(8 \text{ms})
\newline
=((1-p)\times 200) + (p \times 8,000,000)
\newline
=200 + (p \times 7,999,800)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">EAT</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">200</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord">8</span><span class="mord text"><span class="mord">ms</span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">((</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">200</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">200</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">999</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">800</span><span class="mclose">)</span></span></span></span></span></span>
<p>if 1 in 1000 accesses causes a page fault (<span class="katex-parse"><span class="visually-hidden">p, equals, 0, point, 001</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.001</mn></mrow><annotation encoding="application/x-tex">p=0.001</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.001</span></span></span></span></span>) then EAT = 8.2 microseconds. a slowdown by a factor of 40</p>
<p>if we want a perfoamnce degredation (slowdown) less than 10 percent</p>
<ul>
<li>10% of 200 (effective access time we want) = 20 ns</li>
<li>220&gt;200 + 7,999,800 * p</li>
<li>20 &gt; 7,999,800 * p</li>
<li>p &lt; 0.0000025</li>
<li>p &lt; one page fault in every 400,000 memory accesses</li>
</ul>
<p>This needs hardware support,
it can’t all be done by the OS.</p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>on a system with demaend-paging, a process will experience a high page fault rate when the process begins execution
<ul>
<li>true</li>
<li>similar principle to caching where we need to slowly fill things up in the memory that the process asks for</li>
<li>since the page table is invalid to start with we end up faulting a ton as we’re setting things up for the process</li>
<li>as it starts going on it’ll start hitting the pages we already loaded for it</li>
</ul>
</li>
<li>a page fault occurs when
<ul>
<li>c. a process tries to access a page that is not loaded in memory</li>
</ul>
</li>
<li>if memory access time is 250 ns and average page fault service time 10 ms the probability of page faults must be less ___ to keep the performance degradation less than 20%
<ul>
<li>options
<ul>
<li>a) 0.0000025</li>
<li>b) 0.000005</li>
<li>c) 0.0000075</li>
<li>d) 0.00001</li>
</ul>
</li>
<li>takehome exercise</li>
</ul>
</li>
</ul>
<h2 id="copy-on-write">Copy on Write</h2>
<p>copy-on-write (COW):</p>
<ul>
<li>allows both parent and child processes to initially share the same pages in memory</li>
<li>the page is copied once either process modifies a shared page
<ul>
<li>read: write</li>
</ul>
</li>
<li>allows more efficient process creation as only modified pages are copied</li>
</ul>
<p><img src="../images/image-245.png" alt="Alt text"></p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>___ allows the parent and child processes to initially share the same pages, but when either process modifies a page, a copy of the shared page is created.
<ul>
<li>a. copy-on-write</li>
</ul>
</li>
</ul>
<h2 id="page-replacement">Page Replacement</h2>
<p>sometimes there is no free frame</p>
<p>how:</p>
<ul>
<li>memory is used up by process pages but also in demand from the kernel, I/O buffers, etc</li>
<li>the page is a hot commodity that everyone needs access to</li>
</ul>
<p>scenario</p>
<ul>
<li>process executing</li>
<li>page fault occurs</li>
<li>OS determines where the desired page is residing on secondary storage</li>
<li>but there are no free frames on the free-frame list
<ul>
<li>all mem is in use</li>
</ul>
</li>
</ul>
<p><img src="../images/image-246.png" alt="Alt text"></p>
<p>need for page replacement</p>
<ul>
<li>algorithms
<ul>
<li>do we terminate it</li>
<li>do we swap out the whole process till there are more free frames</li>
<li>do we replace the page
<ul>
<li>we can find some page in memory but notreally in use, page it out</li>
<li>most operating systems now combine swapping pages with page replacement</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>we want an algor that has the minimum number of page faults</p>
<p>basic page replacement:</p>
<ul>
<li>prevent over-allocation of mem
<ul>
<li>modify page-fault service routine to include page replacement</li>
</ul>
</li>
<li>use modify (dirty) bit to reduce the overhead of page transfers
<ul>
<li>only modified pages are written to disk</li>
<li>unmodified pages have no need ot be written back to backing store since it wouldn’t make a differnce</li>
</ul>
</li>
<li>page replacement completes separation b/w logicla mem and phys mem
<ul>
<li>large virt mem can be provided on a smaller phys mem</li>
</ul>
</li>
</ul>
<p><img src="../images/image-247.png" alt="Alt text"></p>
<p><img src="../images/image-248.png" alt="Alt text"></p>
<p>frame allocation algo determines how many frames given to each process</p>
<ul>
<li>some small processes are smaller</li>
<li>are frames reserved</li>
<li>etc</li>
</ul>
<p>page-replacement algo</p>
<ul>
<li>which pages to replace</li>
<li>want lowest page-fault rate on both first access and re-access</li>
</ul>
<h3 id="page-replacement-algorithms">Page Replacement Algorithms</h3>
<h4 id="page-replacement-algo-evalutation">Page Replacement Algo Evalutation</h4>
<p>evalutate algo by running it on a particular string of memory reference (reference string)
and
computing the number of page faults on that string</p>
<ul>
<li>string is just page numbers, not full addresses</li>
<li>if we have a referece to a page <code>p</code>, then any references to page <code>p</code> that immediately follow will never cuase a page fault</li>
<li>results depend on the number of frames available</li>
</ul>
<p><img src="../images/image-249.png" alt="Alt text"></p>
<p><img src="../images/image-250.png" alt="Alt text"></p>
<h4 id="different-types">Different Types</h4>
<p>algos:</p>
<ul>
<li>FIFO</li>
<li>Optimal</li>
<li>Least Recently Used (LRU)</li>
<li>LRU-Approximation
<ul>
<li>Second-Chance</li>
<li>Enhanced Second-Chance</li>
</ul>
</li>
<li>Counting-Based</li>
</ul>
<p>In all our examples, the reference string of referenced page numbers is:
7, 0, 1, 2, 0, 3, 0, 4, 2, 3, 0, 3, 0, 3, 2, 1, 2, 0, 1, 7, 0, 1</p>
<h5 id="fifo">FIFO</h5>
<p>first-in-first-out algo</p>
<p>Reference string:
7, 0, 1, 2, 0, 3, 0, 4, 2, 3, 0, 3, 0, 3, 2, 1, 2, 0, 1, 7, 0, 1</p>
<p>3 frames (3 pages can be in memory at a time per process)</p>
<p>How to track ages of pages?
Just use a FIFO queue.</p>
<p><img src="../images/image-251.png" alt="Alt text"></p>
<p><img src="../images/image-252.png" alt="Alt text"></p>
<h5 id="optimal-algo">Optimal Algo</h5>
<p><img src="../images/image-253.png" alt="Alt text"></p>
<p>This is an example,
not an actual algo.</p>
<h5 id="least-recently-used-(lru)-algorithm">Least Recently Used (LRU) Algorithm</h5>
<p>Replace the page that has not been used in the most amount of time.
Associate time of last use with each page.</p>
<p>Results in 12 faults which is closer to optimal than FIFO</p>
<p>generally good and frequently used.</p>
<p><img src="../images/image-254.png" alt="Alt text"></p>
<pre><code>7 - assign to open page
0 - assign to open page
1 - assign to open page
2 - replace 7 since LRU
0 - 0 already has page
3 - replace 1 since LRU
0 - 0 already has page
4 - replace 2 since LRU
2 - replace 3 since LRU
3 - replace 0 since LRU
...
</code></pre>
<p>It’s possible that with a different reference string we’ll end up with performance similar to FIFO</p>
<hr>
<p>Implementation</p>
<ul>
<li>requires hardware support</li>
<li>hardware counter implementation
<ul>
<li>every page entry has a counter
<ul>
<li>every tmie the page is referenced through this entry, copy the clock into the counter</li>
</ul>
</li>
<li>when a page needs to be changed
<ul>
<li>look at the counters (clock) of the pages</li>
<li>find the one w/ smallest value (least recently used)
<ul>
<li>replace that one</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>prof also mentioned a stack hardware implementation which is interesting</code></li>
</ul>
<hr>
<p>LRU approximation algos</p>
<ul>
<li>LRU needs special hardware
<ul>
<li>the aforementioned counter implementation</li>
</ul>
</li>
<li>LRU is still slow even with the special hardware</li>
<li>reference bit
<ul>
<li>with each page associate a bit
<ul>
<li>initially set to 0</li>
</ul>
</li>
<li>when a page is refernced, the bit is set to 1</li>
<li>if a reference page has reference bit = 0 then we replace it
<ul>
<li>we don’t know the order so this isn’t perfect</li>
</ul>
</li>
</ul>
</li>
<li>for this reason, we make many algos that approximate LRU</li>
</ul>
<h6 id="second-chance-algo-(clock)---lru-approximation">Second-Chance Algo (Clock) - LRU Approximation</h6>
<p>Generally implemented using FIFO and a hardware-provided reference bit</p>
<p>if the reference bit of the page to be replaced is equal to:</p>
<ul>
<li>0 <span class="katex-parse"><span class="visually-hidden">right arrow</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rarr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span></span> replace it</li>
<li>1
<ul>
<li>page is given second chance</li>
<li>move on to select the next FIFOpage</li>
<li>clear reference bit
<ul>
<li>set it to 0</li>
</ul>
</li>
<li>arrival time is set to current time</li>
</ul>
</li>
</ul>
<p>if all the bits are set then this algo degenerates to FIFO replacement.</p>
<p><img src="../images/image-255.png" alt="Alt text"></p>
<blockquote>
<p>“The hand is like a clock going tick, tick, tick around the circle… that is why it is called the clock algorithm” - Professor</p>
</blockquote>
<h6 id="enhanced-second-chance-algo">Enhanced Second-Chance Algo</h6>
<p>Uses 2 bits</p>
<ul>
<li>reference bit</li>
<li>modify bit (if available)</li>
</ul>
<p>replacing a modified page introduces more overhead</p>
<p>So we can eval pages with the ordered pair (reference, modify)</p>
<figure class="table-wrapper"><table>
<thead>
<tr>
<th>pair</th>
<th>meaning</th>
<th>assessment</th>
</tr>
</thead>
<tbody>
<tr>
<td>(0,0)</td>
<td>neither recently used nor modified</td>
<td>best page to replace</td>
</tr>
<tr>
<td>(0,1)</td>
<td>not recently used but modified</td>
<td>must write out before replacement, more overhead</td>
</tr>
<tr>
<td>(1,0)</td>
<td>recently used but clean</td>
<td>will probably be used again soon</td>
</tr>
<tr>
<td>(1,1)</td>
<td>recently used and modified</td>
<td>probably will be used again AND need to write out before replacement</td>
</tr>
</tbody>
</table>
</figure><p>The above table is in order of replacement preference</p>
<p>When page replacement is called for, use the clock scheme but use the four classes &amp; replace page in lowest non-empty class</p>
<ul>
<li>this may require searching the circular queue several times</li>
</ul>
<h5 id="counting-algos">Counting Algos</h5>
<p>Keep a counter of the ## of references that have been made to each page</p>
<p>Least Frequently Used (LFU) algo</p>
<ul>
<li>replaces the page with the smallest count</li>
</ul>
<p>Most Frequently Used (MFU) algo</p>
<ul>
<li>based on the argument that the page with the smallest count was probably just brought in and has yet to be used</li>
</ul>
<p>neither are common</p>
<ul>
<li>implementation is expensive</li>
<li>does not approximate OPT well</li>
</ul>
<hr>
<p>Knowledge Check</p>
<ul>
<li>Q:
<ul>
<li>Suppose we have the follow page accesses:
<ul>
<li>12342341211314</li>
</ul>
</li>
<li>3 frames within our system</li>
<li>use LRU replacement algo</li>
<li>what is the ## of page faults for the given ref string?</li>
</ul>
</li>
<li>A:
<ul>
<li>take home exercise</li>
<li>The answer is: c. 8</li>
</ul>
</li>
<li>Q: Belady’s anomaly states that ___</li>
<li>A:
<ul>
<li>d. for some page replacement algorithms, the page-fault rate may increase as the number of allocated frames increases</li>
</ul>
</li>
<li>Q: in the enhanced second chance algo, which orderd pair represents a page that would be the best choice for replacmeent?</li>
<li>A: a. (0,0)</li>
</ul>
<h2 id="allocation-of-frames">Allocation of Frames</h2>
<p><code>Much easier design principle compared to page replacement according to prof</code></p>
<p>The question of how we allocate the fixed amount of ofree memory among the various processes</p>
<p>ex:</p>
<ul>
<li>128 frames</li>
<li>os takes 35</li>
<li>93 free for iser</li>
<li>we have 2 processes
<ul>
<li>how many frames does each process get?</li>
</ul>
</li>
</ul>
<ol>
<li>when a user process started execution, it would generate a sequence of page faults</li>
</ol>
<p>The first requests need to generate the page faults to populate their frames</p>
<ol start="2">
<li>
<p>first 93 page faults wuold all get free frames from the free-frame list</p>
</li>
<li>
<p>when the free-frame list was exhausted, a page-replacement algo would be used to select one of the 93 in-memory pages to replaced by the 94th, and so on</p>
</li>
<li>
<p>when the process terminated, the 93 frames would once again be placed on the free-frame list</p>
</li>
</ol>
<p>2 major allocation schemes that variate this simple strat</p>
<ul>
<li>fixed allocation
<ul>
<li>equal allocation
<ul>
<li>each process gets an equal amount of frames</li>
<li>ex. 93 frames split among 5 processes result in 18 frames/process and 3 free frames</li>
</ul>
</li>
<li>proportional allocation
<ul>
<li>bigger processes get more frames than smaller processes</li>
<li>dynamic as degree of multiprogramming</li>
<li>process sizes change</li>
</ul>
</li>
</ul>
</li>
<li>priority allocation
<ul>
<li>proportional allocation scheme using priority rather than size</li>
<li>higher priority processes get more frames</li>
</ul>
</li>
</ul>
<h2 id="thrashing">Thrashing</h2>
<p>thrashing</p>
<ul>
<li>process is spending more time paging than executing</li>
</ul>
<p>if there aren’t “enough” pages, page fault rate is very high</p>
<ul>
<li>page fault to get page</li>
<li>replace existing frame</li>
<li>quickly need replaced frame back</li>
</ul>
<p>leads to</p>
<ul>
<li>low cpu util</li>
<li>os thnks it needs to increase degree of multiprogramming</li>
<li>can be exacerbated by more processes being added</li>
</ul>
<p><img src="../images/image-256.png" alt="Alt text"></p>
<h3 id="demand-paging-1">Demand Paging</h3>
<p>The solution to thrashing</p>
<p><img src="../images/image-257.png" alt="Alt text"></p>
<p>locality:</p>
<ul>
<li>the tendency of processes to reference memory in patterns rather than randomly</li>
<li>process migrates from one locality to anther</li>
<li>localities may overlap</li>
</ul>
<p>why does thrashing occur</p>
<ul>
<li>total size of locality is greater than total memory size</li>
</ul>
<p>we can limit the effect by using local or priority page replacement</p>
<h3 id="working-set-model">Working-Set Model</h3>
<p>the working-set model is based on the assumption of locality</p>
<p><img src="../images/image-258.png" alt="Alt text"></p>
<p><img src="../images/image-259.png" alt="Alt text"></p>
<p><img src="../images/image-260.png" alt="Alt text"></p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>Q:
<ul>
<li>___ occurs when a process spends more time paging than executing</li>
</ul>
</li>
<li>A:
<ul>
<li>a. thrashing</li>
</ul>
</li>
<li>Q:
<ul>
<li>The ___ is an approximation of a program’s locality</li>
</ul>
</li>
<li>A:
<ul>
<li>b. working set</li>
</ul>
</li>
<li>Q:
<ul>
<li>if the page fault rate is too high, the process may have too many frames. True or false?</li>
</ul>
</li>
<li>A:
<ul>
<li>false</li>
</ul>
</li>
</ul>
<h2 id="allocating-kernel-memory">Allocating Kernel Memory</h2>
<p>treated differnetly from user memory, allocating and deallocating memory frequently</p>
<p>often allocated from a free-memory pool:</p>
<ul>
<li>kernel reqs memory for structure of varying sizes</li>
<li>some kernel memory needs to be contiguous like for device i/o</li>
</ul>
<p>The “buddy system”</p>
<ul>
<li>strategy for managing free memory that is assigned to kernel processes</li>
<li>allocates memory from fixed-size segments consisting of physically-contiguous pages</li>
<li>memory allocated using power-of-2 allocator
<ul>
<li>satisfies requests in units sized as power of 2</li>
<li>request rounded up to next highest power of 2</li>
<li>when smaller allocation needed than is available
<ul>
<li>current chunk split into two buddies of next-lower power of 2</li>
<li>continue until the appropriate-sized chunk becomes available</li>
</ul>
</li>
</ul>
</li>
<li>quickly combining(coalescing) unused chunks into a larger chunk</li>
<li>can cause internal fragmentation
<ul>
<li>50% wastage of memory</li>
</ul>
</li>
</ul>
<p><img src="../images/image-261.png" alt="Alt text"></p>
<p>example:</p>
<ul>
<li>256kb chunk available</li>
<li>kernel req 21kb</li>
<li>split into <span class="katex-parse"><span class="visually-hidden">A, start subscript, L, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">A_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> &amp; <span class="katex-parse"><span class="visually-hidden">A, start subscript, R, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">A_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> of 128 kb each</li>
<li>1 further divided into <span class="katex-parse"><span class="visually-hidden">B, start subscript, L, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">B_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">B, start subscript, R, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">B_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> of 64kb each</li>
<li>1 further divided into <span class="katex-parse"><span class="visually-hidden">C, start subscript, L, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">C_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-parse"><span class="visually-hidden">C, start subscript, R, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">C_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> of 32 kb each</li>
<li>finallly have a chunk small enough to justify using on the request
<ul>
<li>any smaller would be 16kb</li>
</ul>
</li>
</ul>
<h1 id="storage-management">Storage Management</h1>
<h2 id="mass-storage-structure">Mass-Storage Structure</h2>
<h3 id="overview-of-mass-storage-structure">Overview of Mass Storage Structure</h3>
<p>bulk of secondary storage for modern computers provided by</p>
<ul>
<li>hard disk drives HDDs</li>
<li>nonvolatile memory (NVM)
<ul>
<li>semiconductor tech like ram</li>
<li>doesn’t dump info on power off like ram</li>
<li>relatively newer</li>
</ul>
</li>
</ul>
<h4 id="hard-disks">Hard Disks</h4>
<p><img src="../images/image-262.png" alt="Alt text"></p>
<p>Note that there are several read/write heads and magnetically coated platters.</p>
<p><code>Landing Zone</code> is where the read/write head sits when it’s not doing anything</p>
<p>HDDs spin platters of magnetically-coated materiaul under moving read-write heads</p>
<p>info stored by recording magnetically on platters</p>
<p>read info by detecting magnetic pattern on platters</p>
<p>read-write head “flies” just above each surface of every platter.
Head cannot touch the platter or else it causes damage to the disk.</p>
<p>The surface of a platter is logically divided into circular <code>tracks</code> which are subdivided into <code>sectors</code>.</p>
<p>The set of tracks at a given arm position make up a cylinder.</p>
<p><img src="../images/image-263.png" alt="Alt text"></p>
<p>The heads themselves cannot move independently of one another as they all share one phsyical arm assembly but each platter can rotate independently of one another.</p>
<p>Drives rotate at 60-250 times per second (can vary depending on brand and usecase).
Rotation speed relates to transfer rates.</p>
<p>Trasnfer rate is rate at which data flow b/w drive and computer.</p>
<p>This can be improved by other things.</p>
<p>Positioning time (random-access time) is time to</p>
<ol>
<li>move disk arm to desired cylinder (seek time)</li>
<li>time for desired sector to rotate under the disk head (rotational latency)</li>
</ol>
<p>Head crash results from disk head making contact with the disk surface which is really bad.
This can be caused by sudden power off.
<code>Prof says and it is true, better to be safe than sorry. But it's also worth noting that a lot of modern drives have mechanisms to prevent head crashes as a result of sudden power loss. Mechanism in place to automatically retract the head upon power loss detection. Not infallible mechanisms and not in all drives, especially old ones, but it's worth noting.</code></p>
<p>Platters range from .85" to 14" (historyically).
More commonly they will be in 3.5, 2.5, and 1.8 inch sizes</p>
<p>range from 30gb to 3tb per drive <code>we've gotten much larger from then</code></p>
<p>disks can be removable</p>
<p>performance varies.</p>
<h4 id="nonvolatile-memory-devices">Nonvolatile Memory Devices</h4>
<p>electrical rather tahn mechanical</p>
<p>solid-state-disk (SSD)</p>
<ul>
<li>flash-memory based NVM</li>
<li>used in a disk-drive-like container</li>
</ul>
<p>USBs also fall under this category</p>
<p>pros:</p>
<ul>
<li>can be more reliable than HDDs</li>
<li>faster
<ul>
<li>no moving parts
<ul>
<li>no seek time</li>
<li>no rotatinoal latency</li>
</ul>
</li>
</ul>
</li>
<li>less power hungry</li>
</ul>
<p>cons:</p>
<ul>
<li>more expensive per mb</li>
<li>less capcity</li>
</ul>
<h4 id="disk-attachment">Disk Attachment</h4>
<p><img src="../images/image-264.png" alt="Alt text"></p>
<p>NVM is much faster than HDD</p>
<p>new fast interface for NVM called NVM express (NVMe) connects directly to the PCI (peripheral component interconnect) bus.</p>
<p>PCI provides a high-speed data path b/w cpu and peripher devices such as netowrk adpaters, sound cards, graphics cards, and storage controllers</p>
<p><img src="../images/image-265.png" alt="Alt text"></p>
<h4 id="address-mapping">Address Mapping</h4>
<p>disk drives are addressed as large 1-dimensional arrasy of logical blocks</p>
<ul>
<li>1 block is the smallest unit of transfer</li>
<li>low-level formatting creates logical blocks on physical media</li>
<li>each logical block maps to a physical sector or semiconductor page</li>
<li>logical block address is easier for algos to use than a secotry, cylinder, or track</li>
</ul>
<hr>
<p>Knowledge Check</p>
<ul>
<li>read or write perforamnce depends on
<ul>
<li>bit transfer rate, seek time, and rotational latency</li>
</ul>
</li>
<li>one advantage of HDDs over SSDs is
<ul>
<li>HDDs are cheaper per megabyte than SSDs</li>
</ul>
</li>
</ul>
<p>Note:</p>
<h3 id="hdd-scheduling">HDD Scheduling</h3>
<p>OS wants to get a fast access time and high disk bandwidth</p>
<p>minimize seek time</p>
<ul>
<li>can be minimized by minimizing seek distance</li>
</ul>
<p>bandwidth</p>
<ul>
<li>total bytes transferred / total time b/w first req and completion of last transfer</li>
<li>bytes transferred / time elapsed for transfer</li>
</ul>
<p>improve both by managing order in which i/o requests are serviced</p>
<p><img src="../images/image-266.png" alt="Alt text"></p>
<p><img src="../images/image-267.png" alt="Alt text"></p>
<h4 id="first-come-first-serve">First Come First Serve</h4>
<p><img src="../images/image-268.png" alt="Alt text"></p>
<h4 id="scan">SCAN</h4>
<p>disk arm starts at one end fo the disk, and moves toward the other end, servicing requests until it gets to the other end of the disk.</p>
<p>once it gets to the end of disk it goes back the other way</p>
<p>the head continuously scans back and forth across the disk</p>
<p>also known as the elevator algo</p>
<p><code>prof left this for us to read</code></p>
<p><img src="../images/image-269.png" alt="Alt text"></p>
<h4 id="c-scan">C-SCAN</h4>
<p>circular scan</p>
<p>higher seek time but more uniform wait time than SCAN</p>
<p>does the same motion of running across the whole disk but it doesn’t service on the return trip,
just goes back to the start immediately
<img src="../images/image-270.png" alt="Alt text"></p>
<p>SCAN and C-SCAN perform better fo rsystems that place a heavy load on the disk</p>
<hr>
<p><img src="../images/image-271.png" alt="Alt text"></p>
<p>d since it’s first come first serve</p>
<h3 id="nvm-scheduling">NVM Scheduling</h3>
<p>nvm devices do not contain moving disk heads and commonly use a simple FCFS policy</p>
<p>FCFS is used but adjacent requests are combined for optimization purposes</p>
<p>NVM best perform at random I/O while HDD excels at sequential I/O</p>
<p><img src="../images/image-272.png" alt="Alt text"></p>
<p>c. NVMs do not contain moving disk heads</p>
<h3 id="raid-structure">RAID Structure</h3>
<p>Redundant Array of Inexpensive (or independent) Disks</p>
<p>a set of physical disk drives viewed by the operating system as a single logical drive</p>
<p>data is copied onto multiple disks to provide fault tolerance</p>
<p>raid is arranged into different levels
<code>and these different levels are different from each person you may ask lmao</code></p>
<p>data copying techniques whihc differ based on raid level</p>
<ul>
<li>data mirroring
<ul>
<li>logical disk consists of two physical drives</li>
<li>every write carried out on both drives</li>
</ul>
</li>
<li>data striping
<ul>
<li>splitting the bits of each byte across multiple drives
<ul>
<li>bit-level striping</li>
</ul>
</li>
<li>blocks of a file are striped across multiple drives
<ul>
<li>block-level striping</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>typically a small number of hot-spare disks are left unallocated, automatically replacing a failed disk and having data rebuilt onto them</p>
<p>levels and their features (that Ruba thinks is good enough to give us an idea to jump off of)</p>
<p><img src="../images/image-273.png" alt="Alt text"></p>
<ul>
<li>logical disk is divided into stripes
<ul>
<li>prof is assuming byte level for this</li>
</ul>
</li>
<li>user and system data are distributed across all of the disks in the array</li>
<li>doesn’t rpovide fault tolerance
<ul>
<li>failure of one disk causes complete data loss</li>
</ul>
</li>
<li>improves performance
<ul>
<li>2 heads instead of 1 makes accessing data faster</li>
</ul>
</li>
<li>only helps with performance</li>
<li>might actually be worse for fault tolerance due to the striping since 1 disk failing corrupts the data on the remaining disk</li>
</ul>
<p><img src="../images/image-274.png" alt="Alt text"></p>
<ul>
<li>drive mirroring present</li>
<li>when a dirve fails the data may still be accessed from the second drive
<ul>
<li>actual fault tolerance</li>
</ul>
</li>
<li>main disad is cost</li>
</ul>
<p><img src="../images/image-275.png" alt="Alt text"></p>
<p>Redundant disk capacity is used to store parity information which guarantees data recoverability in case of a disk failure.</p>
<p>parity is calculated across corresponding blocks on all data disks</p>
<ul>
<li>for every stripe of data blocks, a parity block is calculated</li>
</ul>
<p>ex:</p>
<ul>
<li>an array of three drives where <span class="katex-parse"><span class="visually-hidden">A, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> - <span class="katex-parse"><span class="visually-hidden">A, start subscript, 3, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">A_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> contain data, and <span class="katex-parse"><span class="visually-hidden">A, start subscript, p, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">A_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> is the parity disk.</li>
<li>calculate using</li>
<li><span class="katex-parse"><span class="visually-hidden">A, start subscript, p, end subscript, equals, A, start subscript, 3, end subscript, \oplus, A, start subscript, 2, end subscript, \oplus, A, start subscript, 1, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>p</mi></msub><mo>=</mo><msub><mi>A</mi><mn>3</mn></msub><mo>⊕</mo><msub><mi>A</mi><mn>2</mn></msub><mo>⊕</mo><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A_p = A_3 \oplus A_2\oplus A_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex-parse"><span class="visually-hidden">A, start subscript, 1, end subscript, equals, A, start subscript, p, end subscript, \oplus, A, start subscript, 3, end subscript, \oplus, A, start subscript, 2, end subscript</span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo>=</mo><msub><mi>A</mi><mi>p</mi></msub><mo>⊕</mo><msub><mi>A</mi><mn>3</mn></msub><mo>⊕</mo><msub><mi>A</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">A_1 = A_p\oplus A_3\oplus A_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>If we lose a disk we can recover the data using the parity calculations.</p>
<p>Only 1 disk</p>
<p><img src="../images/image-276.png" alt="Alt text"></p>
<ul>
<li>distribute parity blocks across all disks
<ul>
<li>interleaved distributed parity</li>
<li>typical allocation is a round-robin scheme</li>
</ul>
</li>
<li>avoids potential overuse of a single parity drive which can occur with RAID 4</li>
<li>RAID 5 is the most common parity RAID</li>
<li>can lose any single disk</li>
</ul>
<p><img src="../images/image-277.png" alt="Alt text"></p>
<hr>
<p>Knowledge Check</p>
<ul>
<li>a RAID structure
<ul>
<li>c. stands for redundant arrays of inexpensive disks</li>
<li>b. is primarily used to ensure higher data reliability</li>
</ul>
</li>
<li>in most RAID implemenations, a hot spare disk is not used for data, but is configured for replacement should any other disk fail
<ul>
<li>true</li>
</ul>
</li>
</ul>
<h2 id="i%2Fo-systems">I/O Systems</h2>
<h3 id="overview">Overview</h3>
<p><img src="../images/image-278.png" alt="Alt text"></p>
<h3 id="i%2Fo-hardware">I/O Hardware</h3>
<p><img src="../images/image-279.png" alt="Alt text"></p>
<p><img src="../images/image-280.png" alt="Alt text"></p>
<p><img src="../images/image-281.png" alt="Alt text"></p>
<p><img src="../images/image-282.png" alt="Alt text"></p>
<p>next week is security lect and exam review</p>
<h1 id="security-and-protection">Security and Protection</h1>
<h2 id="security">Security</h2>
<blockquote>
<p>“I will tell you a few stories today. Everybody loves a good story that is perfectly fine but they also have some kind of impact on hardware and software design” - Professor</p>
</blockquote>
<p><img src="../images/image-283.png" alt="Alt text"></p>
<p>Starting at Lawrence Berkely Laboratory (LBL or Berkely Lab) in California had the 75 cent error.
They were performing research for some energy dept.
They were connected to many other institutions, army bases, and defense contractors over the combination arpanet and milnet.</p>
<p>How could this happen?</p>
<pre><code>prof wanted to show us a cool little video 

 Clifford Stoll - Watch from 2:22 to 5:05 - Movie: The KGB, the Computer, and Me
available at https://www.youtube.com/watch?v=PGv5BqNL164
</code></pre>
<p>Clifford Stoll was a grad student at UC Berkely.
He pointed out the 75 cent error after taking a summer job there.</p>
<p>Stoll found out that a single account was responsible for this.
Surely,
just a prankster of u cali.
This account was the acct of a prof who was on sabattical after all.</p>
<p><img src="https://media.tenor.com/A2HpmWxwK3YAAAAe/clueless-meme.png" alt=""></p>
<p><img src="../images/image-284.png" alt="Alt text"></p>
<p>The account from a prof who was on sabattical.</p>
<p>Clifford got a notification that someone was trying to log into docmaster.</p>
<p><img src="../images/image-285.png" alt="Alt text"></p>
<p>tons of pinging from the person trying to login and creating tons of accounts</p>
<p><img src="../images/image-286.png" alt="Alt text"></p>
<p>LBL was a part of a huge network of very important organizations’ computers.
An attacker started from Tymnet machines.</p>
<p><img src="../images/image-287.png" alt="Alt text"></p>
<p>By gaining the privileges the attacker was able to move between machines.</p>
<p>movemail</p>
<ul>
<li>worked by changing the file ownership and moving it to the designated user’s folder</li>
<li>permanently ran as sudo
<ul>
<li><code>movemail</code> can write into protected system folders</li>
<li>given access to any and every folder</li>
<li>also had access to <code>atrun</code> folder</li>
</ul>
</li>
<li>the attacker
<ul>
<li>wrote a script</li>
<li>used <code>movemail</code> to put the script in the <code>atrun</code> folder</li>
<li>set the script to execute in 5 minutes</li>
<li>the script gave his account superuser privileges</li>
</ul>
</li>
</ul>
<p>The attacker used the new privileges to make more accounts.</p>
<p>An original thought was to start locking down all those accounts.</p>
<p>But Stoll wanted to get to the root of it.
Who is the hacker, what are they doing, and why?</p>
<p><img src="../images/image-288.png" alt="Alt text"></p>
<p>Stoll had a gf (SHOCKING)
who suggested making some fake docs to lure the attacker to stay in a machine long enough to trace the connection.</p>
<p>This is what would come to be known as a honeypot.</p>
<p>The honeypot of fabricated docs that were supposed described the Strategic Initiative (SDI) aka the Star Wars program.</p>
<p>The honeypot worked and they traced it back to a West German man named Markus Hess.</p>
<p>It took 6 months to get to this point.</p>
<p>3 years later Stoll was flown into Germany to testify.</p>
<pre><code>prof likes this summary

Watch The 1985 KGB Hack (6:43 minutes) at
https://www.youtube.com/watch?v=dFagMZLMI6o
</code></pre>
<p>There was no huge damage in the end though.</p>
<p><img src="../images/image-289.png" alt="Alt text"></p>
<p><img src="../images/image-290.png" alt="Alt text"></p>
<hr>
<p>New story: passwords and power drills</p>
<p>This story ends with someone using a power drill to crack open a safe.</p>
<p>In 2012,
google had their own internal password manager to store and share secrets for third-party services that don’t support better auth mechanisms at the time.</p>
<p>Initially for very few people.</p>
<p>This was used for the auth for shuttlebus wifi for google employees.</p>
<p><img src="../images/image-291.png" alt="Alt text"></p>
<p><code>In 2012, Stamen Design tracked the movements of tech shuttles and created a map of them - a map that was never created or released by the companies themselves who keep routes and stops secret.</code></p>
<p><img src="../images/image-292.png" alt="Alt text"></p>
<p>This crashed the service b/c everyone hopped on to load up the password.</p>
<p><img src="../images/image-293.png" alt="Alt text"></p>
<p><img src="../images/image-294.png" alt="Alt text"></p>
<p><img src="../images/image-295.png" alt="Alt text"></p>
<p><img src="../images/image-296.png" alt="Alt text"></p>
<p><img src="../images/image-297.png" alt="Alt text"></p>
<p>It took an hour for everyone to realize that they were putting the card in wrong.</p>
<p>password manager failure was triggered by an availability problem:
poor load-balancing.</p>
<p>recovery complicated by multiple measures designed to increase system sec</p>
<ul>
<li>improve breakglass mechanisms
<ul>
<li>mechanisms to bypass policies to allow engineers to quickly resolve outages</li>
</ul>
</li>
</ul>
<hr>
<p>march 2012 there was a power outage at a google datacenter in in belgium</p>
<p>turn out a cat destroyed some nearby external psu thingies</p>
<p><img src="../images/image-298.png" alt="Alt text"></p>
<hr>
<p>in 2006 an open-source dev noticed that the memory debugger Valgrind was reporting warnings about memory used prior to initialization.</p>
<p>to eliminate the warnings, the dev removed two lines of code.</p>
<p><img src="https://media.tenor.com/A2HpmWxwK3YAAAAe/clueless-meme.png" alt="clueless"></p>
<p>cuased a bug in OpenSSL’s pseudo-random number gen.
Only got seeded w/ process ID.</p>
<p>lead to things being easily brute force breakable.</p>
<p>understanding the systems’ adversaries is critical to buildilng reliable and secure systems</p>
<p>adversaries to reliability are typically benign, routine hardware failures or config changes that make unintended effects</p>
<p>security adversaries are typically humans trying to make the system work in a way that they want</p>
<h3 id="how-systems-fail">How Systems Fail</h3>
<p>many reasons including</p>
<ul>
<li>reliability
<ul>
<li>accidental failures</li>
</ul>
</li>
<li>usability
<ul>
<li>failures from operating mistakes</li>
</ul>
</li>
<li>design and goal oversights
<ul>
<li>oversights, errors, adn omissions during designing</li>
</ul>
</li>
<li>security
<ul>
<li>intentional failures created by intelligent parties</li>
</ul>
</li>
</ul>
<p>all of the above are related</p>
<h3 id="what-is-security">What is Security</h3>
<p><img src="../images/image-299.png" alt="Alt text"></p>
<p>CNSS Security Model</p>
<ul>
<li>Committee on National Security Systems (CNSS)</li>
<li>serves as standard for understanding many aspects of infosec</li>
</ul>
<p><img src="../images/image-300.png" alt="Alt text"></p>
<p>still used today.</p>
<p>ahead of his time</p>
<p>3 dimensions of infosec</p>
<ul>
<li>info characteristics
<ul>
<li>confidentiality</li>
<li>integrity availability</li>
</ul>
</li>
<li>security controls
<ul>
<li>policy</li>
<li>education</li>
<li>technology</li>
</ul>
</li>
<li>information location
<ul>
<li>storage</li>
<li>processing</li>
<li>transmition</li>
</ul>
</li>
</ul>
<p>Each cube cell is a specific 3 way intersection that we should be thinking about</p>
<p><img src="../images/image-301.png" alt="Alt text"></p>
<p><img src="../images/image-302.png" alt="Alt text"></p>
<p><img src="../images/image-303.png" alt="Alt text"></p>
<p><img src="../images/image-304.png" alt="Alt text"></p>
<p>AAA processes</p>
<ul>
<li>start with identification
<ul>
<li>subject must provide an identity to a sytsem to start the AAA processes</li>
<li>identities should be
<ul>
<li>unique</li>
<li>securely issued</li>
</ul>
</li>
<li>non-descriptive of role</li>
</ul>
</li>
<li>authentication
<ul>
<li>proves identiy of subj that tires to connect</li>
<li>subject must supply verifiable creds referred at as factors
<ul>
<li>single-factor
<ul>
<li>just one pasword</li>
</ul>
</li>
<li>multifactor
<ul>
<li>two or more</li>
<li>password + duo mobile</li>
<li>bank card + pin</li>
</ul>
</li>
</ul>
</li>
<li>factor categories
<ul>
<li>knowledge - something you know
<ul>
<li>passowrd, pin, answer to security questions</li>
</ul>
</li>
<li>possession - something you have
<ul>
<li>one time auth password, smart cards, ubikey</li>
</ul>
</li>
<li>biometrics - something you are
<ul>
<li>fingerprints, eye scan</li>
</ul>
</li>
</ul>
</li>
<li>you might notice that these days the message for an incorrect username or password are the same message, this is also a security measure</li>
</ul>
</li>
<li>authorization
<ul>
<li>determines what a user is allowed to do on a computer system or network</li>
<li>the model for this defines how access rights and permissions are granted
<ul>
<li>there are many different models
<ul>
<li>rule based</li>
<li>dynamic</li>
<li>discretionary</li>
<li></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>accounting
<ul>
<li>auditing and monitoring what a user does w/ accessed resources</li>
<li>produce audit trail log</li>
<li>when the user accessed the resource</li>
<li>what the user did with that resource</li>
<li>when the user stopped using that resource</li>
</ul>
</li>
</ul>
<h3 id="info-security-strats">Info Security Strats</h3>
<p>don’t just hope that it works out for you</p>
<p>off sec (read team) and defensive sec (blue team)</p>
<p>zero trust security: never trust, always verify</p>
<p><img src="../images/image-305.png" alt="Alt text"></p>
<p><img src="../images/image-306.png" alt="Alt text"></p>
<p><img src="../images/image-307.png" alt="Alt text"></p>
<p><img src="../images/image-308.png" alt="Alt text"></p>
<h2 id="protection">Protection</h2>
<h3 id="goal-of-protection">Goal of protection</h3>
<p>defend the system from internal or external attacks</p>
<p>concerned with controlling access of processes or users to the resources of the computer system.</p>
<p>Protection problem</p>
<ul>
<li>ensure that each object is accessed correctly</li>
<li>only accessed by those processes that are allowed to do so</li>
</ul>
<h3 id="principles-of-protection">Principles of Protection</h3>
<p>protection principles including but not limited to</p>
<ul>
<li>principle of least privilege
<ul>
<li>similar to need-to-know basis</li>
<li>properly set perms can limit damage in the case of bugs or abuse of perms</li>
<li>can be static or dynamic
<ul>
<li>static during life of system or pocess</li>
<li>dyanmically changed by process as needed
<ul>
<li>privilege escalation</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>compartmentalization
<ul>
<li>derivative concept regarding access to data</li>
<li>protect each individual system component</li>
<li>use specific permissions and access restrictions</li>
<li>ex
<ul>
<li>we can have a virtual testing machine so that if the testing machine gets compromised we can kill it very easily and hopefully the attacker doesn’t know to try and jump the hypervisor</li>
<li>we don’t even have to do a full blown vm for some usecases</li>
</ul>
</li>
</ul>
</li>
<li>audit trail
<ul>
<li>recording all protection-oriented activities</li>
<li>important to understand
<ul>
<li>what happened</li>
<li>why</li>
<li>what happened that shouldn’t have happened</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Defense in Depth</p>
<ul>
<li>application of multiple, sometimes redundant, defense mechanisms</li>
<li>if a single control fails then the other controls can still protect the env and assets</li>
</ul>
<h1 id="exam-review">Exam Review</h1>
<h2 id="exam-housekeping">Exam Housekeping</h2>
<p>Date: Mon 15 apr 2024 @ 0900</p>
<p>location: WSC 106 108 105</p>
<p>Duration: 2 hours</p>
<p>Format: e-class quiz with use of labtest mode</p>
<p>Scope: Everything</p>
<p>bring: id, mfa auth, pen and/or dark pencil, calculator (leave in backpack)</p>
<p>closed book, no</p>
<ul>
<li>notes</li>
<li>book</li>
<li>e-class resources</li>
<li>slides</li>
</ul>
<p>Provided with 5 scratch papers to be left.</p>
<p>Use of the calculator app is permitted.</p>
<p>All questions may be on the exam.</p>
<p>Number of questions, question types, and weight of questions are shown on exam.</p>
<p>Non-sequential, allowed to go back and forth between questions.</p>
<p>protocol:</p>
<ul>
<li>Arrive 15 minutes before exam.</li>
<li>Put device into airplane mode after logging in.</li>
<li>Leave photo id on desk</li>
<li>no questions during test</li>
<li>choose the <em><strong>best</strong></em> answer for multiple-choice or true-false questions</li>
<li>write your assumptions</li>
<li>don’t worry too much about the answer format. just go with what the question is asking for
<ul>
<li>if you’re unsure then there will be manual review</li>
</ul>
</li>
<li>deduct 5 marks if you ask the instructor/proctor to
<ul>
<li>explain a question
<ul>
<li>this will not be answered</li>
</ul>
</li>
<li>verify understanding of question</li>
<li>verify answer</li>
<li>ask about answer format</li>
<li>voice concern of missing info in answer
<ul>
<li>do so after the exam</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>in the case of technical/machine related login failure, restart the machine and try again</p>
<p>All else fails, you will be provided a paper-based copy and retrieve your calculator.</p>
<h2 id="qna">QnA</h2>
<p>Q: are we allowed cheat sheats?</p>
<p>A: No.</p>
<p>Q: Will there be a practice exam?</p>
<p>A: Yes.</p>
<p>Q: Will there be more weight given to post midterm material?</p>
<p>A: There will be more weight but the exam is cumulative so study up on everything.</p>
<p>Q: Will there be any coding questions?</p>
<p>A: No. You won’t be creating code to feed to a java or c compiler but we will be looking at snippets that we looked at in class. We may also be asked to write a small piece of code to implement a mutex.</p>
<p>Q: Do we still get to write “I don’t know” for 10%?</p>
<p>A: No</p>
<p>Q: Why not do a paper exam?</p>
<p>A: Prof likes e tests better</p>
<p>Q: Will we be given formulas?</p>
<p>A: Only Amdahl’s law type fomulae. Things like effective access time you need to memorize</p>
<p>Q: What will be the weight of the exam?</p>
<p>A: It’s still 40%. The weight of A2 was placed on to the other completed course materials</p>
<p>Q: Is there any sort of set seating arrangement between the rooms?</p>
<p>A: undecided</p>
<p>Q: WIll the difficulty be similar to the midterm?</p>
<p>A; “It depends. Did you think it was Difficult?” “This is a very relative question”</p>
<p>Q: Can we opt-in to paper based?</p>
<p>A: No, it is only an emergency provision. Likely only a single digit number of paper-based tests will be on-site.</p>
<h2 id="final-exam-practice">Final Exam Practice</h2>
<p>suggested study methods</p>
<ul>
<li>go through lecture notes and existing notes</li>
<li>refer to textbook to attain deeper understanding
<ul>
<li>Operating System Concepts, 10th Edition, by Abraham Silberschatz, Greg Gagne, et al., (Aavailable from York Library in Softcopy)</li>
<li>contains practice questions</li>
</ul>
</li>
<li>practice and understand assignments and tutorials
<ul>
<li><code>tutorial, singular</code></li>
</ul>
</li>
<li>use the practice exam given by professor
<ul>
<li>provides answers to the knowledge checks throughout the course</li>
<li>new knowledge checks added for chapters that didn’t have many</li>
<li>“there are only 117 questions that I encourage you to go through”</li>
<li>answer to on the following slide</li>
</ul>
</li>
</ul>
<p>what have we learned</p>
<ol>
<li>computer system overview</li>
<li>os structures</li>
<li>process description and control</li>
<li>threads</li>
<li>synchronization and mutex</li>
<li>deadlocka nd starvation</li>
<li>cpu scheudling</li>
<li>main memory</li>
<li>virtual memory</li>
<li>storage management</li>
<li>Security and Protection</li>
</ol>
<p>There are also sub-topics</p>

</div>
</body>
</html>